<!DOCTYPE html>
<html>
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" charset="UTF-8">
        <title>FileyTale</title>
        <style>
          html{
              height: 100%;
              width: 100%;
              margin: 0;
              font-family: sans-serif;
              
          }
          body{
              height: 100%;
              width: 100%;
              margin: 0;
              background: #e7e7e7;
              overflow: hidden;
          }
     
          #fmds{
              height: 40%;
              width: 100%;
              background-color: #a4d1c3;
              display: block;
          }
          #btnadd{
              height: 50%;
              width: 100%;
              background-color: #a4d1c3;
              display: flex;
              justify-content: center;
              align-items: center;
              overflow: auto;
          }
          #head{
              height: 5%;
              width: 100%; 
          }
          #formop{
              height: 4%;
              width: 100%;
              background-color:#a4d1c3;
              display: flex;
              display: flex;
              justify-content: center;
              align-items: center;
          }
          .fric{
              display: inline-block;
              vertical-align: middle; 
margin: 0 0.2em 0.4ex;
text-align: center;
          }
          .opbt{
              border-top: 1px solid black;
          }
          .opup{
              display: flex;
              border-bottom: 1px solid black;
          }
          .vasqr{
              border-top: 1px solid black;
          }
          .sqr{
              padding: 4px;

          }
          #mainplace{
              height: 95%;
width: 94%;
display: grid;
grid-template-columns: repeat(8, 120px);
grid-auto-rows: 110px;
gap: 7px 14px;


          }
          #topvl{
              height: 50%;
              width: 99%;
              display: flex;
              justify-content: center;
              align-items: center;
          }
          #btmvl{
              height: 50%;
              width: 99%;
              display: flex;
              justify-content: center;
              align-items: center;
          }
          #ms{
              width: 80%;
              height: 80%;
              resize: none;
              border-style: none;
              border-radius: 0px;
background: #a4d1c3;
box-shadow: inset 5px 5px 10px #9cc7b9,
          inset -5px -5px 10px #acdbcd;
          font-size: large;
          }
          #vl{
              width: 80%;
              height: 80%;
              resize: none;
              border-style: none;
              border-radius: 0px;
background: #a4d1c3;
box-shadow: inset 5px 5px 10px #9cc7b9,
          inset -5px -5px 10px #acdbcd;
          font-size: large;
          }
          #ms:focus {
  outline: none !important;
  border:1px solid #8bbbac;
  
}
#vl:focus {
  outline: none !important;
  border:1px solid #8bbbac;
}
          .opti{
margin-bottom: 15px;
margin-top: 10px;

margin-right: auto;
background-color: #a4d1c3;

}
.opti > input{ /* Menyembunyikan radio button */

visibility: hidden; 
position: absolute; 

}
.opti > input + div{ /* style gambar */
  cursor:pointer;
border:1px solid #8bbbac;
width: 100px;
height: 20px;
text-align: center;

}

.opti > input:checked + div{ /* (RADIO CHECKED) style gambar */
  border:1px solid #2f423c;
 width: 100px;
height: 20px;
text-align: center;
color: #2f423c;
}
.pin{
  display: none;
}
.btn{
  
  
  border-radius: 20px;


           font-size: large;
           color: #848484;
           overflow: hidden;
           border: 1px solid #dfdcdcfa;
  background: #e7e7e7;
  box-shadow: none !important;
}


::-webkit-scrollbar {
width: 10px;height:10px;
cursor: pointer;
}

/* Track */
::-webkit-scrollbar-track {
  background-color: #bebebe9a;
  
  border-radius: 50px;
}

/* Handle */
::-webkit-scrollbar-thumb {
  
  border-radius: 50px;
  background: linear-gradient(145deg, #58595d, #4a4b4e);

cursor: pointer;
}

/* Handle on hover */
::-webkit-scrollbar-thumb:hover {
  
  border-radius: 50px;
  background: linear-gradient(145deg, #58595d, #4a4b4e);

cursor: pointer;
}
.imgiconclass{
  
  width: 100%;
  height: 64px;
  border-width: 0 0 2px 0;
  border-style: solid;
  
  
}
.imgicon{
  
  width: 100%;
  height: 81px;
  border-width: 3px 0 1.5px 0;
  border-style: solid;

  cursor: pointer;
  
}
.dvtp{
  
  width: 100%;
  height: 62px;

  display: flex;
  justify-content: center;
  align-items: center;
  font-size: large;
  cursor: pointer;
  
}
.dvtb{
  
  width: 100%;
  height: 13px;
  cursor: pointer;
 text-align: end;
  
  
}
.lbltb{
cursor: pointer;
  font-size: small;
  
}
.iconimg{
  cursor: pointer;
  font-size: xx-large;
  filter: invert(12%) sepia(0%) saturate(1%) hue-rotate(1deg) brightness(100%) contrast(90%);
  font-synthesis: none!important;
  font-style: normal;
  border-radius: 50px;
  height: 50px;
  width: 50px;
  
  justify-content: center;
  align-items: center;
  display: flex;
  margin-top: 10px;
}

.divfileclass{
 display: block;
  overflow: hidden;
  
  width: 100%;
  
  height: 100%;
  margin-right: 20px;
font-size: medium;
border-radius: 10px;
direction: ltr;
  text-overflow: ellipsis;
}
.divfile{
  display: block;
  overflow: hidden;
  
  width: 100%;
  
  
  
  text-overflow: ellipsis;
}

.divpar{
  display: block;
  overflow: hidden;
  background: rgba( 255, 255, 255, 0.25 );
/* box-shadow: 0 8px 32px 0 rgba(134, 134, 143, 0.089); */
/* backdrop-filter: blur( 4px ); */
/* -webkit-backdrop-filter: blur( 4px ); */
border-radius: 10px;
border: 1px solid rgb(219, 216, 216);
}
.txtfile{
height: 100%;
overflow: hidden;
width:100%;
white-space: nowrap;
margin-left: 2px;

}
.classdiv{
height: 100%;
width: 100%;
display: block;

}
#loading{
  position: absolute;
  display: none;
  width: 100%;
  height: 100%;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: rgba(0,0,0,0.5);
  z-index: 2;
  cursor: pointer;
  align-items: center;
  justify-content: center;
  overflow: hidden;
}
#lload{
  font-size: xxx-large;
  color: aliceblue;
}
#uploadpage{
      position: fixed;
      display: none;
      width: 100%;
      height: 100%;
      top: 0;
      left: 0;
      background-color: white;
      right: 0;
      bottom: 0;
      background-color: rgba(0,0,0,0.5);
      z-index: 2;
      cursor: pointer;
      align-items: center;
      justify-content: center;
      overflow: hidden; 
      cursor: default;
  }
#loadcov{
  width: 100%;
  height: 100%;
  position: absolute;
}
#addpage{
  z-index: 100;
  height: 350px;
}
.show {
z-index: 1000;
position: absolute;
background-color: #C0C0C0;
border: 1px solid blue;
padding: 2px;
display: block;
margin: 0;
list-style-type: none;
list-style: none;

}

.hide {
display: none;
}

.show li {
list-style: none;
margin: 5px;
  padding: 0;
}
.show ul {

margin: 0;
  padding: 0;


}
.show a {
border: 0 !important;
text-decoration: none;
width: 100%;
  display: block;
}

.show a:hover {
  background-color: #c4c4c473;
}
#gridfoldin{
height: 100%;
width: 100%;

}
#folfill{
height: 200px;
width: 200px;
}
.classfile{
height: 100%;
width: 100%;
display: grid;
grid-template-columns: repeat(2, 80px);
grid-auto-rows: 90px;
gap:5px 5px;
direction: rtl;
}
.classfile2{
height: 100%;
width: 100%;
display: grid;
grid-template-columns: repeat(2, 80px);
grid-auto-rows: 90px;
gap:5px 5px
}
#rightpnl{height: 100%;width: 10%;background-color: transparent;position:absolute;right: 0;align-items: center;display: flex;}#rightchev{content: " ";display: none;border-bottom: 5px solid grey;border-right: 5px solid grey;height: 10px;width: 10px;transform: rotate(-45deg);cursor: pointer;left: 50%;position: absolute;}#leftpnl{height: 100%;width: 3%;background-color: transparent;float: left;position: fixed;align-items: center;display: flex;}#leftchev{content: " ";display: none;border-bottom: 5px solid grey;border-right: 5px solid grey;height: 10px;width: 10px;transform: rotate(-225deg);cursor: pointer;right: 50%;position: absolute;}
#main{

height: 100%;
width:100%;
display: flex;
grid-row:    2 / 14;
grid-column: 2 / 7;

justify-content: center;
align-items: center;
}
#clss{
  grid-row:    2 / 11;  
  overflow: hidden;
  margin-left: 5px;
  margin-bottom: 10px;
}
#keyw{
  grid-row:    11 / 15;  
  margin-left: 5px;
  margin-bottom: 10px;
}
#srch{
  grid-column: 3 / 5;
  margin-top: 5px;
}
#classmap{
height: 85%;
width: 95%;
overflow:overlay;
margin-left: 6px;
margin-top: 7px;
}
.classfile{
height: 120px;
width: 100%;
/* padding: 0 18px; */
border-radius: 10px;
overflow: overlay;

}
.classfile2{
height: 150px;
width: 100%;
/* padding: 0 18px; */
border-radius: 10px;
overflow: overlay;
}
#keywordlist{
height: 85%;
width: 95%;
overflow: overlay;
}
.collapsible {
background-color: #777;
color: white;
cursor: pointer;
padding: 18px;
width: 100%;
border: none;
text-align: left;
outline: none;
font-size: 15px;
border-radius: 10px;
}
.lablre:hover{
  color:black;
}
/* .dropset
{
  display: none;
  position: absolute;
  background-color: #f1f1f1;
  min-width: 160px;
  overflow: auto;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
  z-index: 1;
  margin-left: 10%;
}

.dropset a {
  color: black;
  padding: 12px 16px;
  text-decoration: none;
  display: block;
}

.dropset a:hover {background-color: #ddd;} */
.show {display: block;}
/* blm */
#svnt{
  width: 104%;
  background: rgba( 255, 255, 255, 0.15 );
  box-shadow: 0 8px 32px 0 rgba(100, 100, 102, 0.37);
  cursor: pointer;
backdrop-filter: blur( 7px );
-webkit-backdrop-filter: blur( 7px );
border-radius: 10px;
border: 1px solid #00000054;
}
#svnt:hover{
  background: rgba(255, 255, 255, 0.432);
}
#searcttxt{
  width: 60%;
height: 30px;
border-style: none;
border-radius: 50px;
border: 1px solid #00000059;
background: rgba( 255, 255, 255, 0.15 );
 padding-left: 10px;
 margin-left: -10px;
backdrop-filter: blur( 7px );
-webkit-backdrop-filter: blur( 7px );
border: 1px solid #d3d0d0;
}
#sz{
  
  justify-content: center;
  align-items: center;
  display: flex;
  margin-bottom: 10px;
}
#tl{
  grid-column: 2 / 4;
  justify-content: center;
  align-items: center;
  display: flex;
  margin-bottom: 10px;
}
.circlebtn{
  border-radius: 50px;
border-style: none;
height: 30px;
width: 30px;
font-size: medium;
font-weight: bold;
margin-left: 5px;
text-align: center;
color: #848484;
cursor: pointer;
border-radius: 50%;
  background: linear-gradient(145deg, #f0f0f0, #cacaca);
  box-shadow: 5px 5px 42px #d0d0d0, -5px -5px 42px #f0f0f0;
}
.circlebtn:hover{
  border-radius: 50%;
background: #e0e0e0;
box-shadow: inset 5px 5px 42px #d0d0d0,
            inset -5px -5px 42px #f0f0f0;
}
#pathline{
  
border-radius: 50px;
height: 30px;
width: 70%;
border:1px solid #00000059;
background: rgba( 255, 255, 255, 0.15 );
 padding-left: 10px;
  margin-left: -10px;
backdrop-filter: blur( 7px );
-webkit-backdrop-filter: blur( 7px );
border: 1px solid #d3d0d0;
}
.frupl{display: flex;
justify-content: center;
align-items: center;}
.cirbtn{
  border-radius: 50px;
border-style: none;
height: 30px;
width: 70px;
font-size: medium;
font-weight: bold;
margin-left: 5px;
}
#refresh{
  
font-size: x-large;
font-weight: lighter;
}
#pthl{
  grid-column: 1 / 3;
  margin-left: 5px;
  margin-top: 5px;
}
/*  */
.lblmid{
  width: 100%;
  display: flex;
  justify-content: center;
  align-items: center;
  height: 30px;
}
#txtar{
  height: 100%;
  width: 100%;
  resize: none;
  background: rgba( 255, 255, 255, 0.15 );
  box-shadow: 0 8px 32px 0 rgba(100, 100, 102, 0.37);
  
backdrop-filter: blur( 7px );
-webkit-backdrop-filter: blur( 7px );
border-radius: 10px;
border: 1px solid #00000054;
}
#folfill{
  margin: 0;
  background-color: transparent;
  border-style: none;
}
#cl2{

width: 100%;
overflow: overlay;
margin-top: 10px;
margin-bottom: 10px;
}
.opb > input{ /* Menyembunyikan radio button */

visibility: hidden; 
position: absolute; 

}
.opb > input + div{ /* style gambar */
cursor:pointer;
border:2px solid black;

width: 95px;
height: 20px;
text-align: center;
font-size: small;
font-weight: bold;
}

.opb > input:checked + div{ /* (RADIO CHECKED) style gambar */
border:2px solid #009879 ;
width: 95px;
height: 20px;
text-align: center;
font-size: small;
font-weight: bold;
}
.txtinp{
border-radius: 50px;
border-style: none;
}
#additm{
width: 100%;
display: none;
}
#addproject{
  cursor: pointer;
height: 40px;
width: 300px;
align-items: center;
display: flex;
justify-content: center;
color: white;
border-radius: 50px;
border: 1px solid;
margin: 10px;
background-color: transparent;
font-size: medium;
}
#addclass{
cursor: pointer;
height: 40px;
width: 300px;
align-items: center;
display: flex;
justify-content: center;
color: white;
border-radius: 50px;
border: 1px solid;
margin: 10px;
background-color: transparent;
font-size: medium;
}
#addlnk{
background-color: transparent;
font-size: medium;
color: white;
border-radius: 50px;
border: 1px solid;
cursor: pointer;
margin-left: 5px;
}
#rmenu{
  background: rgba( 255, 255, 255, 0.15 );
  box-shadow: 0 8px 32px 0 rgba(100, 100, 102, 0.37);
  
backdrop-filter: blur( 7px );
-webkit-backdrop-filter: blur( 7px );
border-radius: 10px;
border: 1px solid #00000054;
}
#rdefmenu{
  background: rgba( 255, 255, 255, 0.15 );
  box-shadow: 0 8px 32px 0 rgba(100, 100, 102, 0.37);
  position:absolute;
  
backdrop-filter: blur( 7px );
-webkit-backdrop-filter: blur( 7px );
border-radius: 10px;
border: 1px solid #00000054;
width: 100px;
height: 200px;

}
#listopw{
  overflow:overlay;
  height: 180px;
  width:100%;
}
#rpmenu{
  background: rgba( 255, 255, 255, 0.15 );
  box-shadow: 0 8px 32px 0 rgba(100, 100, 102, 0.37);
  
backdrop-filter: blur( 7px );
-webkit-backdrop-filter: blur( 7px );
border-radius: 10px;
border: 1px solid #00000054;
}
#setmenu{
  background: rgba( 255, 255, 255, 0.15 );
  box-shadow: 0 8px 32px 0 rgba(100, 100, 102, 0.37);
  
backdrop-filter: blur( 7px );
-webkit-backdrop-filter: blur( 7px );
border-radius: 10px;
border: 1px solid #00000054;
}
#setmenu a{
  text-align: center;
  font-size: small;
}
#pgmenu{
  background: rgba( 255, 255, 255, 0.15 );
  box-shadow: 0 8px 32px 0 rgba(100, 100, 102, 0.37);
  
backdrop-filter: blur( 7px );
-webkit-backdrop-filter: blur( 7px );
border-radius: 10px;
border: 1px solid #00000054;
}
#setmenu{
  background: rgba( 255, 255, 255, 0.15 );
  box-shadow: 0 8px 32px 0 rgba(100, 100, 102, 0.37);
  
backdrop-filter: blur( 7px );
-webkit-backdrop-filter: blur( 7px );
border-radius: 10px;
border: 1px solid #00000054;
}
#pgtp{
  cursor: pointer;
}
#rpmenu2{
  background-color: #fdfdfd;
  border: 1px solid #00000054;
  border-radius: 20px;
}
#setdrop{
  border: 1px solid #00000054;
  background: rgba( 255, 255, 255, 0.15 );
  box-shadow: 0 8px 32px 0 rgba(100, 100, 102, 0.37);
  
backdrop-filter: blur( 7px );
-webkit-backdrop-filter: blur( 7px );
border-radius: 10px;
  padding: 7px;
}
#setdrop label{
width: 50px;

}
#setdrop label:hover{
  background-color: #c4c4c473;
  cursor: pointer;

}
a{
cursor: pointer;
}
.lstbtndiv{
grid-column: 5 / 8;
margin-right: 6px;
}
.lablre{
  cursor: pointer;
}
#editupl{
  background: rgba( 205, 196, 196, 0.15 );
box-shadow: 0 8px 32px 0 rgba( 31, 38, 135, 0.37 );
backdrop-filter: blur( 1.5px );
-webkit-backdrop-filter: blur( 1.5px );
border-radius: 10px;
overflow-x: hidden;
}
#newitemin{
  background: rgba( 205, 196, 196, 0.15 );
box-shadow: 0 8px 32px 0 rgba( 31, 38, 135, 0.37 );
backdrop-filter: blur( 1.5px );
-webkit-backdrop-filter: blur( 1.5px );
border-radius: 10px;
overflow-x: hidden;
}
#pgnm{
  margin-left: 10px;
  border-radius: 50px;
  
  text-align: center;
  border: 1px solid #00000059;
  height: 24px;
  background: rgba( 255, 255, 255, 0.15 );
 padding-left: 10px;
  
backdrop-filter: blur( 7px );
-webkit-backdrop-filter: blur( 7px );
border: 1px solid #d3d0d0;
}
#pglst{
  height: 50px;
  width: 100%;
  overflow: overlay;
  list-style-position: inside;
  
}
#pglst li{
cursor: pointer;
}
#addnm{
  cursor: pointer;
height: 40px;
width: 300px;
align-items: center;
display: flex;
justify-content: center;
color: white;
border-radius: 50px;
border: 1px solid;
margin: 10px;
background-color: transparent;
font-size: medium;

}
#addflnm{
  cursor: pointer;
height: 40px;
width: 300px;
align-items: center;
display: flex;
justify-content: center;
color: white;
border-radius: 50px;
border: 1px solid;
margin: 10px;
background-color: transparent;
font-size: medium;

}
#menusvitm{
  position: absolute;
  height: 150px;
  width: 200px;
  
  background: rgba( 255, 255, 255, 0.15 );
  box-shadow: 0 8px 32px 0 rgba(100, 100, 102, 0.37);
  backdrop-filter: blur( 7px );
  -webkit-backdrop-filter: blur( 7px );
  border-radius: 10px;
  border: 1px solid #00000054;
}
#gridmenu{
  height: 120px;
  width: 200px;
  overflow: overlay;
  background: rgba( 255, 255, 255, 0.15 );

backdrop-filter: blur( 4px );
-webkit-backdrop-filter: blur( 4px );
border-radius: 10px;
}
.spr{
  background: linear-gradient(to right, #e7e7e7,#9f9f9f,#e7e7e7);
  height: 1px;
  width: 100%;
}
#btncl{
  border-radius: 50%;
  background: #ffffff;
  cursor:pointer;
  color: #848484;
  border-style: none;
}
#btncl:hover{
  background: #cfcece;
}
#updbtn{
  background: #e0e0e0;
/* box-shadow: inset 5px 5px 42px #d0d0d0,
            inset -5px -5px 42px #f0f0f0; */
            padding-bottom: 6px;
            padding-left: 4px;
            
}
#newpgnm{
  padding-left: 10px;
}
#dname{
  background: transparent;
  border-style: none;
  width: 90%;
  font-size: large;
  color: #848484;
  text-align: center;
}
.dvncov{
  width: 100%;
  height: 100%;
  background: transparent;
  border-style: none;
  margin-top: -2px;
  margin-left: -122px;
  cursor: pointer;
  font-size: xx-large;
  filter: invert(12%) sepia(0%) saturate(1%) hue-rotate(1deg) brightness(100%) contrast(90%);
  font-synthesis: none!important;
  font-style: normal;
  
 
  
  justify-content: center;
  align-items: center;
  display: flex;
  
}
#lload{
    font-size: xxx-large;
    color: aliceblue;
    display: none;
}
#imgicon{
  height:40px;
  width:40px;
}
#cov{
  height:100%;
  width:100%;
  display:flex;
}
#editor{
  height:100%;
  width:30%;
  overflow:auto;
}
     #bodyall{
              height: 100%;
              
              width: 100%;
              display: grid;
              grid-template-columns: repeat(6, 220px);
grid-template-rows: repeat(15, 43px);
grid-gap: 0.5em;
transform: scale(0.64);
    transform-origin: top left;
          }
          #bodcov{
         height: 450px;
  width: 880px;
          }
      </style>
    </head>
    <body>
   
      <div id="loading"  ><label id="lload">Loading . . .</label><div id="loadcov" onclick="dissap()"></div> <div id="addpage"><div style=" display: block; width: 100%;height: 100%;"><div id="newitemin" style="border: 1px solid;overflow: auto; width: 100%; height: 100%; cursor: default;"><div style="display: flex;justify-content: center;padding: 5px;font-family: sans serif;color: white;font-weight: bold;margin-top: 20px;"><label>ADD ITEM</label></div>
      <div class="hmhd" style=" cursor: default;width: 100%; height: 50px; justify-content: center; align-items: center;display: flex;margin-top: 10px;">
        <input type="file"  name="file" id="filedrop" style="display: none;" ><label for="filedrop"  id="filedroplabel" style="cursor: pointer; height: 90%; width: 300px;align-items: center;display: flex;justify-content: center; color: white;margin-left:10px;border-radius: 50px;border: 1px solid;">Upload</label></div><div  style=" cursor: default;width: 100%; height: 50px; justify-content: center; align-items: center;display: flex;margin-top: 10px;"><input type="file" name="filedropfolder" id="filedropfolder" style="display: none;"  webkitdirectory directory><label for="filedropfolder"  id="filedroplabel" style="cursor: pointer; height: 90%; width: 300px;align-items: center;display: flex;justify-content: center; color: white;border-radius: 50px;border: 1px solid;">Upload Folder</label></div><div style="height: 30px;margin:10px; display: flex;"><input type="text" class="txtinp hmhd" style="height: 30px;
  " id="lnk"><button class="hmhd" id="addlnk">Add Link</button></div><br><button class="hmhd" id="addclass">Add Class</button><br><button  id="addproject">Add Project</button>
  </div>
  <div id="newpage" style="display:none;border: 1px solid;overflow: auto; width: 100%; height: 100%; cursor: default;"><div style="height: 30px;margin:10px; display: block;"> <div style="display: flex;justify-content: center;padding: 5px;font-family: sans serif;color: white;font-weight: bold;margin-top: 20px;">
    <label>Edit Page</label>
</div><input type="text" class="txtinp" style="height: 30px; width: 300px; margin: 10px;
  " id="newpgnm"><br><br><button id="addnm">Save</button></div>
  </div>
  <div id="savenewfile" style="display:none;border: 1px solid;overflow: auto; width: 100%; height: 100%; cursor: default;"><div style="height: 30px;margin:10px; display: block;"> <div style="display: flex;justify-content: center;padding: 5px;font-family: sans serif;color: white;font-weight: bold;margin-top: 20px;">
    <label>File Already Exists, Rename</label>
</div><input type="text" class="txtinp" style="height: 30px; width: 300px; margin: 10px;
  " id="newfilenm"><br><br><button id="addflnm">Save</button></div>
  </div>
      <div id="editupl" style="overflow-x: hidden; width: 100%; height: 100%; cursor: default; display: none;">
          <div style="display: flex;justify-content: center;padding: 5px;font-family: sans serif;color: white;font-weight: bold;margin-top: 20px;">
              <label>Edit File Uploaded</label>
          </div><div style="width: 100%; height: 210px;display: block;align-items: center;justify-content: center;"><div style="display: block;justify-content: center;align-items: center;height: 220px; width: 300px;color: white;border-radius: 15px;border: 1px solid white;text-align: center;"><label class="txt2">Filename : </label><br> <input type="text" class="txtinp" id="flnm"><br><label class="txt2">Keywords : </label><br><input type="text" id="flkey" class="txtinp"><br><small>(comma , to seperate)</small><br><label class="txt2">Background Color : </label><br>
            <div style="display: inline-flex; margin-top: 10px; overflow-x: hidden;">
              <div id="cl2l">
            <label class="opb" >
              <input type="radio" id="opbgc" name="opb" class ="opb" value="color" checked>
              <div width="100px" height="30px" >Color</div>
          </label>
          <input type="color" id="flbg" value="#000000" style="margin-top:0px; width:100%;">
          </div>
          <div id="cl2r">
          <label class="opb" >
            <input type="radio" id="trpc" name="opb" class ="opb" value="transparent" >
            <div width="100px" height="30px" >Transparent</div>
          </label>
          
          </div>
          <div id="cl2s">
            <label class="opb" >
              <input type="radio" id="opbsv" name="opb" class ="opb" value="picture" >
              <div width="100px" height="30px" >Saved Color</div>
            </label>
            <select id="slcol"></select>
            </div>
          </div><br>
          <div> <label>Icon :</label><br>
          <img id="imgicon"><br>
          <input type="file" accept="image/*" id="geticon" hidden>
          <button id="btnicon" onclick="document.getElementById('geticon').click();">Get</button>
          <input type="text" id="icontxt">
          </div><br>
          <label>Style :</label><br>
          <select id="slsty">
            <option value="none">none</option>
            <option value="solid" selected>solid</option>            
            <option value="dotted">dotted</option>
            <option value="dashed">dashed</option>
          </select>
            </div></div><br>
            <div style="display: flex;justify-content: center;"><label>Class</label></div>
          <div id="classchose" style=" cursor: default;width: 100%; height: 200px; margin-top: 10px;">
            <select id="slclass"></select>
          </div>
          </div><button id="additm">ADD</button>
  </div></div></div>
  <div id="cov">
    <div id="editor">
      <fieldset id="backg">
  <legend>Background</legend>
  <label>Background Color</label>
  <br><input type="color" id="bbgc1"><br>
  <label>Background Image</label>
  <br><input type="file" id="bgimg"><br>
</fieldset>
 <fieldset id="griddi">
  <legend>Body</legend>
  <label>Background Color</label>
  <br><input type="color" id="colorPicker1">
<input type="range" id="opacitySlider1" min="0" max="100" value="100"><br>
  <label>Font Color</label>
  <br><input type="color" id="fcl1"><br>
  <label>Border Color</label>
  <br><input type="color" id="colorPicker1a">
<input type="range" id="opacitySlider1a" min="0" max="100" value="100"><br>
  <label>Border Size</label>
  <br><input type="number" id="bds1"><small>px</small><br>  
</fieldset>
<fieldset id="griditem">
  <legend>Grid Item</legend>
   <label>Background Color</label>
  <br><input type="color" id="colorPicker2">
<input type="range" id="opacitySlider2" min="0" max="100" value="100"><br>
   <label>Border Color</label>
  <br><input type="color" id="colorPicker2a">
<input type="range" id="opacitySlider2a" min="0" max="100" value="100"><br>
  <label>Border Size</label>
  <br><input type="number" id="bds2" ><small>px</small><br>  
  <label>Font Color</label>
  <br><input type="color" id="fcl4"><br>
</fieldset>
<fieldset id="buttonitem">
  <legend>Button</legend>
  <label>Background Color</label>
  <br><input type="color" id="colorPicker3">
<input type="range" id="opacitySlider3" min="0" max="100" value="100"><br>
<label>Background Color Hover</label>
  <br><input type="color" id="colorPicker6">
<input type="range" id="opacitySlider6" min="0" max="100" value="100"><br>
  <label>Font Color</label>
  <br><input type="color" id="fcl2"><br>
</fieldset>
<fieldset id="spritem">
  <legend>Separation</legend>
  <label>Background Color</label>
  <br><input type="color" id="bbgc2"><br>
  
</fieldset>
<fieldset id="spritem">
  <legend>Text Input</legend>
  <label>Border Color</label>
  <br><input type="color" id="colorPicker4">
<input type="range" id="opacitySlider4" min="0" max="100" value="100"><br>
  
</fieldset>
    <fieldset >
  <legend>Icon</legend>
  
  <label>Background Image</label>
  <br><input type="file" id="ticonimg"><br>
</fieldset>
<button onclick="savecss();" style="width:100%">Save</button>
  </div>
  <div id="bodcov">
          <div id="bodyall">
            
            <div class="btn frupl" id="pthl" ><input type="text" id="pathline" readonly><button onclick="homepath();" class="circlebtn" title="Home">&#9750;</button><button onclick="backpath();" title="Previous" class="circlebtn">&#9001;</button><button onclick="forwardpath()" title="Next" class="circlebtn">&#9002;</button></div>
            
            <div class="btn frupl" id="srch"><input type="text" id="searcttxt" ><input type="checkbox" name="keywrd" id="keywrd"><small for="keyw">Keyword</small><button onclick="srch()" class="circlebtn" title="Search">&#128269;</button><button id="refresh" style="font-size: 21px; padding-top: 3px;" class="circlebtn" onclick="location.reload();" title="Refresh">&#8635;</button></div>
            
            <div class="btn frupl lstbtndiv" style="margin-top: 5px;" > 
              <button onclick="dropbtn()" class="dropbtn circlebtn" id="addbtn" title="Add Item">&#10133;</button> 
              <button onclick="dropsett(event)" class="dropbtn circlebtn" style="font-size: 15px;" id="addpagebtn" title="Add Page">&#128452;</button> 
              
              <button  class="dropbtn circlebtn" onclick="droptext(event)" title="Note">&#128221;</button> <button  class="dropbtn circlebtn" onclick="makefolder()" title="Make A Folder &#013; saved in '/home/{name}/FileyTale">&#128450;</button><button  class="dropbtn circlebtn" onclick="window.open('./infopage.html','popup','width=600,height=600');" title="Info">&#128226;</button><button  class="dropbtn circlebtn" id="updbtn" onclick="window.open('./updatepage.html','popup','width=600,height=600');" title="Update" >&#128229;</button><button  class="dropbtn circlebtn" onclick="dropseting(event)" style=""  title="Setting">&#128295;</button> <button onclick="opennewwindow()" class="dropbtn circlebtn" style="font-size: 17px;" id="addnewwin" title="Add New Window">&#10064;</button><button onclick="activeediticon();" class="dropbtn circlebtn" style="font-size: 17px;" id="adddesktop" title="Make A Desktop Icon From This Folder">&#128421;</button><button onclick="dropsetingappbat(event);" class="dropbtn circlebtn" style="font-size: 17px;" id="appbat" title="Multiple Document">&#9923;</button> </div>
           
              <div id="setdrop" class="dropset hide">
                
                <label onclick="addpage()" >Normal</label>
                <br>
                
                <label onclick="addpagecls()" class="hompg">Only Class Page</label>
                <br>
                
                <label onclick="addpageitem()" class="hompg">Only Item Page</label>
              </div>
              <div class="btn" id="clss">
                <div class="lblmid"><label id="clslbl">Class</label></div><div class="spr"></div>
              <div id="classmap"></div>
            </div>
            <div class="btn" id="main">
              <div id="mainplace"></div>
              
            </div>
            
            <div class="btn" id="keyw"><div class="lblmid"><label>Keywords</label></div><div class="spr"></div><div id="keywordlist"></div></div>
            <div class="btn" id="tl"><input type="text" id="dname" readonly></div>
            
            
            <div class="btn" id="sz"><label id="dtype"></label></div>
            <div class="btn frupl lstbtndiv" style="margin-bottom: 10px;"><label id="pgtp"></label>
              <button  class="dropbtn circlebtn" id="prevbtn" title="Previous (Ctrl + left)">&#9001;</button><button  class="dropbtn circlebtn" title="Next (Ctrl + right)" id="nextbtn">&#9002;</button> <input type="text" id="pgnm" readonly></div>
            
            
            
         </div>
        </div>
        </div>
         <div class="hide" id="filemenu" ></div>
         <div class="hide" id="rpmenu" >
          <ul>
            <li>
              <a onclick="pasteitm();" >Paste (Ctrl + v)</a>
              </li>
              <li>
                <a onclick="editpage();" >Edit</a>
              </li>
              <li>
                <a onclick="opsvcp(event);" >Temporary Box</a>
              </li>
              <li>
              <a onclick="deletepage();" style="color: red;">Delete</a>
            </li>
          </ul>
          </div>
          <div class="hide" id="pgmenu" >
            <ul>
              <li>
                <input type="text" id="searchpg" onkeyup="srchpage();" placeholder="Search">
                </li>
            </ul>
            <div id="pglst">

            </div>
            </div>
         <div class="hide" id="rpmenu2" >
         
              <a onclick="pasteitm2();">Paste</a>
        </div>
        <div class="hide" id="setmenu" >
         
          <input type="checkbox" name="preview" id="preview"><small for="preview">File Preview</small>
          <a onclick="window.open('./paywall.html','popup','width=600,height=600');" title="Premium">Premium</a>
          <a onclick="window.open('./licensepage.html','popup','width=600,height=600');" title="Licenses">Licenses</a>
    </div>
        <div class="hide" id="menusvitm" >
          <button id="btncl" onclick="{ document.getElementById('menusvitm').className = 'hide';}">X</button>
          
    </div>

         <div class="hide" id="rmenu" >
          <ul>
            <li>
              <a onclick="openitm('custom');" class="clsp">Open</a>
            </li>
            <li>
              <a onclick="openitm('default');" class="mnu clsp">Open With Default</a>
            </li>
            <li>
              <a onclick="dropopw();" class="mnu clsp">Open With ...</a>
            </li>
            <li>
              <a onclick="openitm('sif');" class="mnu clsp">Show In Folder</a>
            </li>
            <li>
              <a onclick="edititm();">Edit</a>
            </li>        
            <li>
              <a onclick="cutitm();" class="mnu clsp">Cut Item (Ctrl + x)</a>
            </li>
            <li>
              <a onclick="copyitm();" class="clsp">Copy Item (Ctrl + c)</a>
            </li>
            
            <li>
              <a onclick="movefile();" class="mnu clsp">Move File To Box</a>
            </li>
            <li>
              <a onclick="copyfile();" class="mnu clsp">Copy File To...</a>
            </li>
            <li>
              <a onclick="dltitm();" class="clsp"  style="color: rgb(255, 0, 85);">Delete Item (Ctrl + delete)</a>
            </li>
            <li>
              <a onclick="dltitm();" class="clsp cols" id="dltt" style="color: rgb(255, 0, 85);">Delete Item</a>
            </li>
            <li>
              <a onclick="dltfile();" class="mnu" style="color: red;">Permanently Delete</a>
            </li>

            <li>
              <a onclick="properties();" class="mnu clsp">Properties</a>
            </li>
           
          </ul>
        </div>
        <div class="hide" id="rdefmenu" >
          <ul>
            <li>
              <a onclick="openitm('custom');" class="clsp">Open</a>
            </li>
           
           
          </ul>
        </div>
        <div class="hide" id="rdefmenu" >
          <ul>
            <li>
              <input type="text" id="searchpg" onkeyup="srchpage();" placeholder="Search">
              </li>
          </ul>
          <div id="listopw"></div>
        </div>
        <div class="hide" id="folfill">
          
        <textarea id="txtar"></textarea><br>
        <button id="svnt" onclick="savenote()">Save</button>
        </div>
        <div class="hide"  id="folfill">
          
          <textarea id="code"></textarea><br>
          <button id="svcode" onclick="execute()">Save</button>
          </div>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.0/jszip.min.js"></script>
         <link rel="stylesheet" href="style.css">
        <script>
          // import trash from 'trash';
          // const path = require("path");
          // const fs = require("fs");
          // const trash = require('trash');
        //   try{
        //     trash;
        // }catch(e){alert(e)}
          // import trash from 'trash';
          // const xdgTrashdir = require('xdg-trashdir');
          var d={"file":[{"filename":"Calculus I","filepath":"/home/lawliet/Downloads/tutorina/halo","keywords":"task","type":"folder","background":"#e6ba41","style":"solid","class":"","page":1,"ids":33},{"filename":"lek","filepath":"/home/lawliet/Downloads/20240914_210455.jpg","keywords":"","type":"file","background":"#a18787","style":"","icon":"","class":"","page":1,"ids":0},{"filename":"test.desktop","filepath":"/home/lawliet/Desktop/test.desktop","keywords":"","type":"file","background":"#99f09f","style":"","icon":"","class":"Tutorial","page":1,"ids":10},{"filename":"Screencast from 08-06-2024 12:02:36 PM.webm","filepath":"/home/lawliet/Videos/Screencasts/Screencast from 08-06-2024 12:02:36 PM.webm","background":"#469166","keywords":"","ids":16,"class":"","page":1,"type":"file"},{"filename":"ff","filepath":"/home/lawliet/Downloads/tutorina/ff","keywords":"","type":"folder","background":"#e6ba41","style":"solid","class":"Tutorial","page":1,"ids":3},{"filename":"ff","filepath":"/home/lawliet/Downloads/tutorina/ff","background":"#e6ba41","style":"solid","keywords":"","ids":32,"class":"","page":1,"type":"folder"},{"filename":"open.html","filepath":"/home/lawliet/Downloads/tutorina/open.html","background":"black","style":"solid","keywords":"","ids":6,"class":"Tutorial","page":1,"type":"file"},{"filename":"webapp","filepath":"/home/lawliet/Downloads/Pinasi/webapp","background":"#e6ba41","style":"solid","keywords":"","ids":5,"class":"Tutorial","page":1,"type":"folder"},{"filename":"appbt_2_.ico","filepath":"/home/lawliet/Downloads/iconappb/appbt_2_.ico","background":"black","style":"solid","keywords":"","ids":3,"class":"Tutorial","page":1,"type":"file"},{"filename":"mainpage","filepath":"http://wistanomic.com/?i=1","keywords":"","type":"web","background":"#b47474","style":"solid","class":"","page":1,"ids":39,"icon":""},{"filename":"uploads","filepath":"/home/lawliet/Downloads/tutorina/uploads","background":"#e6ba41","style":"solid","keywords":"","ids":7,"class":"","page":1,"type":"folder"},{"filename":"circle","filepath":"/home/lawliet/Downloads/cyrcle.png","keywords":"","type":"file","background":"#a18787","style":"","icon":"","class":"Tutorial","page":1,"ids":9},{"filename":"aja","filepath":"/home/lawliet/Downloads/tutorina/aja","background":"#e6ba41","style":"","keywords":"","ids":6,"class":"Tutorial","page":1,"type":"folder"},{"filename":"test.desktop","filepath":"/home/lawliet/Desktop/test.desktop","keywords":"","type":"file","background":"#c03030","style":"solid","icon":"","class":"","page":1,"ids":1},{"filename":"version.json","filepath":"/home/lawliet/Downloads/tutorina/version.json","keywords":"","type":"file","background":"#000000","style":"solid","icon":"","class":"Tutorial","page":1,"ids":8},{"filename":"version.json","filepath":"/home/lawliet/Downloads/tutorina/version.json","background":"black","style":"solid","keywords":"","ids":2,"class":"","page":1,"type":"file"},{"ids":5,"filename":"test fileytale.ods","filepath":"/home/lawliet/Documents/test fileytale.ods","keywords":"test","type":"file","background":"#905a5a","style":"solid","class":"","page":1},{"ids":6,"filename":"math","filepath":"/home/lawliet/Downloads/tutorina/project/math","keywords":"","type":"folder","background":"#e6ba41","style":"solid","class":"","page":1},{"filename":"ssl","filepath":"/home/lawliet/Downloads/tutorina/gridas","keywords":"","type":"folder","background":"#e6ba41","style":"solid","class":"Classsss","ids":0,"page":2},{"filename":"version.json","filepath":"/home/lawliet/Downloads/tutorina/version.json","background":"black","keywords":"","ids":2,"class":"Tutorial","page":1,"type":"file"},{"filename":"https://wistanomic.com/","filepath":"https://wistanomic.com/","background":"#b47474","style":"solid","keywords":"reference","ids":31,"class":"","page":1,"type":"web","icon":""},{"filename":"llps.json","filepath":"/home/lawliet/debpkgs/Pinasi_Premium_v1.6_amd64/usr/bin/pinasi/public_html/llps.json","keywords":"key","type":"file","background":"#000000","style":"solid","icon":"","class":"Tutorial","page":1,"ids":11},{"filename":"aja","filepath":"/home/lawliet/Downloads/tutorina/aja","keywords":"","type":"folder","background":"#e6ba41","style":"","icon":"","class":"","page":1,"ids":10},{"filename":"20221029_171739.jpg","filepath":"/home/lawliet/Downloads/tutorina/uploads/20221029_171739.jpg","background":"transparent","style":"solid","keywords":"","ids":13,"class":"","page":1,"type":"file"},{"filename":"test.desktop","filepath":"/home/lawliet/Desktop/test.desktop","background":"transparent","keywords":"","ids":14,"class":"","page":1,"type":"file"},{"filename":"upload","filepath":"/home/lawliet/Downloads/tutorina/ccs/upload","keywords":"","type":"folder","background":"#e6ba41","style":"solid","icon":"","class":"","page":1,"ids":8},{"filename":"Copy of Tired of cluttered files.png","filepath":"/home/lawliet/Documents/Copy of Tired of cluttered files.png","keywords":"","type":"file","background":"#000000","style":"solid","icon":"","class":"Tutorial","page":1,"ids":10},{"filename":"listfile.json","filepath":"./project/math III/listfile.json","background":"transparent","style":"solid","keywords":"","ids":0,"type":"file","class":"","page":3},{"ids":1,"filename":"progcode.html","filepath":"/home/lawliet/Downloads/Pinasi/webapp/progcode.html","keywords":"","type":"file","background":"#000000","style":"solid","icon":"","class":"","page":3},{"ids":2,"filename":"nw","filepath":"/home/lawliet/Downloads/Pinasi/nw","keywords":"","type":"file","background":"#000000","style":"solid","icon":"","class":"","page":3},{"ids":12,"filename":"itunes_14124.ico","filepath":"","keywords":"","type":"file","background":"#000000","style":"solid","icon":"","class":"","page":3},{"filename":"uploads","filepath":"//home/lawliet/Downloads/tutorina/uploads","keywords":"","type":"folder","background":"#5b5a90","style":"solid","icon":"","class":"","page":3,"ids":11},{"filename":"progar.json","filepath":"./project/math III/progar.json","background":"transparent","style":"solid","keywords":"","ids":3,"type":"file","class":"","page":3},{"ids":4,"filename":"iconappb","filepath":"/home/lawliet/Downloads/iconappb","keywords":"","type":"folder","background":"#e6ba41","style":"solid","icon":"","class":"","page":3},{"filename":"youtube_14198 (1).ico","filepath":"/home/lawliet/Documents/youtube_14198 (1).ico","keywords":"","type":"file","background":"#000000","style":"solid","icon":"","class":"Classsss","ids":0,"page":2},{"ids":5,"filename":"tubox.html","filepath":"/home/lawliet/Downloads/Pinasi/webapp/tubox.html","keywords":"","type":"file","background":"#9f5050","style":"solid","icon":"","class":"","page":3}],"pagesort":["normal","class","item"],"pagename":["Try","2","3"]}
          var arfile=d["arfile"]
          var curpage=1;
          var classfile=[{"classname":"Tutorial","list":[],"background":"#97d39b","keywords":"","fil":-18,"ids":0,"page":1},{"classname":"Classsss","list":[27,27,72,21],"background":"#4d5c2e","keywords":"","fil":1,"ids":1,"page":2}]
          // var totalpage=1;
          var code =document.getElementById("code");
            var addbtn =document.getElementById('addbtn');
            var additm =document.getElementById('additm');
            var savenewfile =document.getElementById('savenewfile');
            var addflnm =document.getElementById('addflnm');
            var newfilenm =document.getElementById('newfilenm');
            var addproject =document.getElementById('addproject');
            var ift =document.getElementById('ift');
            var mainplace =document.getElementById('mainplace');
            var flnm =document.getElementById('flnm');
            var flkey =document.getElementById('flkey');
            var flbg =document.getElementById('flbg');
            var trpc=document.getElementById('trpc');
            var addlnk=document.getElementById('addlnk');
            var addclass =document.getElementById('addclass');
            var lnk=document.getElementById('lnk');
            // var editw =document.getElementById('editw');
            var classmap = document.getElementById('classmap');
            var keywordlist = document.getElementById('keywordlist');
            var dname = document.getElementById('dname');
            var dtype = document.getElementById('dtype');
            var pgtp =document.getElementById('pgtp');
            var chpg =document.getElementById('chpg');
            var keywrd =document.getElementById('keywrd');
            var pathline =document.getElementById('pathline');
            var classchose=document.getElementById('classchose');
            var slcol= document.getElementById('slcol');
            var txtar =document.getElementById('txtar');
            var slclass =document.getElementById('slclass');
            var slsty =document.getElementById('slsty');
            var pglst =document.getElementById('pglst');
            var pgnm =document.getElementById('pgnm');
            var preview =document.getElementById('preview');
            var imgicon =document.getElementById('imgicon');
            var geticon =document.getElementById('geticon');
            var btnicon =document.getElementById('btnicon');
            var icontxt=document.getElementById('icontxt');
            var arfile=[];
            var arcpy=[];
            var arprcpy=[];
            var imgl={};
            var imcoun={};
            var foldsort=["home"];
            var pathsort=["home"];
            var pagesort=['normal'];
            var pagenamelst=['1'];
            var flpath;            
            var pathtype, pathname,itemtype,lastpath,folderpath;
            var eventrgt;
            var itmpg;
            var pagetype;
            var vid=0;
            var editim=false;
            var tlitem=54;
            var pathcount=1;
            var grfst=false;
            var clss=false;
            var editclass=false;
            var pathclick;
            var fold=false;
            var claspage=false; 
            var pgtpon=false;
            var objpath,objtype;
            var formData= new FormData();
            var fildet;
            var lff;
            var hmfl;
            var exten={};
            var extlas=[];
            pathtype="custom";
            pathname="Home";
            try{
              makeicon();
            }catch(e){alert(e)}
            // const homedir = require('os').homedir();
            // var trashPath = homedir+'/.local/share/Trash';
//             (async () => {
//               alert(await xdgTrashdir());
// 	//=> '/home/johndoe/.local/share/Trash'

// 	// console.log(await xdgTrashdir('foo.zip'));
// 	//=> '/media/johndoe/UUI/.Trash-1000'

// 	alert(await xdgTrashdir.all());
// 	//=> ['/home/johndoe/.local/share/Trash', '/media/johndoe/UUI/.Trash-1000', …]
// })();
//             var args = nw.App.argv;
//             if(args[0]){
//               alert("Received text: " + args[0]);
//               var button = args[0];
//               mainplace.innerHTML="";
//             classmap.innerHTML="";
//             curpage=1;
//             arfile=[];
//               classfile=[];
//                pagesort=["normal"];
//             pagenamelst=["1"]
//             try{
//                if(fs.lstatSync(args[0]).isDirectory()){
//                 if(pathcount==(pathsort.length)){
//               foldsort.push("folder");
//               pathsort.push(args[0]);
//             }
//             else{
//               foldsort[pathcount]="folder";
//               pathsort[pathcount]=args[0];
//               var a = pathcount+1;
// var b = pathsort.length;

// pathsort.splice(a, (b - a) + 1);
// foldsort.splice(a, (b - a) + 1);
//             }
                
//     pathcount++;
//   pathtype="folder";
//   pathname=args[0];
//   var arflrc =[];
//     // if(localStorage.getItem("recent")){
//       if(localStorage.getItem('recentfpl')){
//     arflrc = JSON.parse(localStorage["recentfpl"]);
//       }

//   // var arc=[];
//  if(arflrc.length==7){
//   arflrc.pop();
//  }
//   arflrc.splice(0, 0, args[0]);
//   let unique_ar = [];
//   arflrc.forEach((ar) => {
//     if (!unique_ar.includes(ar)) {
//       unique_ar.push(ar);
//     }
//   });
  
  
//   localStorage["recentfpl"] = JSON.stringify(unique_ar);
 
//                }
// }catch(e){
//   alert(e)

//   if(pathcount==(pathsort.length)){
//               foldsort.push("custom");
//               pathsort.push("./project/"+button);
//             }
//             else{
//               foldsort[pathcount]="custom";
//               pathsort[pathcount]="./project/"+button;
//               var a = pathcount+1;
// var b = pathsort.length;

// pathsort.splice(a, (b - a) + 1);
// foldsort.splice(a, (b - a) + 1);
//             }              
//     pathcount++;
//   pathtype="custom";
//   pathname="./project/"+button; 
//   var arflrc =[];
var obj={};
//     // if(localStorage.getItem("recent")){
      if(localStorage.getItem('savefileytaletemplate')){
    var obj = JSON.parse(localStorage["savefileytaletemplate"]);
      document.querySelectorAll(".btn").forEach(element => {
        // element.textContent = `RGBA: ${hexToRGBA(hexColor, alpha)}`;
        element.style.background = obj["bgcl1"];
});
document.querySelectorAll(".btn").forEach(element => {
        // element.textContent = `RGBA: ${hexToRGBA(hexColor, alpha)}`;
        element.style.borderColor = obj["bdcl1"];
});
  document.querySelectorAll(".divpar").forEach(element => {
        // element.textContent = `RGBA: ${hexToRGBA(hexColor, alpha)}`;
        element.style.background = obj["bgcl2"];
});
document.querySelectorAll(".divpar").forEach(element => {
        // element.textContent = `RGBA: ${hexToRGBA(hexColor, alpha)}`;
        element.style.borderColor = obj["bdcl2"];
});
document.getElementById("searcttxt").style.borderColor = obj["bdcl3"];
        document.getElementById("pathline").style.borderColor = obj["bdcl3"];
        document.getElementById("pgnm").style.borderColor = obj["bdcl3"];
        document.getElementById("searcttxt").style.color = obj["bdcl3"];
        document.getElementById("pathline").style.color = obj["bdcl3"];
        document.getElementById("pgnm").style.color = obj["bdcl3"];
document.querySelectorAll(".circlebtn").forEach(element => {
        // element.textContent = `RGBA: ${hexToRGBA(hexColor, alpha)}`;
          element.addEventListener('mouseout', () => {
  element.style.background = obj["bgcl3"];
});
        element.style.background = obj["bgcl3"];
});
document.querySelectorAll(".circlebtn").forEach(element => {
element.addEventListener('mouseover', () => {
  element.style.background = obj["bgcl6"];
});});
document.getElementById("bodcov").style.background=obj["bgcl4"];
document.querySelectorAll(".spr").forEach(element => {
    element.style.background = obj["bgcl5"];
});
document.querySelectorAll(".btn").forEach(element => {
    element.style.border = obj["bdsz1"]+"px solid";
});
document.querySelectorAll(".divpar").forEach(element => {
    element.style.border = obj["bdsz2"]+"px solid";
});
document.querySelectorAll(".circlebtn").forEach(element => {
    element.style.color = obj["fncl2"];
});
document.querySelectorAll(".btn").forEach(element => {
    element.style.color = obj["fncl1"];
});
document.querySelectorAll(".divpar").forEach(element => {
    element.style.color = obj["fncl4"];
});
      }

//   // var arc=[];
//  if(arflrc.length==7){
//   arflrc.pop();
//  }
//   arflrc.splice(0, 0, button);
//   let unique_ar = [];
//   arflrc.forEach((ar) => {
//     if (!unique_ar.includes(ar)) {
//       unique_ar.push(ar);
//     }
//   });
  
  
//   localStorage["recentfpl"] = JSON.stringify(unique_ar);

// }
//             }
//             if(fs.existsSync("./cache/arcache.json")){
//               loadcache();
              
//             }
//             if(fs.existsSync("./linux-apps.json")){
//               loadappdef();
              
//             }
            // alert("Received text: " + args[0]);
    //           function updateColor(item) {
    //     const color = colorPicker.value;
    //     const opacity = opacitySlider.value / 100;
    //     document.getElementById(item).style.backgroundColor = color;
    //     document.getElementById(item).style.opacity = opacity;
    // }
    var bgcl1,bgcl2,bgcl3,bgcl4,bgcl5,bgcl6,bdcl1,bdcl2,bdcl3,fncl1,fncl2,fncl4,bdsz1,bdsz2,bgimg,ticonimg;
  
     function hexToRGBA(hex, alpha) {
        let r = parseInt(hex.substring(1, 3), 16);
        let g = parseInt(hex.substring(3, 5), 16);
        let b = parseInt(hex.substring(5, 7), 16);
        return `rgba(${r}, ${g}, ${b}, ${alpha})`;
    }

    function updateColor() {
        const hexColor = document.getElementById("colorPicker1").value;
        const alpha = document.getElementById("opacitySlider1").value / 100;
      bgcl1=hexToRGBA(hexColor, alpha);;
      obj["bgcl1"]=bgcl1;
      localStorage["savefileytaletemplate"] = JSON.stringify(obj);
        document.querySelectorAll(".btn").forEach(element => {
        // element.textContent = `RGBA: ${hexToRGBA(hexColor, alpha)}`;
        element.style.background = hexToRGBA(hexColor, alpha);
});
    }
      function updateColora() {
        const hexColor = document.getElementById("colorPicker1a").value;
        const alpha = document.getElementById("opacitySlider1a").value / 100;
        bdcl1=hexToRGBA(hexColor, alpha);;
        obj["bdcl1"]=bdcl1;
        localStorage["savefileytaletemplate"] = JSON.stringify(obj);
        document.querySelectorAll(".btn").forEach(element => {
        // element.textContent = `RGBA: ${hexToRGBA(hexColor, alpha)}`;
        element.style.borderColor = hexToRGBA(hexColor, alpha);
});

    }
    function updateColor2() {
        const hexColor = document.getElementById("colorPicker2").value;
        const alpha = document.getElementById("opacitySlider2").value / 100;
        bgcl2=hexToRGBA(hexColor, alpha);;
        obj["bgcl2"]=bgcl2;
        localStorage["savefileytaletemplate"] = JSON.stringify(obj);
       document.querySelectorAll(".divpar").forEach(element => {
        // element.textContent = `RGBA: ${hexToRGBA(hexColor, alpha)}`;
        element.style.background = hexToRGBA(hexColor, alpha);
});
    }
      function updateColor2a() {
        const hexColor = document.getElementById("colorPicker2a").value;
        const alpha = document.getElementById("opacitySlider2a").value / 100;
        bdcl2=hexToRGBA(hexColor, alpha);;
        obj["bdcl2"]=bdcl2;
        localStorage["savefileytaletemplate"] = JSON.stringify(obj);
       document.querySelectorAll(".divpar").forEach(element => {
        // element.textContent = `RGBA: ${hexToRGBA(hexColor, alpha)}`;
        element.style.borderColor = hexToRGBA(hexColor, alpha);
});
    }
          function updateColor4() {
        const hexColor = document.getElementById("colorPicker4").value;
        const alpha = document.getElementById("opacitySlider4").value / 100;
bdcl3=hexToRGBA(hexColor, alpha);;
obj["bdcl3"]=bdcl3;
localStorage["savefileytaletemplate"] = JSON.stringify(obj);
        // element.textContent = `RGBA: ${hexToRGBA(hexColor, alpha)}`;
        document.getElementById("searcttxt").style.borderColor = hexToRGBA(hexColor, alpha);
        document.getElementById("pathline").style.borderColor = hexToRGBA(hexColor, alpha);
        document.getElementById("pgnm").style.borderColor = hexToRGBA(hexColor, alpha);
        document.getElementById("searcttxt").style.color = hexToRGBA(hexColor, alpha);
        document.getElementById("pathline").style.color = hexToRGBA(hexColor, alpha);
        document.getElementById("pgnm").style.color = hexToRGBA(hexColor, alpha);

    }
    function updateColor3() {
        const hexColor = document.getElementById("colorPicker3").value;
        const alpha = document.getElementById("opacitySlider3").value / 100;
        bgcl3=hexToRGBA(hexColor, alpha);;
        obj["bgcl3"]=bgcl3;
        localStorage["savefileytaletemplate"] = JSON.stringify(obj);
        document.querySelectorAll(".circlebtn").forEach(element => {
        // element.textContent = `RGBA: ${hexToRGBA(hexColor, alpha)}`;
          element.addEventListener('mouseout', () => {
  element.style.background = hexToRGBA(hexColor, alpha);
});
        element.style.background = hexToRGBA(hexColor, alpha);
});
    }
      function updateColor6() {
        const hexColor = document.getElementById("colorPicker6").value;
        const alpha = document.getElementById("opacitySlider6").value / 100;
        bgcl6=hexToRGBA(hexColor, alpha);;
        obj["bgcl6"]=bgcl6;
        localStorage["savefileytaletemplate"] = JSON.stringify(obj);
        document.querySelectorAll(".circlebtn").forEach(element => {
        // element.textContent = `RGBA: ${hexToRGBA(hexColor, alpha)}`;
        element.addEventListener('mouseover', () => {
  element.style.background = hexToRGBA(hexColor, alpha);
});
   
        
});
    }
    var objectURL, imgfl;
 document.getElementById("bbgc1").addEventListener('change', function () {
document.getElementById("bodcov").style.background=this.value;
bgcl4=this.value;
obj["bgcl4"]=bgcl4;
localStorage["savefileytaletemplate"] = JSON.stringify(obj);
 });
 async function createZipWithImages(imageFiles) {
  const fileData = await imageFiles.arrayBuffer();
  return fileData;
 }
 document.getElementById("bgimg").addEventListener('change', function (event) {
  
   const file = event.target.files[0];
   
        if (file) {
          var k=document.getElementById("bgimg").files[0].name;
          imgfl=k;
          bgcl4=`url('`+k+`')`;
          console.log(bgcl4)
            document.getElementById("bodcov").style.backgroundImage = `url(${URL.createObjectURL(file)})`;
            document.getElementById("bodcov").style.backgroundSize = "cover";
            document.getElementById("bodcov").style.backgroundPosition = "center";
              if (objectURL) {
    // revoke the old object url to avoid using more memory than needed
    URL.revokeObjectURL(objectURL);  
  }
  // const file = this.files[0];
  // objectURL = URL.createObjectURL(file);
  objectURL = createZipWithImages(file);
        }
 });
 document.getElementById("ticonimg").addEventListener('change', function (event) {
  
   const file = event.target.files[0];
   
        if (file) {
          var k=document.getElementById("ticonimg").files[0].name;
          imgfl=k;
          
            document.getElementById("examplicon").style.backgroundImage = `url(${URL.createObjectURL(file)})`;
            document.getElementById("examplicon").style.backgroundSize="45px 45px";
          document.getElementById("examplicon").style.backgroundRepeat="no-repeat";
          document.getElementById("examplicon").style.backgroundPosition="center 15px"
          document.getElementById("examplmc").remove();
          document.getElementById("test.desktopicon").style.backgroundImage = `url(${URL.createObjectURL(file)})`;
            document.getElementById("test.desktopicon").style.backgroundSize="35px 35px";
          document.getElementById("test.desktopicon").style.backgroundRepeat="no-repeat";
          document.getElementById("test.desktopicon").style.backgroundPosition="center 15px"
          document.getElementById("test.desktopmc").remove();
            
              if (objectURL) {
    // revoke the old object url to avoid using more memory than needed
    URL.revokeObjectURL(objectURL);  
  }
  // const file = this.files[0];
  // objectURL = URL.createObjectURL(file);
  objectURL = createZipWithImages(file);
        }
 });
 document.getElementById("bbgc2").addEventListener('change', function () {
bgcl5=this.value;
obj["bgcl5"]=bgcl5;
localStorage["savefileytaletemplate"] = JSON.stringify(obj);
document.querySelectorAll(".spr").forEach(element => {
    element.style.background = this.value;
});
 });
 document.getElementById("colorPicker1").addEventListener('input', function () {
updateColor();
 });
 document.getElementById("colorPicker2").addEventListener('input', function () {
updateColor2();
 });
 document.getElementById("colorPicker1a").addEventListener('input', function () {
updateColora();
 });
 document.getElementById("colorPicker2a").addEventListener('input', function () {
updateColor2a();
 });
 document.getElementById("colorPicker3").addEventListener('input', function () {
updateColor3();
 });
  document.getElementById("colorPicker4").addEventListener('input', function () {
updateColor4();
 });
  document.getElementById("opacitySlider6").addEventListener('input', function () {
updateColor6();
 });
  document.getElementById("colorPicker6").addEventListener('input', function () {
updateColor6();
 });
  document.getElementById("opacitySlider4").addEventListener('input', function () {
updateColor4();
 });
  document.getElementById("opacitySlider1").addEventListener('input', function () {
updateColor();
 });
 document.getElementById("opacitySlider2").addEventListener('input', function () {
updateColor2();
 });
  document.getElementById("opacitySlider1a").addEventListener('input', function () {
updateColora();
 });
 document.getElementById("opacitySlider2a").addEventListener('input', function () {
updateColor2a();
 });
 document.getElementById("opacitySlider3").addEventListener('input', function () {
updateColor3();
 });
 document.getElementById("bds1").addEventListener('change', function () {
  bdsz1=this.value;
  obj["bdsz1"]=bdsz1;
  localStorage["savefileytaletemplate"] = JSON.stringify(obj);
document.querySelectorAll(".btn").forEach(element => {
    element.style.border = this.value+"px solid";
});
 });
 document.getElementById("bds2").addEventListener('change', function () {
  bdsz2=this.value;
  obj["bdsz2"]=bdsz2;
  localStorage["savefileytaletemplate"] = JSON.stringify(obj);
document.querySelectorAll(".divpar").forEach(element => {
    element.style.border = this.value+"px solid";
});
 });
  document.getElementById("fcl2").addEventListener('change', function () {
    fncl2=this.value;
    obj["fncl2"]=fncl2;
    localStorage["savefileytaletemplate"] = JSON.stringify(obj);
document.querySelectorAll(".circlebtn").forEach(element => {
    element.style.color = this.value;
});
 });
  document.getElementById("fcl1").addEventListener('change', function () {
    fncl1=this.value;
    obj["fncl1"]=fncl1;
    localStorage["savefileytaletemplate"] = JSON.stringify(obj);
document.querySelectorAll(".btn").forEach(element => {
    element.style.color = this.value;
});
 });
  document.getElementById("fcl4").addEventListener('change', function () {
    fncl4=this.value;
    obj["fncl4"]=fncl4;
    localStorage["savefileytaletemplate"] = JSON.stringify(obj);
    
document.querySelectorAll(".divpar").forEach(element => {
    element.style.color = this.value;
});
 });
 const zip = new JSZip();

// Add files to the zip


// Generate the zip and trigger download

function savecss(){
  var cstxt=`.divpar{
  display: block;
  overflow: hidden;
  background: `+bgcl2+` !important;

border-radius: 10px;
border: `+bdsz2+`px  solid !important;
border-color:`+bdcl2+`!important;
color:`+fncl4+` !important;
}
.spr{
  background: `+bgcl5+`!important;
  height: 1px;
  width: 100%;
}
  .classfile2{
  color:`+fncl4+` !important;
  }
  .classfile{
  color:`+fncl4+` !important;
  }
  #bodyall{
  background: `+bgcl4+` !important;
  background-size: cover !important;
  background-position: center !important;
  background-repeat: no-repeat !important;
  }
 body{
              height: 100%;
              width: 100%;
              margin: 0;
              
              overflow: auto;
              
          }
          .btn{
  
  
  border-radius: 20px;


           font-size: large;
           color: `+fncl1+` !important;
           overflow: hidden;
           border: `+bdsz1+`px solid;
           border-color:`+bdcl1+` !important;
  background: `+bgcl1+` !important;
  box-shadow: none !important;
}
.circlebtn{
  border-radius: 50px;
border-style: none;
height: 30px;
width: 30px;
font-size: medium;
font-weight: bold;
margin-left: 5px;
text-align: center;
color: `+fncl2+` !important ;
cursor: pointer;
border-radius: 50%;
  background: `+bgcl3+` !important;
  box-shadow: none !important;
  padding-left:5px !important;
}
.circlebtn:hover{
  border-radius: 50%;
background: `+bgcl6+` !important;
box-shadow: none !important;
}
#searcttxt{
   backdrop-filter: none!important;
-webkit-backdrop-filter:none!important; 
padding-left: 0px!important;
border-color:`+bdcl3+` !important;
}
#pgnm{
   backdrop-filter: none!important;
-webkit-backdrop-filter:none!important; 
padding-left: 0px!important;
border-color:`+bdcl3+` !important;
color:`+bdcl3+` !important;
}
#pathline{
   backdrop-filter: none!important;
   border-color:`+bdcl3+` !important;
-webkit-backdrop-filter:none!important; 
padding-left: 0px!important;
color:`+bdcl3+` !important;
}`

zip.file("style.css", cstxt);
if(imgfl!="" &&imgfl){
zip.file(imgfl, objectURL);
}
zip.generateAsync({ type: "blob" }).then((content) => {
  const link = document.createElement("a");
  link.href = URL.createObjectURL(content);
  link.download = "fileytaletemplate.zip";
  link.click();
  console.log("Zip file downloaded successfully!");
});
  console.log(cstxt);
}

            addlnk.addEventListener('click', function () {
             
              flpath = lnk.value;
                editclass=false;
        sessionStorage.setItem('flpath',flpath);
        document.getElementById("newitemin").style.display="none";
        document.getElementById("editupl").style.display="block";
        additm.style.display="block";
        flnm.value=flpath;
        itemtype="web";
            });
            
            addclass.addEventListener('click', function () {
               if(localStorage.getItem('active')){
                editclass=false;
        sessionStorage.setItem('flpath',flpath);
        document.getElementById("newitemin").style.display="none";
        document.getElementById("editupl").style.display="block";
        additm.style.display="block";
        flnm.value="Class";
        slclass.disabled=true;
        flkey.disabled=true;
        slsty.disabled=true;
        document.getElementById("opbgc").checked=true;
        document.getElementById("flkey").disabled=true;
        clss=true;
}else{
              var classarfile=classfile.filter((e) => e.page == curpage);
              var clf=classarfile.length;
              if(clf<2){
              editclass=false;
        sessionStorage.setItem('flpath',flpath);
        document.getElementById("newitemin").style.display="none";
        document.getElementById("editupl").style.display="block";
        additm.style.display="block";
        flnm.value="Class";
        slclass.disabled=true;
        flkey.disabled=true;
        slsty.disabled=true;
        document.getElementById("opbgc").checked=true;
        document.getElementById("flkey").disabled=true;
        clss=true;
      }
              else{
alert("Use the premium version")
    }
          }  });
            document.getElementById("addnm").addEventListener('click', function (event)  { 
              if(localStorage.getItem('active')){
                pagenamelst[curpage-1]=document.getElementById('newpgnm').value;
    mainplace.innerHTML="";
            classmap.innerHTML="";
  
  dissap();
  savefile();
  startapp();
              }else{
              if(curpage<3){
              pagenamelst[curpage-1]=document.getElementById('newpgnm').value;
    mainplace.innerHTML="";
            classmap.innerHTML="";
  
  dissap();
  savefile();
  startapp();
}
else{
  alert("Use the premium version")
  dissap();
  
  startapp();
}
}
});
            async function f(testFolder) {
  const fsPromises = require('fs').promises;
  const data = await fsPromises.readFile(testFolder)
                     

  return JSON.parse(data.toString());
}
async function ft(testFolder) {
  const fsPromises = require('fs').promises;
  const data = await fsPromises.readFile(testFolder)
                     

  return data.toString();
}
async function fnu(testFolder) {
  const fsPromises = require('fs').promises;
  const data = await fsPromises.readdir(testFolder)
                     
                     
                    //  formData.append('folderar',JSON.stringify(data));
                     
                     return JSON.stringify(data);
}
            function dropbtn() {
              var hmhd =document.getElementsByClassName("hmhd");
              if(pathname=="Home"){
                document.getElementById("loading").style.display="flex";
addproject.style.display="block";
        // document.getElementById("newitemin").style.display="none";
        // document.getElementById("editupl").style.display="block";
        // additm.style.display="block";
        for(var i=0;i<hmhd.length;i++){
        hmhd[i].style.display="none";
      }
       
        itemtype="project";
              }else{

  document.getElementById("loading").style.display="flex";
  if(claspage==true){
                var classfile2=classfile.filter((e) => e.page == curpage);
                if(classfile2.length==0){
                  addlnk.disabled=true;
                  document.getElementById('filedrop').disabled=true;
                  document.getElementById('filedropfolder').disabled=true;
                }
              }
  for(var i=0;i<hmhd.length;i++){
    hmhd[i].style.display="block";
      }
      if(itmpg==true){
        addclass.style.display="none";
      }
  addproject.style.display="none";
}
}
async function loaddata(){
      var urls;
      if(pathtype=="home"){
urls="./main/arfile.json";
fs.rename(
    './main/note.txt',
    './main/fileytalenote.txt',
    () => {
      
        
    });
await f(urls) .then((d) => {
        fildet=d;
      arfile=fildet["file"];
      pagesort=fildet["pagesort"];      
      pagetype=pagesort[0];
      pagenamelst=[];
      if(fildet["pagename"]){
        pagenamelst=fildet["pagename"];
      }
      else{
        for(var i=0;i<pagesort.length;i++){
          pagenamelst.push((i+1).toString());
        }
      }
      
     } )
        .catch((err) =>{ arfile=[];
          pagenamelst=["1"];
          pagesort=["normal"]
          //alert(err)
        });
        await ft("./main/fileytalenote.txt") .then((d) => txtar.value=d)
        .catch((err) => txtar.value="");
      }
      else{
        urls=pathname+"/arfile.json";
        if(pathname.includes("project")){
          fs.rename(
            pathname+'/note.txt',
            pathname+'/fileytalenote.txt',
    () => {
       
    });
        }
        await f(pathname+"/classarfile.json") .then((d) => classfile=d)
        .catch((err) => classfile=[]);
        await f(urls) .then((d) => {
        fildet=d;
      arfile=fildet["file"];
      pagesort=fildet["pagesort"];pagetype=pagesort[0];
      pagenamelst=[];
      if(fildet["pagename"]){
        pagenamelst=fildet["pagename"];
      }
      else{
        for(var i=0;i<pagesort.length;i++){
          pagenamelst.push((i+1).toString());
        }
      } } )
        .catch((err) => {arfile=[];pagesort=["normal"];pagenamelst=["1"];});  
        await ft(pathname+"/fileytalenote.txt") .then((d) => txtar.value=d)
        .catch((err) => txtar.value="");
      }
      
       
        
        
    }  
    
function addpage() {
  if(localStorage.getItem('active')){
    pagetype="" ;
  mainplace.innerHTML="";
            classmap.innerHTML="";
            pagetype="normal" ;
  curpage++;
  pagesort.push('normal');
  pagenamelst.push(pagesort.length.toString());
  // totalpage++;
  startapp();
  savefile();
  document.getElementById("setdrop").className = "hide";
  }else{
  if(pathtype=="home"){
    if(pagesort.length<2){
  pagetype="" ;
  mainplace.innerHTML="";
            classmap.innerHTML="";
            pagetype="normal" ;
  curpage++;
  pagesort.push('normal');
  pagenamelst.push(pagesort.length.toString());
  // totalpage++;
  startapp();
  savefile();
  document.getElementById("setdrop").className = "hide";
}
    else{
alert("Use the premium version")
    }
  }
  else{
    pagetype="" ;
  mainplace.innerHTML="";
            classmap.innerHTML="";
            pagetype="normal" ;
  curpage++;
  pagesort.push('normal');
  pagenamelst.push(pagesort.length.toString());
  // totalpage++;
  startapp();
  savefile();
  document.getElementById("setdrop").className = "hide";
  }
}
}

function addpagecls() {
  if(localStorage.getItem('active')){
    mainplace.innerHTML="";
            classmap.innerHTML="";
 pagetype="class" ;
  curpage++;
  pagesort.push('class');
  pagenamelst.push(pagesort.length.toString());
  // totalpage++;
  startapp();
  savefile();
  
  document.getElementById("setdrop").className = "hide";
  }else{

  
  var pgs2=pagesort.filter(pg => pg =="class");
  if(pgs2.length<1){
  mainplace.innerHTML="";
            classmap.innerHTML="";
 pagetype="class" ;
  curpage++;
  pagesort.push('class');
  pagenamelst.push(pagesort.length.toString());
  // totalpage++;
  startapp();
  savefile();
  
  document.getElementById("setdrop").className = "hide";
}
  else{
alert("Use the premium version")
    }
  }
}
function addpageitem() {
  if(localStorage.getItem('active')){
    mainplace.innerHTML="";
            classmap.innerHTML="";
 pagetype="item" ;
  curpage++;
  pagesort.push('item');
  pagenamelst.push(pagesort.length.toString());
  // totalpage++;
  startapp();
  savefile();
  document.getElementById("setdrop").className = "hide";
  }else{
  var pgs2=pagesort.filter(pg => pg =="item");
  if(pgs2.length<1){
  mainplace.innerHTML="";
            classmap.innerHTML="";
 pagetype="item" ;
  curpage++;
  pagesort.push('item');
  pagenamelst.push(pagesort.length.toString());
  // totalpage++;
  startapp();
  savefile();
  document.getElementById("setdrop").className = "hide";
}
  else{
alert("Use the premium version");
    }
  }
}
function savecache(){
  var obj={}
  obj["mime"]=extlas;
  obj["mimeicon"]=exten;
  if(fs.existsSync("./cache/")){
  fs.writeFileSync( "./cache/arcache.json", JSON.stringify(obj)); 
}
else{
  fs.mkdirSync("./cache/");
  fs.writeFileSync( "./cache/arcache.json", JSON.stringify(obj)); 
}
}
function loadappdef(){
  
  if(fs.existsSync("./linux-apps.json")){
    fs.readFile( "./linux-apps.json", (err, data)=> {
      var d=JSON.parse(data);
      var ul =document.createElement("ul");
    d.forEach(element => {
      // extlas=element["name"];
      var li =document.createElement("li");
      
      li.innerHTML=element["name"];
      li.id=element["exec"]
      li.addEventListener('click', function (e) { 
        var button = e.target.id;
        // alert(button)

      });
      // exten=d["mimeicon"];   
      ul.appendChild(li);
      });
      document.getElementById("listopw").appendChild(ul);
      // alert(JSON.stringify(d) +"  kd")
    
    });
}
else{
  fs.mkdirSync("./cache/");
  fs.writeFileSync( "./cache/arcache.json", JSON.stringify(obj)); 
}
}
function loadcache(){
  var obj={}
  obj["mime"]=extlas;
  obj["mimeicon"]=exten;
  if(fs.existsSync("./cache/arcache.json")){
    fs.readFile( "./cache/arcache.json", (err, data)=> {
      var d=JSON.parse(data);
      extlas=d["mime"];
      exten=d["mimeicon"];
    alert(JSON.stringify(Object.Keys(exten)) +"  kd")
    });
}
else{
  fs.mkdirSync("./cache/");
  fs.writeFileSync( "./cache/arcache.json", JSON.stringify(obj)); 
}
}
function savefile(){

var folderpath=pathname;
if(folderpath=="Home"){
  var objsav={};
objsav["file"]=arfile;
objsav["pagesort"]=pagesort;
objsav["pagename"]=pagenamelst;
if(fs.existsSync("./main/")){
  fs.writeFileSync( "./main/arfile.json", JSON.stringify(objsav)); 
}
else{
  fs.mkdirSync("./main/");
  fs.writeFileSync( "./main/arfile.json", JSON.stringify(objsav)); 
}


}else{
  if(!fs.existsSync("./project/")){
    fs.mkdirSync("./project/");
  }
if(fs.existsSync(folderpath)){


  var objsav={};
objsav["file"]=arfile;
objsav["pagesort"]=pagesort;
objsav["pagename"]=pagenamelst;
fs.writeFileSync( folderpath+"/arfile.json", JSON.stringify(objsav)); 

  fs.writeFileSync( folderpath+"/classarfile.json", JSON.stringify(classfile)); 
}else{
  
    fs.mkdirSync(folderpath);
    var objsav={};
objsav["file"]=arfile;
objsav["pagesort"]=pagesort;
objsav["pagename"]=pagenamelst;
    fs.writeFileSync( folderpath+"/arfile.json", JSON.stringify(objsav)); 
  fs.writeFileSync( folderpath+"/classarfile.json", JSON.stringify(classfile)); 
  
}
//alert(JSON.stringify(objsav))
}
}
function backpath(){
  //alert(pathcount)
  if(pathcount>1){
    mainplace.innerHTML="";
            classmap.innerHTML="";
            arfile=[];
              classfile=[];
            curpage=1;
    pathcount--;
  pathtype=foldsort[pathcount-1];
  pathname=pathsort[pathcount-1];   
  
//   arfile=fildet["file"];
// pagesort=fildet["pagesort"]; 

  startapp();
  // lastpath=pathname;
}
}
function homepath(){
  //alert(pathcount)
  
  if(pathcount==(pathsort.length)){
              foldsort.push("home");
              pathsort.push("home");
            }
            else{
              foldsort[pathcount]="home";
              pathsort[pathcount]="home";
              var a = pathcount+1;
var b = pathsort.length;

pathsort.splice(a, (b - a) + 1);
foldsort.splice(a, (b - a) + 1);
            }
            pathcount++;
              pathtype ="home";
              pathname ="home";
              curpage=1;
                startapp();
  

}
function forwardpath(){
  
  if(pathcount<pathsort.length){
    
    mainplace.innerHTML="";
            classmap.innerHTML="";
            curpage=1;
            arfile=[];
              classfile=[];
    pathcount++;
  pathtype=foldsort[pathcount-1];
  pathname=pathsort[pathcount-1]; 
  
  
  startapp();
  // lastpath=pathname;
}
}

document.getElementById("nextbtn").addEventListener('click', function (event)  { 
  if(curpage<pagesort.length){
    mainplace.innerHTML="";
            classmap.innerHTML="";
  curpage++;
  pagetype=pagesort[curpage-1] ;
  startapp();
  }
  
});
document.getElementById("prevbtn").addEventListener('click', function (event)  { 
  if(curpage>1){
    mainplace.innerHTML="";
            classmap.innerHTML="";
curpage--;
pagetype=pagesort[curpage-1] ;
startapp();
}
});
preview.addEventListener('change', function (event)  { 
startapp();
});
document.getElementById("pgtp").addEventListener('click', function (event)  { 
  document.getElementById("pgmenu").classList.toggle("show");
  document.getElementById("pgmenu").style.top = mouseY(event)-120 + 'px';
  document.getElementById("pgmenu").style.left = mouseX(event)-100 + 'px';
  var ul=document.createElement('ul');
  pglst.innerHTML="";
  for(var i=0;i<pagenamelst.length;i++){
    var li=document.createElement('li');
    li.innerHTML=pagenamelst[i];
    li.className="pagenmlst";
    if(localStorage.getItem('active')){
      li.addEventListener('click', function (e) { 
      var button = e.target.innerHTML;
      
      curpage=pagenamelst.indexOf(button)+1;
      pagetype=pagesort[curpage-1] ;
      
      startapp();
      
    });
    }else{
    if(i<3){
    li.addEventListener('click', function (e) { 
      var button = e.target.innerHTML;
      
      curpage=pagenamelst.indexOf(button)+1;
      pagetype=pagesort[curpage-1] ;
      
      startapp();
      
    });
  }
  else{
    li.addEventListener('click', function (e) { 
      var button = e.target.innerHTML;
      alert("Use the premium version");
      
    });
  }
}
    ul.appendChild(li);
  }
  pglst.appendChild(ul);
  
});
keywrd.addEventListener('click', function() {
  if(pathname=="Home"){
    keywrd.checked=false
  }
});
keywrd.addEventListener('change', function() {
if(keywrd.checked==false){
startapp();
}
});
document.getElementById("flkey").addEventListener('keyup', function() {
  if(!localStorage.getItem('active')){
  if(this.value.split(",").length>2){
  alert("Use the premium version");
  this.value = this.value.slice(0, -1);
}
  }
});
function dissap(){
    
    document.getElementById("loading").style.display="none";
    document.getElementById("newitemin").style.display="block";
    document.getElementById("newpage").style.display="none";
        document.getElementById("editupl").style.display="none";
        document.getElementById("lload").style.display="none";
        additm.style.display="none";
        savenewfile.style.display="none";
        slclass.disabled=false;
        flkey.disabled=false;
        slsty.disabled=false;
        fold=false;
        clss=false;
        editim=false;
        keywrd.checked=false;
        slclass.value="none";
        trpc.checked=true;
        editclass=false;  
        icontxt.value="";
        imgicon.src=""
        document.getElementById("flkey").disabled=false;
        document.getElementById('flnm').value="";
        document.getElementById('newpgnm').value="";
        document.getElementById('flkey').value="";
        document.getElementById('filedrop').value="";
        document.getElementById('lnk').value="";
        document.getElementById('filedropfolder').value="";
        document.getElementById('flbg').value="black";
        document.getElementById('opbgc').checked=true;
        addlnk.disabled=false;
                  document.getElementById('filedrop').disabled=false;
                  document.getElementById('filedropfolder').disabled=false;
}
document.addEventListener('keydown', e => {
  if (e.ctrlKey && e.key === 'ArrowRight') {
    // Prevent the Save dialog to open
    e.preventDefault();
    // Place your code here
    if(curpage<pagesort.length){
    mainplace.innerHTML="";
            classmap.innerHTML="";
  curpage++;
  pagetype=pagesort[curpage-1] ;
  startapp();
  }
  }
  if (e.ctrlKey && e.key === 'ArrowLeft') {
    // Prevent the Save dialog to open
    e.preventDefault();
    // Place your code here
    if(curpage>1){
    mainplace.innerHTML="";
            classmap.innerHTML="";
curpage--;
pagetype=pagesort[curpage-1] ;
startapp();
}
    
  }
 if (document.getElementById('lnk')===document.activeElement||document.getElementById('flnm') === document.activeElement||document.getElementById('flkey') === document.activeElement||document.getElementById('searcttxt')===document.activeElement||document.getElementById('txtar')===document.activeElement||document.getElementById('searchpg')===document.activeElement||document.getElementById('pathline')===document.activeElement||document.getElementById('dname')===document.activeElement||document.getElementById('pgnm')===document.activeElement||document.getElementById('newpgnm')===document.activeElement) {
  }else{
  if (e.ctrlKey && e.key === 'x') {
    // Prevent the Save dialog to open
    e.preventDefault();
    // Place your code here
 cutitm();

    
  }
  if (e.ctrlKey && e.key === 'c') {
    // Prevent the Save dialog to open
    e.preventDefault();
    // Place your code here
 copyitm();

    
  }
  if (e.ctrlKey && e.key === 'v') {
    // Prevent the Save dialog to open
    e.preventDefault();
    // Place your code here
    if(claspage==false){
 pasteitm();
    }
    
  }
  if (e.ctrlKey && e.key === 'Delete') {
    // Prevent the Save dialog to open
    e.preventDefault();
    // Place your code here
    if(pathclick){
//       event=eventrgt;
// let obj = arfile.find(x => x.filepath === pathclick);
// let index = arfile.indexOf(event.target.name);
// document.getElementById(pathclick).remove();
// // mainplace.children[arfile[index]['ids']].removeChild(mainplace.children[arfile[index]['ids']])
// if (index > -1) { // only splice array when item is found
//   arfile.splice(index, 1); // 2nd parameter means remove one item only
// }
dltitm();
// alert(JSON.stringify(arfile))


//fs.writeFileSync( folderpath+"/arfile.json", JSON.stringify(arfile)); 
}


  }
}
});

addproject.addEventListener("click", function(evt) {
  document.getElementById("newitemin").style.display="none";
        document.getElementById("editupl").style.display="block";
        document.getElementById("flkey").disabled=true;
        additm.style.display="block";
        itemtype="project";
        editclass=false;
        slclass.disabled=true;
});
document.getElementById('geticon').addEventListener("change", function(evt) {
        // When we reach this point, it means the user has selected a file,
        // so invoke readKeys().
        // this.value contains the path to the selected file
        // var fpath=this.value;
        // editclass=false;
        // var fpname=fpath.split('/').pop().split('/').pop();
        try{
        imgicon.src="file:///"+evt.target.files[0].path.replaceAll('/', '/')
      }catch(e){alert(e)}
        icontxt.value = evt.target.files[0].path;
      });
document.getElementById('filedrop').addEventListener("change", function(evt) {
        // When we reach this point, it means the user has selected a file,
        // so invoke readKeys().
        // this.value contains the path to the selected file
        var fpath=this.value;
        editclass=false;
        var fpname=fpath.split('/').pop().split('/').pop();
        flpath = evt.target.files[0].path;
        sessionStorage.setItem('flpath',flpath);
        document.getElementById("newitemin").style.display="none";
        document.getElementById("editupl").style.display="block";
        additm.style.display="block";
        // alert(tmppath)
        flnm.value=flpath.split('/').pop();
        itemtype="file";
    //     filear.push(fpname);
    //     var ddid=sessionStorage.getItem('elsel');
    // document.getElementById(ddid).style.borderImage="url('./pinimg/"+fpname+"')";
      
    }, false);
    function getFileDirectory(filePath) {
  if (filePath.indexOf("/") == -1) { // windows
    return filePath.split('\\').pop();
  } 
  else { // unix
    return filePath.split('/').pop();
  }
}

    document.getElementById('filedropfolder').addEventListener("change", function(evt) {
        // When we reach this point, it means the user has selected a file,
        // so invoke readKeys().
        // this.value contains the path to the selected file
        var fpath=this.value;
        editclass=false;
        var fpname=fpath.split('/').pop().split('/').pop();
        flpath = evt.target.files[0].path.match(/(.*)[\//]/)[1]||'';
        
        sessionStorage.setItem('flpath',flpath);
        document.getElementById("newitemin").style.display="none";
        document.getElementById("editupl").style.display="block";
        // alert(tmppath)
        additm.style.display="block";
        flnm.value=getFileDirectory(flpath);
        fold=true;
        itemtype="folder";
    //     filear.push(fpname);
    //     var ddid=sessionStorage.getItem('elsel');
    // document.getElementById(ddid).style.borderImage="url('./pinimg/"+fpname+"')";
      
    }, false);
    
    additm.addEventListener('click', function () {
            var obj ={};
            var coe;
            var sts;
            var fpath=sessionStorage.getItem('flpath');
            
              // alert(mainplace.children[co].childNodes.length);
              if(clss==false){
                var co=0;
               if(claspage==false){
                if(editim==false){
                  try{
              while(mainplace.children[co].childElementCount > 0 ){
                
                co++;  
     
              }
            }catch(e){
              alert('Page is Full');
              sts="Page is Full";
            }
              obj['ids']=co;
              
               }
              
              
            }
            
            obj['filename']=flnm.value ;
            if(itemtype !="project"){
            obj['filepath']=fpath;
            obj['keywords']=flkey.value;
            obj['type']=itemtype;}
            if(trpc.checked==true){
              obj['background']="transparent";
            }else if(document.getElementById("opbsv").checked==true){
              obj['background']=slcol.value;
              
          }else if(document.getElementById("opbgc").checked==true){
            obj['background']=flbg.value;
          }
          obj['style']=slsty.value;
          obj['icon']=icontxt.value ;
            // obj['icon']=;
            
            
            
            // var clist=document.getElementsById('classinp');
            obj['class']="";
if(slclass.options.length>0){
  
if(slclass.value!="none"){
  obj['class']=slclass.value;
  var classarfile=classfile.filter((e) => e.page == curpage);
  let decr = classarfile.find(x => x.classname === slclass.value);
  obj['ids']=decr['fil'];
  decr['fil']=~~decr['fil']+1;
  // decr['list'].push(~~indx);
  
}
else{
  obj['class']=""; 
  if(claspage==true){
  obj['class']=classarfile[0]["classname"];  
  
 let decr = classarfile.find(x => x.classname === obj['class']);
   obj['ids']=decr['fil'];
  decr['fil']=~~decr['fil']+1;
  }
}
}



            

            obj['page']=curpage;
            
            // obj['box']=;
            
            if(editim==true){
              // alert(JSON.stringify(arfile))
              let objs = arfile.find(x => x.filepath === eventrgt.target.id);
        let index = arfile.indexOf(eventrgt.target.name);
        mainplace.children[~~arfile[index]['ids']].innerHTML="";
        obj['ids']=~~arfile[index]['ids'];
        if(arfile[index]['filepath']){
        obj['filepath']=arfile[index]['filepath'];
      }else{
        delete obj['filepath'];
      }
      if(pathname!="Home"){
        obj['keywords']=flkey.value;
      }
        obj['class']=arfile[index]['class'];
            obj['type']=arfile[index]['type'];
        coe=~~arfile[index]['ids'];
              arfile[index]=obj;
              if(pathname=="Home"){
                fs.rename("./project/"+hmfl, "./project/"+flnm.value, function(err) {
  if (err) {
    
  } else {
    var arflrc =[];
if(localStorage.getItem('recentfpl')){
   arflrc = JSON.parse(localStorage["recentfpl"]);
      }
      let index2 = arflrc.indexOf(hmfl);
// mainplace.children[arfile[index]['ids']].removeChild(mainplace.children[arfile[index]['ids']])

if (index2 > -1) { // only splice array when item is found
  arflrc.splice(index2, 1); // 2nd parameter means remove one item only
}
let unique_ar = [];
  arflrc.forEach((ar) => {
    if (!unique_ar.includes(ar)) {
      unique_ar.push(ar);
    }
  });
localStorage["recentfpl"] = JSON.stringify(unique_ar);
startapp();                    
                savefile();
  }
})
           
startapp();                    
                savefile();
              }else{
              startapp();                    
              savefile();}
              // alert(~~arfile[index]['ids']);
            }else{ 
                                   

     
            
  if(slclass.value!="none"){
    arfile.push(obj);
                    startapp();                    
                    savefile();
  }else{
    
 
    if(sts!="Page is Full"){
                  
                    arfile.push(obj);
                    startapp();                    
                    savefile();
                    
                  
        
    } 
            }
          }
//          



            
            //fs.writeFileSync( folderpath+"/arfile.json", JSON.stringify(arfile)); 
          }
          else{
            var co=0;
            if(classfile){
            var pgsm=classfile.filter((e) => e.page == curpage);
            if(pgsm){
            co=pgsm.length;}else{co=0;}
          }
          if(claspage==true){
            if(editclass==true){
              obj['classname']=flnm.value ;
            obj['list']=[];
            if(trpc.checked==true){
              obj['background']="transparent";
            }else if(document.getElementById("opbsv").checked==true){
              obj['background']=slcol.value;
              
          }else if(document.getElementById("opbgc").checked==true){
            obj['background']=flbg.value;
          }
            // obj['icon']=;
            obj['keywords']=flkey.value;
            obj['fil']=0;
            obj['ids']=co;
            
            
            obj['page']=curpage;
              // alert(JSON.stringify(arfile))
              let objs = arfile.find(x => x.filepath === eventrgt.target.id);
        let index = eventrgt.target.name;
        var clname=classfile[index]['classname'];
        var classfile2=classfile.filter((e) => e.page == curpage);
        var classfile3=classfile2.filter((e) => e.classname == clname);
        if(classfile3.length==1){
        var arfile2=arfile.filter((e) => e.page == curpage);
        var arfile3=arfile2.filter((e) => e.class == clname);
              for(var p=0;p<arfile3.length;p++){
                var aritm=arfile3[p];
                aritm["class"]=flnm.value;              
                let indexarit = arfile.indexOf(arfile3[p]); 
                if (indexarit !== -1) {
                    arfile[indexarit] = aritm;
                  }
              }
            }
        obj['ids']=~~classfile[index]['ids'];            
        coe=~~classfile[index]['ids'];
              classfile[index]=obj;
              
              // classfile.push(obj);
            mainplace.innerHTML="";
            classmap.innerHTML="";
            
            startapp();
            savefile();
              // alert(~~arfile[index]['ids']);
            }
            else{
          if(co==10){
            if(clss==true){
alert('Page Is Full');
}
}
else{
  


            obj['classname']=flnm.value ;
            obj['list']=[];
            if(trpc.checked==true){
              obj['background']="transparent";
            }else if(document.getElementById("opbsv").checked==true){
              obj['background']=slcol.value;
              
          }else if(document.getElementById("opbgc").checked==true){
            obj['background']=flbg.value;
          }
            // obj['icon']=;
            obj['keywords']=flkey.value;
            obj['fil']=0;
            obj['ids']=co;
            
            
            obj['page']=curpage;
            // obj['box']=;

            classfile.push(obj);
            mainplace.innerHTML="";
            classmap.innerHTML="";
            
            startapp();
            savefile();
   
            //fs.writeFileSync( folderpath+"/classarfile.json", JSON.stringify(classfile)); 
}
          }
}else{


  obj['classname']=flnm.value ;
            obj['list']=[];
            if(trpc.checked==true){
              obj['background']="transparent";
            }else if(document.getElementById("opbsv").checked==true){
              obj['background']=slcol.value;
              
          }else if(document.getElementById("opbgc").checked==true){
            obj['background']=flbg.value;
          }
            // obj['icon']=;
            obj['keywords']=flkey.value;
            obj['fil']=0;
            obj['ids']=co;
            
            
            obj['page']=curpage;
            // obj['box']=;
            
            if(editclass==true){
              // alert(JSON.stringify(arfile))
              let objs = arfile.find(x => x.filepath === eventrgt.target.id);
        let index = eventrgt.target.name;
        var clname=classfile[index]['classname'];
        var classfile2=classfile.filter((e) => e.page == curpage);
        var classfile3=classfile2.filter((e) => e.classname == clname);
        if(classfile3.length==1){
        var arfile2=arfile.filter((e) => e.page == curpage);
        var arfile3=arfile2.filter((e) => e.class == clname);
              for(var p=0;p<arfile3.length;p++){
                var aritm=arfile3[p];
                aritm["class"]=flnm.value;              
                let indexarit = arfile.indexOf(arfile3[p]); 
                if (indexarit !== -1) {
                    arfile[indexarit] = aritm;
                  }
              }
            }
        obj['ids']=~~classfile[index]['ids'];            
        coe=~~classfile[index]['ids'];
              classfile[index]=obj;
              
              // classfile.push(obj);
            mainplace.innerHTML="";
            classmap.innerHTML="";
            
            startapp();
            savefile();
              // alert(~~arfile[index]['ids']);
            }
            else{
              
            classfile.push(obj);
            mainplace.innerHTML="";
            classmap.innerHTML="";
            
            startapp();
            savefile();
          }
}
          }
            // alert(JSON.stringify(arfile))
            // post++;
            dissap();
            fold=false;
            clss=false;
editim=false;
// claspage=false;
editclass=false;

            });
            
            document.body.oncontextmenu= function(event){
   e=window.event? event.srcElement: event.target;
   editclass=false;
   if(e.className && e.className.indexOf('divfile')!=-1 ||e.className && e.className.indexOf('imgicon')!=-1 ||e.className && e.className.indexOf('txtfile')!=-1||e.className && e.className.indexOf('iconimg')!=-1||e.className && e.className.indexOf('dvtp')!=-1 ||e.className && e.className.indexOf('dvtb')!=-1||e.className && e.className.indexOf('lbltb')!=-1||e.className && e.className.indexOf('dvncov')!=-1 ){
    eventrgt=event;
    var mnu =document.getElementsByClassName("mnu");
    var clsp =document.getElementsByClassName("clsp");
    if(pathtype=="home"){
      for(var i=0;i<clsp.length;i++){
        clsp[i].hidden=false;
        clsp[i].style.display="block";
      }
      for(var i=0;i<mnu.length;i++){
        mnu[i].hidden=true;
        mnu[i].style.display="none";
      }
    }
    else{
      for(var i=0;i<mnu.length;i++){
        mnu[i].hidden=false;
        mnu[i].style.display="block";
      }
      for(var i=0;i<clsp.length;i++){
        clsp[i].hidden=false;
        clsp[i].style.display="block";
      }
    }
    var mx=mouseX(event);
    var my=mouseY(event);
    if ((my+250)>innerHeight) {
      
      my = my-255;
      
}
if ((mx+190)>innerWidth) {
  
      mx = mx-200;
      
}

    document.getElementById("rmenu").className = "show";
    
      document.getElementById("rmenu").style.top =my+"px";
      document.getElementById("rmenu").style.left = mx+"px";
      document.getElementById("dltt").style.display = "none";
      editclass=false;
   }
   if(e.id =="mainplace"||e.className && e.className.indexOf('divpar')!=-1){
    eventrgt=event;
    // if(formData.get("text")){
     var mx=mouseX(event);
    var my=mouseY(event);
    if ((my+70)>innerHeight) {
      
      my = my-79;
      
}
if ((mx+70)>innerWidth) {
  
      mx = mx-79;
      
}
    document.getElementById("rpmenu").className = "show";
      document.getElementById("rpmenu").style.top = my+ 'px';
      document.getElementById("rpmenu").style.left = mx + 'px';
      editclass=false;
    // }
   }
   if(e.className && e.className.indexOf('classfile')!=-1 ||e.className && e.className.indexOf('classfile2')!=-1  ){
    eventrgt=event;
    // if(formData.get("text")){
     var mx=mouseX(event);
    var my=mouseY(event);
    if ((my+70)>innerHeight) {
      
      my = my-79;
      
}
if ((mx+70)>innerWidth) {
  
      mx = mx-79;
      
}
    document.getElementById("rpmenu2").className = "show";
      document.getElementById("rpmenu2").style.top = my+ 'px';
      document.getElementById("rpmenu2").style.left = mx + 'px';
      editclass=false;
    // }
   }
   if(e.className && e.className.indexOf('collapsible')!=-1  ){
    eventrgt=event;
    // if(formData.get("text")){
      var clsp =document.getElementsByClassName("clsp");
    // if(pathtype=="home"){
      var mnu =document.getElementsByClassName("mnu");
      var cols =document.getElementsByClassName("cols");
     
      for(var i=0;i<clsp.length;i++){
        clsp[i].hidden=true;
        clsp[i].style.display="none";
      }
      for(var i=0;i<mnu.length;i++){
        mnu[i].hidden=true;
        mnu[i].style.display="none";
      }  
      for(var i=0;i<cols.length;i++){
        cols[i].hidden=false;
        cols[i].style.display="block";
      }
    // }
    // else{
    
    // }
    
     var mx=mouseX(event);
    var my=mouseY(event);
   
if ((mx+190)>innerWidth) {
  
      mx = mx-200;
      
}

    document.getElementById("rmenu").className = "show";
    
      document.getElementById("rmenu").style.top =my+"px";
      document.getElementById("rmenu").style.left = mx+"px";
        editclass=true;
    // }
   }
}
//

//

            function dropsett(event){
  document.getElementById("setdrop").classList.toggle("show");
  document.getElementById("setdrop").style.top = mouseY(event) + 'px';
  document.getElementById("setdrop").style.left = mouseX(event)+ 'px';

  if(pathtype=="home"){
    var hompg =document.getElementsByClassName("hompg");
      for(var i=0;i<hompg.length;i++){
        hompg[i].hidden=true;
      }
  }
  else{
    var hompg =document.getElementsByClassName("hompg");
      for(var i=0;i<hompg.length;i++){
        hompg[i].hidden=false;
      }
  }
} 
function droptext(event){
  document.getElementById("folfill").classList.toggle("show");
  document.getElementById("folfill").style.top = mouseY(event)+15 + 'px';
  document.getElementById("folfill").style.left = mouseX(event)-100 + 'px';
} 
function dropopw(event){
  
  var paths=eventrgt.target.name;
  var msg;
  if(paths["filepath"].includes('http')){
    msg =paths["type"]+"&"+paths["filename"]+"&"+paths["filepath"];
  }
  else{
  if(fs.lstatSync(paths["filepath"]).isFile() ){
    msg =paths["type"]+"&"+paths["filename"]+"&"+paths["filepath"]+"&"+getFilesizeInBytes(paths['filepath']);
  }else if(fs.lstatSync(paths["filepath"]).isDirectory() ){
    
    msg =paths["type"]+"&"+paths["filename"]+"&"+paths["filepath"]+"&"+abbreviateNumber(getDirSize(paths['filepath']));
  }}
  
  
  
 let win= window.open("openwith.html","popup",'width=300,height=350');
 win['prop']=msg;
} 
function dropseting(event){
  document.getElementById("setmenu").classList.toggle("show");
  document.getElementById("setmenu").style.top = mouseY(event)+15 + 'px';
  document.getElementById("setmenu").style.left = mouseX(event)-50 + 'px';
} 
function savenote(){
  var folderpath=pathname;
if(folderpath=="Home"){

fs.writeFileSync( "./main/fileytalenote.txt", txtar.value); 

}
else{
if(fs.existsSync(folderpath)){


fs.writeFileSync( folderpath+"/fileytalenote.txt", txtar.value);   
}else{
  if (!fs.existsSync(folderpath)){
    fs.mkdirSync(folderpath);
    fs.writeFileSync( folderpath+"/fileytalenote.txt", txtar.value); 
  }

    fs.writeFileSync( folderpath+"/fileytalenote.txt", txtar.value); 

}
}
alert("Saved");
}   
function mouseX(evt) {
  if (evt.pageX) {
    return evt.pageX;
  } else if (evt.clientX) {
    return evt.clientX + (document.documentElement.scrollLeft ?
      document.documentElement.scrollLeft :
      document.body.scrollLeft);
  } else {
    return null;
  }
}

function mouseY(evt) {
  if (evt.pageY) {
    return evt.pageY;
  } else if (evt.clientY) {
    return evt.clientY + (document.documentElement.scrollTop ?
      document.documentElement.scrollTop :
      document.body.scrollTop);
  } else {
    return null;
  }
}
function closemenu(){
  document.getElementById("pgmenu").className = "hide";
  document.getElementById("setdrop").className = "hide";
  document.getElementById("folfill").className = "hide";
  document.getElementById("setmenu").className = "hide";
  document.getElementById("menusvitm").className = "hide";
}
window.addEventListener("click", function(event) {
  document.getElementById("rmenu").className = "hide";
  document.getElementById("rpmenu").className = "hide";
  document.getElementById("rpmenu2").className = "hide";
  
  // document.getElementById("pgmenu").className = "hide";
 

});
// const { promises: fls } = require("fs")
//             async function copyDir(src, dest) {
//     await fls.mkdir(dest, { recursive: true });
//     let entries = await fls.readdir(src, { withFileTypes: true });

//     for (let entry of entries) {
//         let srcPath = path.join(src, entry.name);
//         let destPath = path.join(dest, entry.name);

//         entry.isDirectory() ?
//             await copyDir(srcPath, destPath) :
//             await fls.copyFile(srcPath, destPath);
//     }
// }
var objsf={};
addflnm.addEventListener('click', function () {
  
  if(objtype=="file"){
  if(newfilenm.value==objpath){
    alert("File Name Already Exists")
  }else{
  fs.copyFileSync(objsf['filepath'], pathname+"/"+newfilenm.value);
      objsf['filename']=newfilenm.value;
  objsf['filepath']=pathname+"/"+newfilenm.value;
      lff.push( pathname+"/"+newfilenm.value);
      arfile.push(objsf);
      dissap();
      startapp();
savefile();
fs.writeFileSync( pathname+"/listfile.json", JSON.stringify(lff));     
    }
  }else{
     if(newfilenm.value==objpath){
    alert("File Name Already Exists")
  }else{
    copyDir(objsf['filepath'], pathname+"/"+newfilenm.value+"/")
      objsf['filename']=newfilenm.value;
  objsf['filepath']=pathname+"/"+newfilenm.value;
      lff.push(pathname+"/"+newfilenm.value); 
      arfile.push(objsf);
      dissap();
      startapp();
savefile();
fs.writeFileSync( pathname+"/listfile.json", JSON.stringify(lff));     
  }
  }
   
});
function oprel(){
  if(document.getElementById('gridmenu')){
  document.getElementById('gridmenu').remove();
}
  var dvm =document.createElement('div')
  dvm.id="gridmenu";
      dvm.innerHTML="";
      dvm.className="classfile";
      var list =arcpy;
      
      for(var a=0;a<list.length;a++){
  var dvq =document.createElement('div');
var img=document.createElement('div');
          var label=document.createElement('label');
          var icon=document.createElement('div');
          var dvtp=document.createElement('div');
          var dvtb=document.createElement('div');
          var lbltb=document.createElement('label');
          icon.className="iconimg";
          dvtp.className="dvtp";
          dvtb.className="dvtb";
          lbltb.className="lbltb";
          dvq.id=list[a]['filepath'];            
          img.id=list[a]['filepath'];
          label.id=list[a]['filepath'];
           dvtp.id=list[a]['filepath'];
          icon.id=list[a]['filepath'];
          dvtb.id=list[a]['filepath'];
          lbltb.id=list[a]['filepath'];
          dvq.className="divfileclass";
          img.className="imgiconclass";
          label.className="txtfile";
          dvq.name=list[a];
          img.name=list[a];
          label.name=list[a];
          dvtp.name=list[a];
          icon.name=list[a];
          dvtb.name=list[a];
          lbltb.name=list[a];
          if(list[a]['type']=="web"){
            lbltb.innerHTML="web";
          }
          if(list[a]['type']=="folder"){
            lbltb.innerHTML="folder";
          }
          if(list[a]['type']=="file"){
            if(splitLastOccurrence(list[a]['filepath'].split("/").pop(),".") !=list[a]['filepath'] && splitLastOccurrence(list[a]['filepath'].split("/").pop(),".") !="False"){
            lbltb.innerHTML=splitLastOccurrence(list[a]['filepath'].split("/").pop(),".");
          }
            
          }
         
          icon.style.borderColor=list[a]['background'];  
          icon.innerHTML=iconstyle(list[a]['type'],list[a]['filepath']);
          dvtp.appendChild(icon)
          // dvtb.appendChild(lbltb)
          img.appendChild(dvtp)
          img.appendChild(dvtb)
          label.innerHTML=list[a]['filename'];
          dvq.draggable=true;
          img.style.borderColor=list[a]['background'];
          img.style.borderStyle=list[a]['style']; 
          dvq.title=list[a]['filename'];
          dvq.addEventListener('dragstart', function (event)  { 
            event.dataTransfer.setData("Text", event.target.id);
            // var arfile2=arfile.filter((e) => e.page == curpage);
            // let obj = arfile2.find(x => x.filepath === event.target.id);
let index = arcpy.indexOf(event.target.name);
var idne=arcpy[index]['ids'];
event.dataTransfer.setData("data", idne);
event.dataTransfer.setData("ardata", JSON.stringify(arcpy[index]));
event.dataTransfer.setData("ids", index);
event.dataTransfer.setData("curp", curpage);
event.dataTransfer.setData("copybox","true");

          }, false); 
//           dvq.addEventListener('dragover',function (event)  {  allowDrop(event)}, false);
//           dvq.addEventListener('drop', function (event)  { 
//             event.preventDefault();            
//             const idx = event.dataTransfer.getData("data");
//                         const data = event.dataTransfer.getData("Text");
//                         const indx = event.dataTransfer.getData("ids");
//               let index = indx;
//               var idne=arfile[index]['ids'];
//               arcpy.push(arfile[index]);
  
//   if(arfile[index]['class']=="" ){
// mainplace.children[idne].innerHTML="";
// }
// arfile.splice(index, 1); // 2nd parameter means remove one item only
// startapp();
// oprel();
// savefile();
//           }, false); 
  
          dvq.appendChild(img);
          dvq.appendChild(label); 
         
        
          dvm.appendChild(dvq);
}

dvm.addEventListener('dragover',function (event)  {  allowDrop(event)}, false);
      dvm.addEventListener('drop', function (event)  { 
            event.preventDefault();            
            var idx = event.dataTransfer.getData("data");
                        var data = event.dataTransfer.getData("Text");
                        var indx = event.dataTransfer.getData("ids");
                        var copybox = event.dataTransfer.getData("copybox");
              let index = indx;
              
              var idne=idx;
              if(copybox!="true"){
              arcpy.push(arfile[index]);
  
  if(arfile[index]['class']=="" ){
mainplace.children[idne].innerHTML="";
}
arfile.splice(index, 1); // 2nd parameter means remove one item only


this.removeEventListener('dragover',arguments.callee,false);
this.removeEventListener('drop',arguments.callee,false);
startapp();
savefile();
oprel();
}

          }, false); 
          document.getElementById("menusvitm").appendChild(dvm);
          
}
function oprel2(){
  if(document.getElementById('gridmenu')){
  document.getElementById('gridmenu').remove();
}
  var dvm =document.createElement('div')
  dvm.id="gridmenu";
      dvm.innerHTML="";
      dvm.className="classfile";
      var list =arprcpy;
      
      for(var a=0;a<list.length;a++){
  var dvq =document.createElement('div');
var img=document.createElement('div');
          var label=document.createElement('label');
          var icon=document.createElement('div');
          var dvtp=document.createElement('div');
          var dvtb=document.createElement('div');
          var lbltb=document.createElement('label');
          icon.className="iconimg";
          dvtp.className="dvtp";
          dvtb.className="dvtb";
          lbltb.className="lbltb";
          dvq.id=list[a]['filepath'];            
          img.id=list[a]['filepath'];
          label.id=list[a]['filepath'];
           dvtp.id=list[a]['filepath'];
          icon.id=list[a]['filepath'];
          dvtb.id=list[a]['filepath'];
          lbltb.id=list[a]['filepath'];
          dvq.className="divfileclass";
          img.className="imgiconclass";
          label.className="txtfile";
          dvq.name=list[a];
          img.name=list[a];
          label.name=list[a];
          dvtp.name=list[a];
          icon.name=list[a];
          dvtb.name=list[a];
          lbltb.name=list[a];
          
          if(list[a]['filepath']){
            lbltb.innerHTML="folder";
            icon.innerHTML="&#x1F4C1;";
          }
          else{
            lbltb.innerHTML="project";
            icon.innerHTML="&#x1F4D7;";
          }
         
          icon.style.borderColor=list[a]['background'];  
          
          dvtp.appendChild(icon)
          // dvtb.appendChild(lbltb)
          img.appendChild(dvtp)
          img.appendChild(dvtb)
          label.innerHTML=list[a]['filename'];
          dvq.draggable=true;
          img.style.borderColor=list[a]['background'];
          img.style.borderStyle=list[a]['style']; 
          dvq.title=list[a]['filename'];
          dvq.addEventListener('dragstart', function (event)  { 
            event.dataTransfer.setData("Text", event.target.id);
            // var arfile2=arfile.filter((e) => e.page == curpage);
            // let obj = arfile2.find(x => x.filepath === event.target.id);
let index = arprcpy.indexOf(event.target.name);
var idne=arprcpy[index]['ids'];
event.dataTransfer.setData("data", idne);
event.dataTransfer.setData("ardata", JSON.stringify(arprcpy[index]));
event.dataTransfer.setData("ids", index);
event.dataTransfer.setData("curp", curpage);
event.dataTransfer.setData("copybox","true");

          }, false); 
//           dvq.addEventListener('dragover',function (event)  {  allowDrop(event)}, false);
//           dvq.addEventListener('drop', function (event)  { 
//             event.preventDefault();            
//             const idx = event.dataTransfer.getData("data");
//                         const data = event.dataTransfer.getData("Text");
//                         const indx = event.dataTransfer.getData("ids");
//               let index = indx;
//               var idne=arfile[index]['ids'];
//               arcpy.push(arfile[index]);
  
//   if(arfile[index]['class']=="" ){
// mainplace.children[idne].innerHTML="";
// }
// arfile.splice(index, 1); // 2nd parameter means remove one item only
// startapp();
// oprel();
// savefile();
//           }, false); 
  
          dvq.appendChild(img);
          dvq.appendChild(label); 
         
        
          dvm.appendChild(dvq);
}

dvm.addEventListener('dragover',function (event)  {  allowDrop(event)}, false);
      dvm.addEventListener('drop', function (event)  { 
            event.preventDefault();            
            var idx = event.dataTransfer.getData("data");
                        var data = event.dataTransfer.getData("Text");
                        var indx = event.dataTransfer.getData("ids");
                        var copybox = event.dataTransfer.getData("copybox");
              let index = indx;
              
              var idne=idx;
              if(copybox!="true"){
              arprcpy.push(arfile[index]);
  



this.removeEventListener('dragover',arguments.callee,false);
this.removeEventListener('drop',arguments.callee,false);
startapp();
savefile();
oprel2();
              }
          }, false); 
          document.getElementById("menusvitm").appendChild(dvm);
          
}
function opsvcp(){
  var mx=mouseX(event);
    var my=mouseY(event);
    if ((my+150)>innerHeight) {
      
      my = my-150;
      
}
if ((mx+200)>innerWidth) {
  
      mx = mx-200;
      
}
    document.getElementById("menusvitm").className = "show";
      document.getElementById("menusvitm").style.top = my+ 'px';
      document.getElementById("menusvitm").style.left = mx + 'px';
      if(pathtype=="home"){
        oprel2();
      }else{
     oprel();
    }
}
function openitm(wth){
  var url = eventrgt.target.id;
  // alert(url)
  let objs = arfile.find(x => x.filename === url);
        let index = arfile.indexOf(eventrgt.target.name);
if(wth=="default"){
  
        

var start = (process.platform == 'darwin'? 'open': process.platform == 'win32'? 'start': 'xdg-open');
try{
  if(url.includes("http")){
  require('child_process').exec(start + ' ' + url);
}
else{
  try{
   
  require('child_process').exec(""+url+""+" || "+start + ' ' + "'file:///"+url+"'");
  }catch(e){
  //   try
    require('child_process').exec(start + ' ' + "'file:///"+url+"'");
    
  }
}
}catch(e){
  try{
  
  require('child_process').exec(""+url+""+" || "+start + ' ' + "'file:///"+url+"'");
  }catch(e){
    require('child_process').exec(start + ' ' + "'file:///"+url+"'");
    
  }
}


}
else if(wth=="sif"){
  
  if(!url.includes("http")){
  nw.Shell.showItemInFolder(url);
  }
  
}
else{  
  if(pathtype=="home"){
    
    
    
    try{
    if(fs.lstatSync(objs["filepath"].replaceAll('"', '')).isDirectory() ){
      
 var button = objs["filepath"];    
  mainplace.innerHTML="";
            classmap.innerHTML="";
              arfile=[];
              classfile=[];
              curpage=1;
              
              
              pagesort=['normal'];
              if(pathcount==(pathsort.length)){
              foldsort.push("folder");
              pathsort.push(button);
              
            }
            else{
              
              foldsort[pathcount]="folder";
              pathsort[pathcount]=button;
              var a = pathcount+1;
var b = pathsort.length;

pathsort.splice(a, (b - a) + 1);
foldsort.splice(a, (b - a) + 1);
            }
            pathcount++;
              pathtype ="folder";
              pathname =button;


var arflrc =[];
    // if(localStorage.getItem("recent")){
      if(localStorage.getItem('recentfpl')){
    arflrc = JSON.parse(localStorage["recentfpl"]);
      }

  // var arc=[];
 if(arflrc.length==7){
  arflrc.pop();
 }
  arflrc.splice(0, 0, button);
  let unique_ar = [];
  arflrc.forEach((ar) => {
    if (!unique_ar.includes(ar)) {
      unique_ar.push(ar);
    }
  });
  
  
  localStorage["recentfpl"] = JSON.stringify(unique_ar);

  startapp();
  lastpath=pathname;
}
    }catch(e){
 var button = url;
    
    mainplace.innerHTML="";
            classmap.innerHTML="";
            curpage=1;
            arfile=[];
              classfile=[];
               foldsort.push("custom");
              pathsort.push("./project/"+button);
    pathcount++;
  pathtype="custom";
  pathname="./project/"+button; 
  
  

var arflrc =[];
    // if(localStorage.getItem("recent")){
      if(localStorage.getItem('recentfpl')){
    arflrc = JSON.parse(localStorage["recentfpl"]);
      }

  // var arc=[];
 if(arflrc.length==7){
  arflrc.pop();
 }
  arflrc.splice(0, 0, button);
  let unique_ar = [];
  arflrc.forEach((ar) => {
    if (!unique_ar.includes(ar)) {
      unique_ar.push(ar);
    }
  });
  
  
  localStorage["recentfpl"] = JSON.stringify(unique_ar);

  startapp();
  lastpath=pathname;
   
    }
        
  }else{
    try{
  if(url.includes("http")){
                  window.open(url,'popup','width=600,height=600');  
                }
                else if(fs.lstatSync(url).isDirectory() ){
                  mainplace.innerHTML="";
            classmap.innerHTML="";
              arfile=[];
              classfile=[];
              curpage=1;
              
              
              pagesort=['normal'];
              if(pathcount==(pathsort.length)){
              foldsort.push("folder");
              pathsort.push(button);
            }
            else{
              foldsort[pathcount]="folder";
              pathsort[pathcount]=button;
              var a = pathcount+1;
var b = pathsort.length;

pathsort.splice(a, (b - a) + 1);
foldsort.splice(a, (b - a) + 1);
            }
            pathcount++;
              pathtype ="folder";
              pathname =url;
                startapp();
                }
                else{
                  window.open("file:///"+url,'popup','width=600,height=600');
                }
              }catch(e){alert(e)}
}}
}
function editpage(){
  document.getElementById("loading").style.display="flex";
    document.getElementById("newitemin").style.display="none";
        document.getElementById("editupl").style.display="none";
        document.getElementById("newpage").style.display="block";
}
function editfilename(){
  document.getElementById("loading").style.display="flex";
    document.getElementById("newitemin").style.display="none";
        document.getElementById("editupl").style.display="none";
        savenewfile.style.display="block";
}
function edititm(){
  document.getElementById("loading").style.display="flex";
    document.getElementById("newitemin").style.display="none";
        document.getElementById("editupl").style.display="block";
        additm.style.display="block";
        if(editclass==false){
        editim=true;        
        let obj = arfile.find(x => x.filepath === eventrgt.target.id);
        let index = arfile.indexOf(eventrgt.target.name);
        flnm.value=arfile[index]['filename'] ;
        hmfl=arfile[index]['filename'] ;  
        slsty.value=arfile[index]['style'];
        if(arfile[index]['icon']){
        icontxt.value=arfile[index]['icon'] ;
      }
        slclass.disabled=true;
        if(pathname=="Home"){
      
          flkey.disabled=true;
        }
            if(arfile[index]['background']=="transparent"){
              trpc.checked=true
            }else{
            flbg.value=arfile[index]['background'];
          }
            // obj['icon']=;
            flkey.value=arfile[index]['keywords'];
          }else{
            clss=true;
            slclass.disabled=true;
            flkey.disabled=true;
            slsty.disabled=true;
            let index = eventrgt.target.name;
            
        flnm.value=classfile[index]['classname'] ;
            
            if(classfile[index]['background']=="transparent"){
              trpc.checked=true
            }else{
            flbg.value=classfile[index]['background'];
          }
            // obj['icon']=;
            flkey.value=classfile[index]['keywords'];
          }
            
}
function copyToClipboard(text) {
    navigator.clipboard.writeText(text).then(() => {
        console.log('Text copied to clipboard');
    }).catch(err => {
        console.error('Failed to copy text: ', err);
    });
}
function cutitm(){
  var event=eventrgt;
  formData=new FormData();
  formData.append("Text", event.target.id);
  var arfile2=arfile.filter((e) => e.page == curpage);
              let obj = arfile2.find(x => x.filepath === event.target.id);
              let index = arfile.indexOf(event.target.name);
  var idne=arfile[index]['ids'];
  formData.append("data", idne);
  formData.append("ids", index);
  formData.append("curp", curpage);
  formData.append("copy", "false");
  formData.append("path", pathname);
  formData.append("arfile", JSON.stringify(arfile[index]));
  var objcp={};
  objcp["data"]=idne;
  objcp["ids"]=index;
  objcp["curp"]=curpage;
  objcp["path"]=pathname;
  objcp["arfile"]=JSON.stringify(arfile[index]);
  copyToClipboard(JSON.stringify(objcp));
  if(arfile[index]['class']=="" ){
mainplace.children[idne].style.opacity="0.5";
}
if(arfile[index]['type']){
    arcpy.push(arfile[index]);
  }
  
  if(arfile[index]['type']=="folder" ||!arfile[index]['type']){
    arprcpy.push(arfile[index]);
  }
}

function pasteitm(){
  var event=eventrgt;
  
  // var clb = nw.Clipboard.get();
  // alert(clb.get("text"))
  // const idx = formData.get("data");
  //                       const data = formData.get("Text");
  //                       const ardata = formData.get("arfile");
  //                       const indx = formData.get("ids");
  //                       const curp = formData.get("curp");
  //                       const cpy=formData.get("copy");
  //                       const pth=formData.get("path");                        
// var filep=JSON.parse(ardata);
// pasteImage()
navigator.clipboard.readText()

  .then(text => {
   try{
    var l=JSON.parse(text);

    formData=text
    var osa=JSON.parse(text)
    const idx = osa["data"];
                        const data = osa["Text"];
                        const ardata = osa["arfile"];
                        const indx = osa["ids"];
                        const curp = osa["curp"];
                        const cpy=osa["copy"];
                        const pth=osa["path"];                        

          var co=0;
          var sts;
          try{
              while(mainplace.children[co].childElementCount > 0 ){
                
                co++;  
     
              }
            }catch(e){
              alert('Page is Full');
              sts="Page is Full";
            }
              if(sts!="Page is Full"){
                if(pathtype=="home"){
                  if(cpy=="true"){
  var obj=JSON.parse(ardata);
  var obj2={};
  try{
  if(obj['type']=="folder"||!obj['type']){
  obj2['filename']=obj['filename'];
  obj2['filepath']=obj['filepath'];
  obj2['background']=obj['background'];
  if(obj['icon']){
  obj2['icon']=obj['icon'];
}
  obj2['style']=obj['style'];
  obj2['keywords']=obj['keywords'];
  obj2["ids"]=co;
  obj2["class"]="";
  obj2["page"]=curpage;  
  obj2['type']=obj['type'];
  // dvp.name=obj2; 
  arfile.push(obj2);
}
}catch(e){}
}
else{
  var obj=JSON.parse(ardata);
  var iind=arfile.indexOf(JSON.stringify(obj));
  try{
  if(obj['type']=="folder"||!obj['type']){
  //alert(JSON.stringify(arfile[indx])+JSON.stringify(obj))
  if(pathname!=pth){
    
    urls=pth+"/arfile.json";
    
    f(urls) .then((d) => {
        fildet=d;
      arfl=fildet["file"]; 
     
         
      if (indx> -1) { // only splice array when item is found
        arfl.splice(indx, 1); // 2nd parameter means remove one item only
}
var objsav={};
objsav["file"]=arfl;
objsav["pagesort"]=fildet["pagesort"];
objsav["pagename"]=fildet["pagename"];
fs.writeFileSync( pth+"/arfile.json", JSON.stringify(objsav)); 
    } )
        
  }else{
  if (Object.values(obj).join("") ==Object.values(arfile[indx]).join("")) { // only splice array when item is found
    //alert(JSON.stringify(arfile[indx])+JSON.stringify(obj))
    arfile.splice(indx, 1); // 2nd parameter means remove one item only
}
}
  
  var obj=JSON.parse(ardata);
  var obj2={};
  
  obj2['filename']=obj['filename'];
  obj2['filepath']=obj['filepath'];
  if(obj['icon']){
  obj2['icon']=obj['icon'];
}
  obj2['background']=obj['background'];
  obj2['style']=obj['style'];
  obj2['keywords']=obj['keywords'];
  obj2["ids"]=co;
  obj2["class"]="";
  obj2["page"]=curpage;  
  obj2['type']=obj['type'];
  // dvp.name=obj2; 
  arfile.push(obj2);
  }//
}catch(e){}
}
// formData=new FormData() ;
startapp();
savefile();
                }
                else{
                  try{
                  if(cpy=="true"){
  var obj=JSON.parse(ardata);
  var obj2={};
  if(obj['type']){
  obj2['filename']=obj['filename'];
  obj2['filepath']=obj['filepath'];
  obj2['background']=obj['background'];
  if(obj['icon']){
  obj2['icon']=obj['icon'];
}
  obj2['style']=obj['style'];
  obj2['keywords']=obj['keywords'];
  obj2["ids"]=co;
  obj2["class"]="";
  obj2["page"]=curpage;  
  obj2['type']=obj['type'];
  // dvp.name=obj2; 
  arfile.push(obj2);
  }
}
else if(cpy=="truefull"){
  var obj=JSON.parse(ardata);
  var obj2={};
  if(obj['type']){
  obj2['filename']=obj['filename'];
  obj2['filepath']=pathname+"/"+getFileDirectory(obj['filepath']);
  obj2['background']=obj['background'];
  if(obj['icon']){
  obj2['icon']=obj['icon'];
}
  obj2['style']=obj['style'];
  obj2['keywords']=obj['keywords'];
  obj2["ids"]=co;
  obj2["class"]="";
  obj2["page"]=curpage;  
  obj2['type']=obj['type'];
  // dvp.name=obj2; 
  
  if(pathtype=="folder"){
    
  if(obj['type']=="file"){
  if (fs.existsSync( pathname+"/"+getFileDirectory(obj['filepath']))) {
    editfilename();    
    objpath=getFileDirectory(obj['filepath']);
    newfilenm.value=getFileDirectory(objpath);
    objtype="file";
    objsf=obj2;
    }else{

  fs.copyFileSync(obj['filepath'], pathname+"/"+getFileDirectory(obj['filepath']));
  lff.push( pathname+"/"+getFileDirectory(obj['filepath']));
  arfile.push(obj2);
  fs.writeFileSync( pathname+"/listfile.json", JSON.stringify(lff));
  startapp();
  savefile();
}
}
if(obj['type']=="folder"){
  
  if (fs.existsSync( pathname+"/"+getFileDirectory(obj['filepath'])+"/")){
    editfilename();
    objpath=getFileDirectory(obj['filepath']);
    newfilenm.value=getFileDirectory(objpath);
   objtype="folder";
   objsf=obj2;
    }else{

      copyDir(obj['filepath'], pathname+"/"+getFileDirectory(obj['filepath'])+"/")
      lff.push(pathname+"/"+getFileDirectory(obj['filepath']));
      arfile.push(obj2);
      fs.writeFileSync( pathname+"/listfile.json", JSON.stringify(lff));  
      startapp();
      savefile();
}
}

// fs.writeFileSync( pathname+"/listfile.json", JSON.stringify(lff));

}
  }
}else{
  var obj=JSON.parse(ardata);
  var iind=arfile.indexOf(JSON.stringify(obj));
  //alert(JSON.stringify(arfile[indx])+JSON.stringify(obj))
  if(obj['type']){
  if(pathname!=pth){
    
    urls=pth+"/arfile.json";
    
    f(urls) .then((d) => {
        fildet=d;
      arfl=fildet["file"]; 
     
         
      if (indx> -1) { // only splice array when item is found
        arfl.splice(indx, 1); // 2nd parameter means remove one item only
}
var objsav={};
objsav["file"]=arfl;
objsav["pagesort"]=fildet["pagesort"];
objsav["pagename"]=fildet["pagename"];
fs.writeFileSync( pth+"/arfile.json", JSON.stringify(objsav)); 
    } )
        
  }else{
  if (Object.values(obj).join("") ==Object.values(arfile[indx]).join("")) { // only splice array when item is found
    //alert(JSON.stringify(arfile[indx])+JSON.stringify(obj))
    arfile.splice(indx, 1); // 2nd parameter means remove one item only
}
}
  
  var obj=JSON.parse(ardata);
  var obj2={};
  
  obj2['filename']=obj['filename'];
  obj2['filepath']=obj['filepath'];
  obj2['background']=obj['background'];
  if(obj['icon']){
  obj2['icon']=obj['icon'];
}
  obj2['style']=obj['style'];
  obj2['keywords']=obj['keywords'];
  obj2["ids"]=co;
  obj2["class"]="";
  obj2["page"]=curpage;  
  obj2['type']=obj['type'];
  // dvp.name=obj2; 
  arfile.push(obj2);

}
}

formData=new FormData() ;
if(cpy!="truefull"){
startapp();
savefile();
                  }
}catch(e){}
                }
                  
                    
                  
        
    } 
   }catch(e){
    if(fs.existsSync(text.replaceAll('"', ''))){
      text=text.replaceAll('"', '');
      var co=0;
          var sts;
          try{
              while(mainplace.children[co].childElementCount > 0 ){
                
                co++;  
     
              }
            }catch(e){
              alert('Page is Full');
              sts="Page is Full";
            }
            if(sts!="Page is Full"){
              
  var obj2={};
  
  obj2['filename']=text.split('/').pop();
  obj2['filepath']=text;
  obj2['background']="transparent";
 
  obj2['style']="solid";            
  obj2['keywords']="";
  obj2["ids"]=co;
  obj2["class"]="";
  obj2["page"]=curpage;  
  if(fs.lstatSync(text).isDirectory()){
  obj2['type']="folder";
  }
  
  else{
    obj2['type']="file";
  }
  // dvp.name=obj2; 
  if(pathtype=="home"){
  if(fs.lstatSync(text).isDirectory()){
  arfile.push(obj2);
  savefile();
  startapp();
  }
}else{
  arfile.push(obj2);
  savefile();
  startapp();
  
}
            }
    }
    else if(text.includes("http")){
      
     
      var co=0;
          var sts;
          try{
              while(mainplace.children[co].childElementCount > 0 ){
                
                co++;  
     
              }
            }catch(e){
              alert('Page is Full');
              sts="Page is Full";
            }
            if(sts!="Page is Full"){
              
  var obj2={};
  
  obj2['filename']=text;
  obj2['filepath']=text;
  obj2['background']="transparent";
  
  obj2['style']="solid";            
  obj2['keywords']="";
  obj2["ids"]=co;
  obj2["class"]="";
  obj2["page"]=curpage;  
  
    obj2['type']="web";
 
  // dvp.name=obj2; 
  if(pathtype=="home"){
  if(fs.lstatSync(text).isDirectory()){
  arfile.push(obj2);
  savefile();
  startapp();
  }
}else{
  arfile.push(obj2);
  savefile();
  startapp();
  
}
            }
    }
   }
   
    
   
    
  })
  .catch(err => {
    
  });

}
function pasteitm2(){
  var event=eventrgt;
  
//   const idx = formData.get("data");
//                         const data = formData.get("Text");
//                         const ardata = formData.get("arfile");
//                         const indx = formData.get("ids");
//                         const curp = formData.get("curp");
//                         const cpy=formData.get("copy");
//                         const pth=formData.get("path");
                        
// var filep=JSON.parse(ardata);
navigator.clipboard.readText()
  
  .then(text => {
    try{
      
      var osa=JSON.parse(text)
    const idx = osa["data"];
                        const data = osa["Text"];
                        const ardata = osa["arfile"];
                        const indx = osa["ids"];
                        const curp = osa["curp"];
                        const cpy=osa["copy"];
                        const pth=osa["path"]; 
    var classfile2=classfile.filter((e) => e.page == curpage);
             var  ssp=classfile2[~~event.target.name];
          
var classn;
try{
  classn=event.currentTarget.name;
}catch(e){
  classn=event.target.name;
}

var co=0;
          var arfile2=arfile.filter((e) => e.page == curpage);
 
 
var arfile3=arfile2.filter((e) => e.class == classn);
co=arfile3.length;
ssp['list'].push(~~indx);
try{
if(cpy=="true"){
  var obj=JSON.parse(ardata);
  var obj2={};
  if(obj['type']){
  obj2['filename']=obj['filename'];
  obj2['filepath']=obj['filepath'];
  obj2['background']=obj['background'];
  if(obj['icon']){
  obj2['icon']=obj['icon'];
}
  obj2['style']=obj['style'];
  obj2['keywords']=obj['keywords'];
  obj2["ids"]=co;
  obj2["class"]=classn;
  obj2["page"]=curpage;  
  obj2['type']=obj['type'];
  // dvp.name=obj2; 
  arfile.push(obj2);
  }
  
}
else if(cpy=="truefull"){
  var obj=JSON.parse(ardata);
  var obj2={};
  if(obj['type']){
  obj2['filename']=obj['filename'];
  obj2['filepath']=pathname+"/"+getFileDirectory(obj['filepath']);
  obj2['background']=obj['background'];
  if(obj['icon']){
  obj2['icon']=obj['icon'];
}
  obj2['style']=obj['style'];
  obj2['keywords']=obj['keywords'];
  obj2["ids"]=co;
  obj2["class"]=classn;
  obj2["page"]=curpage;  
  obj2['type']=obj['type'];
  // dvp.name=obj2; 
  
  if(pathtype=="folder"){
  if(obj['type']=="file"){
    if (fs.existsSync( pathname+"/"+getFileDirectory(obj['filepath']))) {
    editfilename();
  objpath=getFileDirectory(obj['filepath']);
    newfilenm.value=getFileDirectory(objpath);
   objtype="file";
   objsf=obj2;
    }else{

  fs.copyFileSync(obj['filepath'], pathname+"/"+getFileDirectory(obj['filepath']));
  lff.push( pathname+"/"+getFileDirectory(obj['filepath']));
  arfile.push(obj2);
  fs.writeFileSync( pathname+"/listfile.json", JSON.stringify(lff));
  startapp();
  savefile();
}
}
if(obj['type']=="folder"){
  if (fs.existsSync( pathname+"/"+getFileDirectory(obj['filepath'])+"/")){
    editfilename();
    objpath=getFileDirectory(obj['filepath']);
    newfilenm.value=getFileDirectory(objpath);
   objtype="folder";
   objsf=obj2;
    }else{

      copyDir(obj['filepath'], pathname+"/"+getFileDirectory(obj['filepath'])+"/")
      lff.push(pathname+"/"+getFileDirectory(obj['filepath']));
      arfile.push(obj2);
  fs.writeFileSync( pathname+"/listfile.json", JSON.stringify(lff));
  startapp();
  savefile();
}
  
}
// fs.writeFileSync( pathname+"/listfile.json", JSON.stringify(lff));
}
  }
}else{
  var obj=JSON.parse(ardata);
  var iind=arfile.indexOf(JSON.stringify(obj));
  // alert(JSON.stringify(arfile[indx])+JSON.stringify(obj))
  if(obj['type']){
  if(pathname!=pth){
    
    urls=pth+"/arfile.json";
    
    f(urls) .then((d) => {
        fildet=d;
      arfl=fildet["file"]; 
     
         
      if (indx> -1) { // only splice array when item is found
        arfl.splice(indx, 1); // 2nd parameter means remove one item only
}
var objsav={};
objsav["file"]=arfl;
objsav["pagesort"]=fildet["pagesort"];
objsav["pagename"]=fildet["pagename"];
fs.writeFileSync( pth+"/arfile.json", JSON.stringify(objsav)); 
    } )
        
  }else{
  if (Object.values(obj).join("") ==Object.values(arfile[indx]).join("")) { // only splice array when item is found
    //alert(JSON.stringify(arfile[indx])+JSON.stringify(obj))
    arfile.splice(indx, 1); // 2nd parameter means remove one item only
}
}
  
  var obj=JSON.parse(ardata);
  var obj2={};
  
  obj2['filename']=obj['filename'];
  obj2['filepath']=obj['filepath'];
  obj2['background']=obj['background'];
  if(obj['icon']){
  obj2['icon']=obj['icon'];
}
  obj2['style']=obj['style'];
  obj2['keywords']=obj['keywords'];
  obj2["ids"]=co;
  obj2["class"]=classn;
  obj2["page"]=curpage;  
  obj2['type']=obj['type'];
  // dvp.name=obj2; 
  arfile.push(obj2);

  // alert(JSON.stringify(arfile)+" p")
}
}

  formData=new FormData() ;
  if(cpy!="truefull"){
startapp();
savefile();
                  }
}catch(e){}
    }
    catch(e){
      if(fs.existsSync(text.replaceAll('"', ''))){
      text=text.replaceAll('"', '');
      var co=0;
          var sts;
          var classn;
try{
  classn=event.currentTarget.name;
}catch(e){
  classn=event.target.name;
}
          
var co=0;
          var arfile2=arfile.filter((e) => e.page == curpage);
 
 
var arfile3=arfile2.filter((e) => e.class == classn);
co=arfile3.length;      
  var obj2={};
  
  obj2['filename']=text.split('/').pop();
  obj2['filepath']=text;
  obj2['background']="transparent";
  obj2['style']="solid";            
  obj2['keywords']="";
  obj2["ids"]=co;
  obj2["class"]=classn;
  obj2["page"]=curpage;  
  if(fs.lstatSync(text).isDirectory()){
  obj2['type']="folder";
  }
  
  else{
    obj2['type']="file";
  }
  // dvp.name=obj2; 
  if(pathtype=="home"){
  if(fs.lstatSync(text).isDirectory()){
  arfile.push(obj2);
  savefile();
  startapp();
  }
}else{
  arfile.push(obj2);
  savefile();
  startapp();
  
}
            
    }
    else if(text.includes("http")){
      var co=0;
          var sts;
          var classn;
try{
  classn=event.currentTarget.name;
}catch(e){
  classn=event.target.name;
}
var co=0;
          var arfile2=arfile.filter((e) => e.page == curpage);
 
 
var arfile3=arfile2.filter((e) => e.class == classn);
co=arfile3.length;
            
              
  var obj2={};
  
  obj2['filename']=text;
  obj2['filepath']=text;
  obj2['background']="transparent";
  obj2['style']="solid";            
  obj2['keywords']="";
  obj2["ids"]=co;
  obj2["class"]=classn;
  obj2["page"]=curpage;  
  
    obj2['type']="web";
 
  // dvp.name=obj2; 
  if(pathtype=="home"){
  if(fs.lstatSync(text).isDirectory()){
  arfile.push(obj2);
  savefile();
  startapp();
  }
}else{
  arfile.push(obj2);
  savefile();
  startapp();
  
}
            
    }
    }
   
    })
  
}
function copyitm(){
  var event=eventrgt;
  formData=new FormData();
  formData.append("Text", event.target.id);
  var arfile2=arfile.filter((e) => e.page == curpage);
              let obj = arfile2.find(x => x.filepath === event.target.id);
  let index = arfile.indexOf(event.target.name);
  // alert(JSON.stringify(event.target.name))
  var idne=arfile[index]['ids'];
  formData.append("data", idne);
  formData.append("ids", index);
  formData.append("curp", curpage);
  formData.append("copy", "true");
  formData.append("arfile", JSON.stringify(arfile[index]));
  var objcp={};
  objcp["data"]=idne;
  objcp["ids"]=index;
  objcp["curp"]=curpage;
  objcp["copy"]="true";
  objcp["arfile"]=JSON.stringify(arfile[index]);
  copyToClipboard(JSON.stringify(objcp));
  if(arfile[index]['type']){
    arcpy.push(arfile[index]);
  }
  
  if(arfile[index]['type']=="folder" ||!arfile[index]['type']){
    arprcpy.push(arfile[index]);
  }
}
function dltitm(){
  var pathclick=eventrgt.target.id;
  let obj = arfile.find(x => x.filepath === pathclick);
  if(pathtype=="home"){
      
      pathclick="./project/"+pathclick;    
       if (confirm("Delete ?")){
    let index = arfile.indexOf(eventrgt.target.name);

// mainplace.children[arfile[index]['ids']].removeChild(mainplace.children[arfile[index]['ids']])
if (index > -1) { // only splice array when item is found
  arfile.splice(index, 1); // 2nd parameter means remove one item only
}
var arflrc =[];
if(localStorage.getItem('recentfpl')){
   arflrc = JSON.parse(localStorage["recentfpl"]);
      }
      let index2 = arflrc.indexOf(eventrgt.target.name['filepath']);
      if(index2==-1){
        index2=arflrc.indexOf(eventrgt.target.id);
      }
// mainplace.children[arfile[index]['ids']].removeChild(mainplace.children[arfile[index]['ids']])
if (index2 > -1) { // only splice array when item is found
  arflrc.splice(index2, 1); // 2nd parameter means remove one item only
}
let unique_ar = [];
  arflrc.forEach((ar) => {
    if (!unique_ar.includes(ar)) {
      unique_ar.push(ar);
    }
  });
localStorage["recentfpl"] = JSON.stringify(unique_ar);
  startapp();
  savefile();
  }
    }else{
  if(editclass==false){
let index = arfile.indexOf(eventrgt.target.name);
document.getElementById(pathclick).remove();
// mainplace.children[arfile[index]['ids']].removeChild(mainplace.children[arfile[index]['ids']])
if (index > -1) { // only splice array when item is found
  arfile.splice(index, 1); // 2nd parameter means remove one item only
}

// alert(JSON.stringify(arfile))
startapp();
savefile();
}else{
  let index = eventrgt.target.name;

// mainplace.children[arfile[index]['ids']].removeChild(mainplace.children[arfile[index]['ids']])
var cln=classfile[index]["classname"]
var arfile2=arfile.filter((e) => e.page == curpage);
var arfile3=arfile2.filter((e) => e.class == cln );
for(var p=0;p<arfile3.length;p++){              
                let indexarit = arfile.indexOf(arfile3[p]);                
                if (indexarit !== -1) {
                    arfile.splice(indexarit,1);
                  }
              }
if (index > -1) { // only splice array when item is found
  classfile.splice(index, 1); // 2nd parameter means remove one item only
}


startapp();
savefile();
}
}

}
function deletepage(){
  var pathclick=eventrgt.target.id;
  if (confirm("Delete Page ?")) {
    arfile=arfile.filter((e) => e.page != curpage);
    classfile=classfile.filter((e) => e.page != curpage);
    for(var i=0;i<arfile.length;i++){
      if(arfile[i]["page"]>curpage){
        arfile[i]["page"]=arfile[i]["page"]-1;
      }
    }
    for(var i=0;i<classfile.length;i++){
      if(classfile[i]["page"]>curpage){
        classfile[i]["page"]=classfile[i]["page"]-1;
      }
    }
// mainplace.children[arfile[index]['ids']].removeChild(mainplace.children[arfile[index]['ids']])
if (curpage-1 > -1) { // only splice array when item is found
  pagesort.splice(curpage-1, 1); // 2nd parameter means remove one item only
  pagenamelst.splice(curpage-1, 1); 
}
pagetype=pagesort[curpage-2];
for(var i=0;i<pagenamelst.length;i++){
  if(~~pagenamelst[i]){
  if(~~pagenamelst[i]>curpage){
        pagenamelst[i] = (Number(pagenamelst[i])-1).toString();
      }
    }
}
// alert(JSON.stringify(arfile))
curpage--;
startapp();
savefile();
closemenu();
  }
}
function copyfile(){
  var event=eventrgt;
  let obj = arfile.find(x => x.filepath === event.target.id);
  let index = arfile.indexOf(event.target.name);
  formData=new FormData();
  formData.append("Text", event.target.id);
              
  var idne=arfile[index]['ids'];
  formData.append("data", idne);
  formData.append("arfile", JSON.stringify(arfile[index]));
  formData.append("ids", index);
  formData.append("curp", curpage);
  formData.append("copy", "truefull");
  var objcp={};
  objcp["data"]=idne;
  objcp["ids"]=index;
  objcp["curp"]=curpage;
  objcp["copy"]="truefull";
  objcp["arfile"]=JSON.stringify(arfile[index]);
  copyToClipboard(JSON.stringify(objcp));
  if(arfile[index]['type']){
    arcpy.push(arfile[index]);
  }
  
  if(arfile[index]['type']=="folder" ||!arfile[index]['type']){
    arprcpy.push(arfile[index]);
  }

}
function movefile(){
  var event=eventrgt;
  formData=new FormData();
  formData.append("Text", event.target.id);
  var arfile2=arfile.filter((e) => e.page == curpage);
              let obj = arfile2.find(x => x.filepath === event.target.id);
              let index = arfile.indexOf(event.target.name);
              var idne=arfile[index]['ids'];
              if(arfile[index]['type']){
    arcpy.push(arfile[index]);
  }
  
  if(arfile[index]['type']=="folder" ||!arfile[index]['type']){
    arprcpy.push(arfile[index]);
  }
  
 
  if(arfile[index]['class']=="" ){
mainplace.children[idne].innerHTML="";
arfile.splice(index, 1); // 2nd parameter means remove one item only
}
else{
  arfile.splice(index, 1); // 2nd parameter means remove one item only
  startapp();
savefile();
}
}
function dltfile(){
  var pathclick=eventrgt.target.id;
  if (confirm("Permanently Delete '"+eventrgt.target.id+"' ?")) {
   
if (fs.existsSync(pathclick)) {
  if(fs.lstatSync(pathclick).isDirectory()){ 
    try{
    require('child_process').exec("gvfs-trash" + ' '+ "'file:///"+pathclick+"'"+"|| gio trash" + ' '+ "'file:///"+pathclick+"'");
    let index = arfile.indexOf(eventrgt.target.name);    
    let indexlff =lff.indexOf(eventrgt.target.id);
    
// mainplace.children[arfile[index]['ids']].removeChild(mainplace.children[arfile[index]['ids']])
if (index > -1) { // only splice array when item is found
  arfile.splice(index, 1); // 2nd parameter means remove one item only
}
if (indexlff > -1) { // only splice array when item is found
  lff.splice(indexlff, 1); // 2nd parameter means remove one item only
}
  startapp();
  savefile(); 
  fs.writeFileSync( pathname+"/listfile.json", JSON.stringify(lff));   
}catch(e)  {
    // Failed with Error
    alert(e)
}
  }
  else{
    // trash(pathclick).then(value => {
    try{
      require('child_process').exec("gvfs-trash" + ' '+ "'file:///"+pathclick+"'"+"|| gio trash" + ' '+ "'file:///"+pathclick+"'");
  // if (err) throw alert(err);
  let index = arfile.indexOf(eventrgt.target.name);
  let indexlff =lff.indexOf(eventrgt.target.id);
// mainplace.children[arfile[index]['ids']].removeChild(mainplace.children[arfile[index]['ids']])
if (index > -1) { // only splice array when item is found
  arfile.splice(index, 1); // 2nd parameter means remove one item only
}
if (indexlff > -1) { // only splice array when item is found
  lff.splice(indexlff, 1); // 2nd parameter means remove one item only
}
  startapp();
  savefile();
  fs.writeFileSync( pathname+"/listfile.json", JSON.stringify(lff));
}catch(e)  {
    // Failed with Error
    alert(e)
};
  }
}
 
}

}
function makefolder(){
  if(!localStorage.getItem('active')){
  alert("Use the premium version");
}else{
  if(pathtype=="home"){
alert("Try On A Project Or Folder");
  }else{
  const homedir = require('os').homedir();
  var pathsave=homedir+"/FileyTale/"+pathname.split("/").pop();
  if (!fs.existsSync(pathsave)){
            fs.mkdirSync(pathsave, { recursive: true });            
           }
           var newlist = arfile.filter(obj => obj.type !="web");
           var iconlist = arfile.map(obj => obj.icon);
           newlist = newlist.map(obj => obj.filepath);
           newlist=newlist.filter((value, index, array) => array.indexOf(value) === index);           
         var newlff=[];
           
          
           var newfile=arfile;
            for(var i=0;i<newfile.length;i++){
            try{
              if(newfile[i]["icon"]){
            newfile[i]["icon"]=pathsave+"/icon/"+newfile[i]["icon"].split("/").pop();
          }
            newfile[i]["filepath"]=pathsave+"/"+newfile[i]["filepath"].split("/").pop();
          }catch(e){alert(e)};
           }
           var objsav={};
objsav["file"]=newfile;
objsav["pagesort"]=pagesort;
objsav["pagename"]=pagenamelst;
          
           for(var i=0;i<newlist.length;i++){
            try{
            if(!fs.lstatSync(newlist[i]).isDirectory() ){
              if(fs.existsSync(newlist[i])){
                try{
                require('fs').promises.copyFile(newlist[i], pathsave+"/"+newlist[i].split("/").pop());
              }catch(e){}
          }
          }else{
            if(fs.existsSync(newlist[i])){
          
            copyDir(newlist[i], pathsave+"/"+newlist[i].split("/").pop()+"/");
          
          }
          
          }
        }catch(e){}
           }
         var icle=0;
           if (!fs.existsSync(pathsave+"/icon")){
            fs.mkdirSync(pathsave+"/icon", { recursive: true });            
           }
           iconlist=[...new Set(iconlist)]
           for(var i=0;i<iconlist.length;i++){
            try{
              if(fs.existsSync(iconlist[i])){
                
                try{
                  require('fs').promises.copyFile(iconlist[i], pathsave+"/icon/"+iconlist[i].split("/").pop());
                  icle++;

                }catch(e){} 
          }
            }catch(e){alert(e)}}
            if(pathtype=="folder"){
              
            for(var i=0;i<lff.length;i++){
            try{
          
            newlff.push(pathsave+"/"+lff[i].split("/").pop());
          }catch(e){alert(e)};
           }
            }
           document.getElementById("lload").style.display="block";
           document.getElementById("loading").style.display="flex";
           document.getElementById("newitemin").style.display="none";
           document.getElementById("editupl").style.display="none";
           copyDir(pathname, pathsave).then(() => {

            const myInterval =setInterval(function () {
            try {
              const files = fs.readdirSync(pathsave);
              const files2 = fs.readdirSync(pathsave+"/icon");
              // alert(files.length +"s d"+files2.length)
              // alert(~~newlist.length +"sd d"+~~icle)
            if (files.length==~~newlist.length &&files2.length==~~icle){
             
             
                if(pathtype=="folder"){
                  fs.writeFileSync( pathsave+"/arfile.json", JSON.stringify(objsav)); 
                  
                  if(fs.existsSync(pathsave+"/arfile.json")){
                    if(fs.existsSync(pathsave+"/listfile.json")){
                    fs.unlink(pathsave+"/listfile.json", (err) => {
                      if(!fs.existsSync(pathsave+"/listfile.json")){
                        // fs.writeFileSync( pathsave+"/listfile.json", JSON.stringify(newlff));
  // alert(JSON.stringify(newlff))
  
  alert("success");
clearInterval(myInterval);
newlist=[];
dissap();
startapp(); 
}
                    });
                  }

                  }
                  
                  
                }
                else{
                  fs.writeFileSync( pathsave+"/arfile.json", JSON.stringify(objsav)); 
                  if(fs.existsSync(pathsave+"/arfile.json")){
    alert("success");
    clearInterval(myInterval);
    newlist=[];
  dissap();
   startapp();
  }}
  
}}catch(e){}
           }, 1000);
});
           
          }
        }
}

function properties(){
  var paths=eventrgt.target.name;
  var msg;
  if(paths["filepath"].includes('http')){
    msg =paths["type"]+"&"+paths["filename"]+"&"+paths["filepath"];
  }
  else{
  if(fs.lstatSync(paths["filepath"]).isFile() ){
    msg =paths["type"]+"&"+paths["filename"]+"&"+paths["filepath"]+"&"+getFilesizeInBytes(paths['filepath']);
  }else if(fs.lstatSync(paths["filepath"]).isDirectory() ){
    
    msg =paths["type"]+"&"+paths["filename"]+"&"+paths["filepath"]+"&"+abbreviateNumber(getDirSize(paths['filepath']));
  }}
  
  
  
 let win= window.open("propertiespage.html","popup",'width=600,height=600');
 win['prop']=msg;

}

function allowDrop(event) {
  event.preventDefault();
  return;
}
const getDirSize = (dirPath) => {
  let size = 0;
  const files = fs.readdirSync(dirPath);

  for (let i = 0; i < files.length; i++) {
    const filePath = path.join(dirPath, files[i]);
    const stats = fs.statSync(filePath);

    if (stats.isFile()) {
      size += stats.size;
    } else if (stats.isDirectory()) {
      size += getDirSize(filePath);
    }
  }

  return size;
};
function splitLastOccurrence(str, substring) {
  const lastIndex = str.lastIndexOf(substring);

  let before = '';
  let after = '';

  if (lastIndex !== -1) {
    before = str.slice(0, lastIndex);
    after = str.slice(lastIndex + 1);
  }
  else{
    after="False";
  }
  return after;
}
function abbreviateNumber(number){
  SI_SYMBOL = ["B", "KB", "MB", "GB", "TB", "PB", "EB"];
// what tier? (determines SI symbol)
var tier = Math.log10(Math.abs(number)) / 3 | 0;

// if zero, we don't need a suffix
// if(tier == 0) return number;

// get suffix and determine scale
var suffix = SI_SYMBOL[tier];
var scale = Math.pow(10, tier * 3);

// scale the number
var scaled = number / scale;

// format number and add suffix
return scaled.toFixed(1) + suffix;
}
function abbreviatereverse(number,sz){
  SI_SYMBOL = ["B", "KB", "MB", "GB", "TB", "PB", "EB"];
// what tier? (determines SI symbol)
var tier = SI_SYMBOL.indexOf(sz.toUpperCase());

// if zero, we don't need a suffix
// if(tier == 0) return number;

// get suffix and determine scale
var suffix = SI_SYMBOL[tier];
var scale = Math.pow(10, tier * 3);

// scale the number
var scaled = number / scale;

// format number and add suffix
return scaled.toFixed(1) ;
}
function srch() {var input, filter, table, tr, td, i, txtValue;
  input = document.getElementById("searcttxt");
  filter = input.value.toUpperCase();
  var result=arfile;
  // if(pagi.checked==true){
  if(keywrd.checked==true){
    if(filter ==""){keywordlist.innerHTML="";
    mainplace.innerHTML="";
    classmap.innerHTML="";
            startapp();}
  //   else{src();li = document.getElementsByClassName("grid-item");dv = document.getElementsByClassName("difr");for (i = 0; i < l.length; i++) {td = li[i];if (td) {txtValue = td.contentWindow.document.getElementById('bdy').textContent || td.contentWindow.document.getElementById('bdy').innerText;if (txtValue.toUpperCase().indexOf(filter) > -1) {li[i].style.display = "";dv[i].style.display = "";} else {li[i].style.display = "none";dv[i].style.display = "none";}}}}}
    else{
      // keywordlist.innerHTML="";
      
      
      dv = document.getElementsByClassName("likeyword");
      li = document.getElementsByClassName("divpar");
      
      
      for (i = 0; i <result.length; i++) {td = dv[i];if (td) {
        txtValue = dv[i].textContent || dv[i].innerText ;if (txtValue.toUpperCase().indexOf(filter) > -1) {

      // li[i].style.display = "";
      
      dv[i].style.display = "";
      
      // dv[i].style.background = "white";
    } else {
      // li[i].style.display = "none";
      dv[i].style.display = "none";
      // dv[i].style.background = "white";
    }}}
    }
  }else{
    if(filter ==""){keywordlist.innerHTML="";
    mainplace.innerHTML="";
    classmap.innerHTML="";startapp();}
  //   else{src();li = document.getElementsByClassName("grid-item");dv = document.getElementsByClassName("difr");for (i = 0; i < l.length; i++) {td = li[i];if (td) {txtValue = td.contentWindow.document.getElementById('bdy').textContent || td.contentWindow.document.getElementById('bdy').innerText;if (txtValue.toUpperCase().indexOf(filter) > -1) {li[i].style.display = "";dv[i].style.display = "";} else {li[i].style.display = "none";dv[i].style.display = "none";}}}}}
    else{
      mainplace.innerHTML="";
            classmap.innerHTML="";
      src();
      
      dv = document.getElementsByClassName("divfile");
      li = document.getElementsByClassName("divpar");
      
  
      for (i = 0; i <result.length; i++) {td = dv[i];if (td) {
        txtValue = dv[i].textContent || dv[i].innerText ;if (txtValue.toUpperCase().indexOf(filter) > -1) {
      // li[i].style.display = "";
      
      dv[i].style.display = "";
      
      // dv[i].style.background = "white";
    } else {
      // li[i].style.display = "none";
      dv[i].style.display = "none";
      // dv[i].style.background = "white";
    }}}
    }
  }
  }
  function srchpage() {var  input,filter, table, tr, td, i, txtValue;
  input=document.getElementById("searchpg");
  filter = input.value.toUpperCase();
  var result=pagenamelst;
  // if(pagi.checked==true){
  
    if(filter ==""){
      pglst.innerHTML="";
    
    var ul=document.createElement('ul');
  pglst.innerHTML="";
  for(var i=0;i<pagenamelst.length;i++){
    var li=document.createElement('li');
    li.innerHTML=pagenamelst[i];
    li.className="pagenmlst";
    li.addEventListener('click', function (e) { 
      var button = e.target.innerHTML;
      
      curpage=pagenamelst.indexOf(button)+1;
      pagetype=pagesort[curpage-1] ;
      
      startapp();
      
    });
    ul.appendChild(li);
  }
  pglst.appendChild(ul);
            }
  //   else{src();li = document.getElementsByClassName("grid-item");dv = document.getElementsByClassName("difr");for (i = 0; i < l.length; i++) {td = li[i];if (td) {txtValue = td.contentWindow.document.getElementById('bdy').textContent || td.contentWindow.document.getElementById('bdy').innerText;if (txtValue.toUpperCase().indexOf(filter) > -1) {li[i].style.display = "";dv[i].style.display = "";} else {li[i].style.display = "none";dv[i].style.display = "none";}}}}}
    else{
      // keywordlist.innerHTML="";
      
      
      dv = document.getElementsByClassName("pagenmlst");
      li = document.getElementsByClassName("divpar");
      
      
      for (i = 0; i <result.length; i++) {td = dv[i];if (td) {
        txtValue = dv[i].textContent || dv[i].innerHTML ;if (txtValue.toUpperCase().indexOf(filter) > -1) {

      // li[i].style.display = "";
      
      dv[i].style.display = "";
      
      // dv[i].style.background = "white";
    } else {
      // li[i].style.display = "none";
      dv[i].style.display = "none";
      // dv[i].style.background = "white";
    }}}
    }
 
  }
function refresh(){location.reload(); }
function opennewwindow(){
//   if(!localStorage.getItem('active')){
//   alert("Use the premium version");
// }else{
  let win= window.open("tubox.html","",'width=1000,height=1000');
// }
}
var classfile=[];

startapp();
function src(){
  mainplace.innerHTML="";
            classmap.innerHTML="";
            mainplace.style.overflowY="overlay";
  var result=arfile;
  let resultf = result.map(a => a.ids);
  
  for(var i=0;i<arfile.length;i++){
    
    var dve=document.createElement('div');
 
  

// // Create a new text node:
    
// var filep=result.filter((e) => e.ids == ~~resultf[i]);
var filep=arfile[i];
// alert(JSON.stringify(filep)) 

          var img=document.createElement('div');
          var label=document.createElement('label');
          var icon=document.createElement('div');
          var dvtp=document.createElement('div');
          var dvtb=document.createElement('div');
          var lbltb=document.createElement('label');
          icon.className="iconimg";
          dvtp.className="dvtp";
          dvtb.className="dvtb";
          lbltb.className="lbltb";
          dve.id=filep['filepath'];            
          img.id=filep['filepath'];
          label.id=filep['filepath'];
          dvtp.id=filep['filepath'];
          icon.id=filep['filepath'];
          dvtb.id=filep['filepath'];
          lbltb.id=filep['filepath'];
          dve.className="divfile";
          dve.name=filep;
          img.name=filep;
          label.name=filep;
          dvtp.name=filep;
          icon.name=filep;
          dvtb.name=filep;
          lbltb.name=filep;
          img.className="imgicon";
          label.className="txtfile";
         
          if(filep['type']=="web"){
            lbltb.innerHTML="web";
          }
          if(filep['type']=="folder"){
            lbltb.innerHTML="folder";
          }
          if(filep['type']=="file"){
            if(splitLastOccurrence(filep['filepath'].split("/").pop(),".") !=filep['filepath'] && splitLastOccurrence(filep['filepath'].split("/").pop(),".") !="False"){
            lbltb.innerHTML=splitLastOccurrence(filep['filepath'].split("/").pop(),".");
          }
          }
          
          icon.style.borderColor=filep['background'];  
          // icon.innerHTML=iconstyle(filep['type'],filep['filepath']);
          // dvtp.appendChild(icon)
          if(preview.checked==true){
            if(filep['type']=="file"){
              var ext=splitLastOccurrence(filep['filepath'].split("/").pop(),".");
              if(ext=="jpg"||ext=="jpeg"||ext=="png"||ext=="gif"||ext=="ico"||ext=="bmp"){
          dvtp.style.backgroundImage="url('file:///"+filep['filepath'].replaceAll('/', '/')+"')";
          
          dvtp.style.backgroundSize="contain";
          dvtp.style.backgroundRepeat="no-repeat";
          dvtp.style.backgroundPosition="center center"
            }        
    else{
     
      // alert(JSON.stringify(exten))
      try{
      // alert(JSON.stringify(exten[ext]["icon"]))
      dvtp.style.backgroundImage="url('file:///"+exten[ext]["icon"].replaceAll('/', '/').replaceAll('16x16', '48x48@2x')+"')";
          
          dvtp.style.backgroundSize="45px 45px";
          dvtp.style.backgroundRepeat="no-repeat";
          dvtp.style.backgroundPosition="center 15px"
        
    }catch(e){
      // alert(e)
      if(!filep['icon']||filep['icon']==""){
            icon.style.borderColor=filep['background'];  
          icon.innerHTML=iconstyle(filep['type'],filep['filepath']);
          dvtp.appendChild(icon)
        }
        else{
          dvtp.style.backgroundImage="url('file:///"+filep['icon'].replaceAll('/', '/').replaceAll('16x16', '48x48@2x')+"')";
          
          dvtp.style.backgroundSize="45px 45px";
          dvtp.style.backgroundRepeat="no-repeat";
          dvtp.style.backgroundPosition="center 15px"
        }
    }
    } 
            }
            else{
              icon.style.borderColor=filep['background'];  
          icon.innerHTML=iconstyle(filep['type'],filep['filepath']);
          dvtp.appendChild(icon)
            }
            
          }else{
            if(!filep['icon']||filep['icon']==""){
            icon.style.borderColor=filep['background'];  
          icon.innerHTML=iconstyle(filep['type'],filep['filepath']);
          dvtp.appendChild(icon)
        }
        else{
          dvtp.style.backgroundImage="url('file:///"+filep['icon'].replaceAll('/', '/').replaceAll('16x16', '48x48@2x')+"')";
          
          dvtp.style.backgroundSize="45px 45px";
          dvtp.style.backgroundRepeat="no-repeat";
          dvtp.style.backgroundPosition="center 15px"
        }
          }
          dvtb.appendChild(lbltb)
          img.appendChild(dvtp)
          img.appendChild(dvtb)
          label.innerHTML=filep['filename'];
          dve.draggable=true;
          img.style.borderColor=filep['background'];  
          img.style.borderStyle=filep['style'];
          dve.title=filep['filename']
           
            dve.appendChild(img);
            dve.appendChild(label); 
            dve.addEventListener('dblclick', () => { 
                var button = event.target.id;
try{
                if(button.includes("http")){
                  window.open(button,'popup','width=600,height=600');  
                }
                else if(fs.lstatSync(button).isDirectory() ){
                  mainplace.innerHTML="";
            classmap.innerHTML="";
              arfile=[];
              classfile=[];
              curpage=1;
              
              pagenamelst=["1"]
              pagesort=['normal'];
              if(pathcount==(pathsort.length)){
              foldsort.push("folder");
              pathsort.push(button);
            }
            else{
              foldsort[pathcount]="folder";
              pathsort[pathcount]=button;
              var a = pathcount+1;
var b = pathsort.length;

pathsort.splice(a, (b - a) + 1);
foldsort.splice(a, (b - a) + 1);
            }
            pathcount++;
              pathtype ="folder";
              pathname =button;
                startapp();
                }
                else{
                  window.open("file:///"+button,'popup','width=600,height=600');
                }
                }catch(e){alert(e)}
        
            });
            mainplace.appendChild(dve);
 
          
  }
}
var formData = new FormData();


async function folderstart(){
  
  //   var co=0;
  lff=[];
  // var classarfile=[];
  // var result=[];
  var testFolder=pathname;
  // alert(testFolder);
  
  // alert(fnu(testFolder));
  await f(testFolder+"/classarfile.json") .then((d) => classfile=d)
  .catch((err) => classfile=[]);
  await ft(testFolder+"/fileytalenote.txt") .then((d) => txtar.value=d)
          .catch((err) => txtar.value="");
  if (fs.existsSync(testFolder+"/arfile.json") && fs.existsSync(testFolder+"/listfile.json")){
    
    await  f(testFolder+"/listfile.json") .then((d) => {
      if (d[0].indexOf("/") == -1) { // windows
 
        for(var i=0;i<d.length;i++){
 lff.push(pathname+"/"+getFileDirectory(d[i]));
}
  } 
  else { // unix
    lff=d;
 
  }   
    
      
  })
  .catch((err) => {arfile=[];pagesort=["normal"];pagenamelst=["1"];});
    await  f(testFolder+"/arfile.json") .then((d) => {fildet=d; 
    arfile=fildet["file"];
    var ar1=arfile.filter((e) => e.type == "file" ||e.type == "folder")
    
    var ar2 = ar1.map(a => a.filepath);
    
    for(var a=0;a<ar2.length;a++){
      if (ar2[a].indexOf("/") == -1) {
        var txt =pathname.split('/').pop();
  if(ar2[a].includes(txt)){

    var index=arfile.indexOf(ar1[a]);
        arfile[index]['filepath']=pathname+"/"+getFileDirectory(ar2[a]);
        
  }  
      }else{
      
      }
    }
        pagesort=fildet["pagesort"];pagetype=pagesort[0]; 
        pagenamelst=[];
        if(fildet["pagename"]){
          pagenamelst=fildet["pagename"];
        }
        else{
          for(var i=0;i<pagesort.length;i++){
            pagenamelst.push((i+1).toString());
          }
        }
        
  })
  .catch((err) => {arfile=[];pagesort=["normal"];pagenamelst=["1"];});
  await fnu(testFolder).then((d) =>{ 
    // alert(d);
   
    d=JSON.parse(d);
    var p=[];
    for(var i=0;i<d.length;i++){
  var obj={};
  // var id=i;
              // obj['filename']=d[i];
              
              p.push(testFolder+"/"+d[i]);
            }
            
  fs.writeFileSync( testFolder+"/listfile.json", JSON.stringify(p));
  
    var newArray = lff.concat(p);
  
    var larfile = newArray.filter((v, i) => newArray.indexOf(v) === newArray.lastIndexOf(v));
         var sc=p.concat(larfile);
            lff=p;
            
        larfile = sc.filter((item, index, arr) => {
  return arr.indexOf(item) !== arr.lastIndexOf(item) && index === arr.indexOf(item);
});


    curpage=pagesort.length;
    var arfile3=arfile.filter((e) => !e.ids && e.ids !=0 && e.class=="");
    let result3 = arfile3.map(a => a.filepath);
    larfile.push(...result3)
    for(var p=0;p<result3.length;p++){
    
      const index = arfile.indexOf(arfile3[p]);
      
  if (index > -1) { // only splice array when item is found
    arfile.splice(index, 1); // 2nd parameter means remove one item only
  }
    }
   
    var arfile2=arfile.filter((e) => e.page == pagesort.length );
    let result2 = arfile2.map(a => a.ids);
    var idex=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39]
    var idlst=result2.concat(idex);
    idlst = idlst.filter((v, i) => idlst.indexOf(v) === idlst.lastIndexOf(v));
    if(idlst.length==0){
      curpage++;
      pagesort.push('normal');
                pagenamelst.push(curpage.toString());
    }
    
    var id=0;
    for(var i=0;i<larfile.length;i++){
  var obj={};
  var flm=larfile[i].split('/').pop()
  
              obj['filename']=flm;
              obj['filepath']=testFolder+"/"+flm;
              obj['background']="transparent";
              obj['style']="solid";
              // obj['icon']=;
              obj['keywords']="";
              // alert(idlst[0])
              try{
                if(idlst.length>0){
              obj['ids']=idlst[0];
              idlst.splice(0, 1);
            }
            else{
              obj['ids']=id;
            }
            }
            catch(e){
              obj['ids']=id;
              
            }
              obj['type']="file";
              if((fs.lstatSync(testFolder+"/"+flm).isDirectory() )){
                obj['type']="folder";
              }
              obj['class']="";
              obj['page']=curpage;
              
              
              if(id==39){
                curpage++;
                pagesort.push('normal');
                pagenamelst.push(curpage.toString());
                id=0;
                obj['ids']=id;
                obj['page']=curpage;
                arfile.push(obj);
                
              }else{
                arfile.push(obj);
                
              }
              id++;
            }
           
          
          
    
  });
  savefile();
  }
  else{
  // f(testFolder+"/arfile.json") .then((d) => fildet=d)
  // .catch((err) => alert(err.toString()+"spd")
  await fnu(testFolder).then((d) =>{ 
    // alert(d);
   
    d=JSON.parse(d);
    // alert(d+"l");
    var p=[];
    for(var i=0;i<d.length;i++){
  var obj={};
  // var id=i;
              // obj['filename']=d[i];
              
              p.push(testFolder+"/"+d[i]);
            }
            lff=p;
  fs.writeFileSync( testFolder+"/listfile.json", JSON.stringify(p));
  
    var id=0;
    for(var i=0;i<d.length;i++){
  var obj={};
  
              obj['filename']=d[i];
              obj['filepath']=testFolder+"/"+d[i];
              obj['background']="transparent";
              obj['style']="solid";
              // obj['icon']=;
              obj['keywords']="";
              
              obj['ids']=id;
              obj['type']="file";
              if((fs.lstatSync(testFolder+"/"+d[i]).isDirectory())){
                obj['type']="folder";
              }
             
              obj['ids']=id;
              obj['class']="";
              obj['page']=curpage;
              arfile.push(obj)
              id++;
              if(id==39){
                curpage++;
                pagesort.push('normal');
                id=0
              }
            }
            
            pagenamelst=[];
            for(var i=0;i<pagesort.length;i++){
            pagenamelst.push((i+1).toString());
          }
  
  })
              //  );
  }
  
  }
  window.onbeforeunload = function(e) {
    // Do something
    
    return null; // This prevents the confirmation box from appearing
};

function startapp(){
  mainplace.innerHTML="";
  classmap.innerHTML="";
  keywordlist.innerHTML="";
  dname.value="";
  dtype.innerHTML="";
  slcol.innerHTML="";
  slclass.innerHTML="";
  editclass=false;
  imgl={};
  imcoun={};
  

  
//   if(pathtype=="folder"){
//     if(pathname==lastpath ){
//       if(pagetype=="class"){
//     makeiconcls();
//   }
//   else if(pagetype=="item"){
//     makeiconitem();    
//   }
//   else{
//   makeicon();  
// }
// pgtp.innerHTML=curpage+"/"+pagesort.length;
// pgnm.value=pagenamelst[curpage-1];

//     }else{
//       closemenu();
// folderstart().then(() => {lastpath=pathname;
//   var extar=arfile.map(a => a.filepath);
//   var ext=[];
//   // alert(JSON.stringify(extar))
//   extar.forEach(filePath => {
//     // alert(`${filePath}`.split("/").pop())  
// // try{
  
//     if(splitLastOccurrence(`${filePath}`.split("/").pop(),".") !=`${filePath}` && splitLastOccurrence(`${filePath}`.split("/").pop(),".") !="False"){
// ext.push(splitLastOccurrence(`${filePath}`.split("/").pop(),"."))
  
// }

//     // alert(ext)}catch(e){alert(e)}
//   });
//   var ext2= [...new Set(ext)]
//   var keys = Object.keys(exten);
//   var newArray = keys.concat(ext2);
//   var larfile = ext2.filter(item => !keys.includes(item));
//   // alert(JSON.stringify(ext2))
//   // alert(JSON.stringify(keys))
//   // alert(JSON.stringify(larfile))
  
//   if(larfile.length!=0){

//     if(fs.existsSync("./mime-db.json")){
//     fs.readFile("./mime-db.json", (err, data)=> {
//       var d=JSON.parse(data);
//       // alert(JSON.stringify(d))
//       try{
//         var obj2={};
//         var ct=0;
//       larfile.forEach(filePath => {
//         ct++;
//         try{
      
//       exten[filePath]=d[filePath];
//       if(d[filePath]["mime"]){
//       extlas.push(d[filePath]["mime"])
//     }
   
//     // alert(JSON.stringify(obj2))
//       if(ct==larfile.length){
//         savecache();
//       }
//     }catch(e){}
   
//       });
//     }catch(e){alert(e)}
//     });
//   }
//   }
//   // if(!localStorage.getItem("mime")&&!localStorage.getItem("mimeicon")){
//   // if(fs.existsSync("./mime-db.json")){
//   //   fs.readFile("./mime-db.json", (err, data)=> {
//   //     var d=JSON.parse(data);
//   //     // alert(JSON.stringify(d))
//   //     try{
//   //       var obj2={};
//   //       var ct=0;
//   //     ext2.forEach(filePath => {
//   //       ct++;
//   //       try{
//   //     obj2[filePath]=d[filePath];
//   //     exten[filePath]=d[filePath];
//   //     if(d[filePath]["mime"]){
//   //     extlas.push(d[filePath]["mime"])
//   //   }
//   //     // alert(JSON.stringify(obj2))
//   //   }catch(e){}
   
//   //     });
//   //   }catch(e){alert(e)}
//   //   });
//   // }
//   // }
  
  
//   if(pagetype=="class"){
//     makeiconcls();  
//   }
//   else if(pagetype=="item"){
//     makeiconitem();   
//   }
//   else{
//   makeicon(); 
// }
// pgtp.innerHTML=curpage+"/"+pagesort.length; 
// pgnm.value=pagenamelst[curpage-1];

// });
// }
//   }else if(pathtype=="home"){
//     if(pathname==lastpath ){
//       makeiconhome();      
//       pgtp.innerHTML=curpage+"/"+pagesort.length;
//       pgnm.value=pagenamelst[curpage-1];
      
//     }else{
//       closemenu();
//     loaddata().then(() => {
//       //alert(JSON.stringify(arfile))
//       makeiconhome();
//       pathname="Home";
//       lastpath=pathname;  
//       pgtp.innerHTML=curpage+"/"+pagesort.length;  
//       pgnm.value=pagenamelst[curpage-1];  
//      });
//     }
    
    
//   }
//   else{
//     if(pathname==lastpath ){
//       if(pagetype=="class"){
//     makeiconcls();    
//   }
//   else if(pagetype=="item"){
//     makeiconitem();    
//   }
//   else{
//   makeicon();  
// }
// pgtp.innerHTML=curpage+"/"+pagesort.length;
// pgnm.value=pagenamelst[curpage-1];

//     }else{
//       closemenu();
//     loaddata().then(() => {
      
//       lastpath=pathname;
//       var extar=arfile.map(a => a.filepath);
//   var ext=[];
//   // alert(JSON.stringify(extar))
//   extar.forEach(filePath => {
//     // alert(`${filePath}`.split("/").pop())  
// // try{
  
//     if(splitLastOccurrence(`${filePath}`.split("/").pop(),".") !=`${filePath}` && splitLastOccurrence(`${filePath}`.split("/").pop(),".") !="False"){
// ext.push(splitLastOccurrence(`${filePath}`.split("/").pop(),"."))
  
// }
//     // alert(ext)}catch(e){alert(e)}
//   });
//   var ext2= [...new Set(ext)]
//   var keys = Object.keys(exten);
//   var newArray = keys.concat(ext2);
//   var larfile = ext2.filter(item => !keys.includes(item));
//   // alert(JSON.stringify(ext2))
//   // alert(JSON.stringify(keys))
//   // alert(JSON.stringify(larfile))
  
//   if(larfile.length!=0){

  
//   }
//       if(pagetype=="class"){
//     makeiconcls();    
//   }
//   else if(pagetype=="item"){
//     makeiconitem();    
//   }
//   else{
try{
  makeicon();  
  }catch(e){alert(e)}
// } 
pgtp.innerHTML=curpage+"/"+pagesort.length;
pgnm.value=pagenamelst[curpage-1];


// });
//     }
  // }
  
  pgtp.innerHTML=curpage+"/"+pagesort.length;
  pathline.value=pathname;
  
  
// alert(JSON.stringify(classfile))
// alert(pagetype)
// alert(totalpage)

}
function getFilesizeInBytes(filename) {
    var stats = fs.statSync(filename);
    var fileSizeInBytes = stats.size;
    return abbreviateNumber(fileSizeInBytes);
}
function backgdiv(){
  var divpar =document.getElementsByClassName('divpar');
for(var w=0;w<divpar.length;w++){
  divpar[w].style.background="rgba( 255, 255, 255, 0.25 )"
}
}
function makeiconitem(){
  document.getElementById('clss').style.display="none";
  document.getElementById('keyw').style.display="none";
  itmpg=true;
  document.getElementById('main').style.gridColumn="1/7";
  mainplace.style.gridTemplateColumns="repeat(9, 120px)";
  mainplace.style.gridAutoRows="110px";
  mainplace.style.gap="7px 25px";
  mainplace.style.removeProperty('grid-template-rows');
  mainplace.style.removeProperty('overflow-y');
  let colorlist = arfile.map(a => a.background);
  claspage=false;
  var arfile2=arfile.filter((e) => e.page == curpage);
 
 var arfile3=arfile2.filter((e) => e.class == "");
 let result = arfile2.map(a => a.ids);
 let result2 = arfile3.map(a => a.ids);
var tlitem=45;

var itmc=tlitem;

for(var p=0;p<itmc;p++){
var dv=document.createElement('div');
dv.className="divpar";
dv.id=p;
dv.style.background="transparent"

dv.addEventListener('dragover',function (event)  {  allowDrop(event)}, false);
                      dv.addEventListener('drop',function (event)  { event.preventDefault();
                        const idx = event.dataTransfer.getData("data");
                        const data = event.dataTransfer.getData("Text");
                        const indx = event.dataTransfer.getData("ids");
                        const curp = event.dataTransfer.getData("curp");
                        const copybox = event.dataTransfer.getData("copybox");
                        const ardata = event.dataTransfer.getData("ardata");
                        //alert(JSON.stringify(arfile[indx]))
                        
                        // alert(data)
if(copybox=="true")  {
  
  if (event.currentTarget.hasChildNodes()) {
  // It has at least one
  var co=0;
          var sts;
          try{
              while(mainplace.children[co].childElementCount > 0 ){
                
                co++;  
     
              }
            }catch(e){
              alert('Page is Full');
              sts="Page is Full";
            }if(sts!="Page is Full"){
  var obj=JSON.parse(ardata);
  var obj2={};
  
  obj2['filename']=obj['filename'];
  obj2['filepath']=obj['filepath'];
  obj2['background']=obj['background'];
  obj2['style']=obj['style'];
  obj2['keywords']=obj['keywords'];
  obj2["ids"]=co;
  obj2["class"]="";
  obj2["page"]=curpage;  
  obj2['type']=obj['type'];
  // dvp.name=obj2; 
  arfile.push(obj2);
  // alert(JSON.stringify(arfile))
  
  
  startapp();
  savefile();
            }
}else{

  var obj=JSON.parse(ardata);
  var obj2={};
  
  obj2['filename']=obj['filename'];
  obj2['filepath']=obj['filepath'];
  obj2['background']=obj['background'];
  obj2['style']=obj['style'];
  obj2['keywords']=obj['keywords'];
  obj2["ids"]=~~event.target.id;
  obj2["class"]="";
  obj2["page"]=curpage;  
  obj2['type']=obj['type'];


  // dvp.name=obj2; 
  arfile.push(obj2);
 
startapp();
savefile();
 
}
} else{
  if (event.currentTarget.hasChildNodes()) {
  // It has at least one
  var arfile2=arfile.filter((e) => e.page == curpage);
  let obj = arfile2.find(x => x.filepath === event.target.id);
let index = arfile.indexOf(event.target.name);
var idne=arfile[index]['ids'];
 
  arfile[index]["ids"]=~~idx;
  arfile[indx]["ids"]=idne;
  arfile[index]["page"]=~~curp;
  arfile[indx]["page"]=curpage;
  // alert(JSON.stringify(arfile))
  
  
  startapp();
  savefile();
 
}else{

  arfile[indx]["ids"]=~~event.target.id;
  arfile[indx]["page"]=curpage;
  if(arfile[indx]["class"] !=""){
    let decr = classfile.find(x => x.classname === arfile[indx]["class"]);
    let indexdec = classfile.indexOf(decr);
    classfile[indexdec]['fil']=~~classfile[indexdec]['fil']-1;
    
classfile[indexdec]['list'] = classfile[indexdec]['list'].filter(e => e !== ~~indx)
// alert(JSON.stringify(classfile[indexdec]['list']))
    arfile[indx]["class"]="";
  }
 
startapp();
savefile();
 
}
}                     


}, false);

mainplace.appendChild(dv);



}
result2=result2.reverse();
// alert(JSON.stringify(result))

for(var i=0;i<result2.length;i++){
  
  
 


// // Create a new text node:

var filep=arfile3.filter((e) => e.ids == ~~result2[i]);
// alert(JSON.stringify(arfile3))
    // if(filep['class']==""){
      var dve=document.createElement('div');
          var img=document.createElement('div');
          var label=document.createElement('label');
          var icon=document.createElement('div');
          var dvtp=document.createElement('div');
          var dvtb=document.createElement('div');
          var lbltb=document.createElement('label');
          icon.className="iconimg";
          dvtp.className="dvtp";
          dvtb.className="dvtb";
          lbltb.className="lbltb";
          dve.id=filep[0]['filepath'];            
          img.id=filep[0]['filepath'];
          label.id=filep[0]['filepath'];
          dvtp.id=filep[0]['filepath'];
          icon.id=filep[0]['filepath'];
          dvtb.id=filep[0]['filepath'];
          lbltb.id=filep[0]['filepath'];
          dve.className="divfile";
          dve.name=filep[0];
          img.name=filep[0];
          label.name=filep[0];
          dvtp.name=filep[0];
          icon.name=filep[0];
          dvtb.name=filep[0];
          lbltb.name=filep[0];
          img.className="imgicon";
          label.className="txtfile";
         
          if(filep[0]['type']=="web"){
            lbltb.innerHTML="web";
          }
          if(filep[0]['type']=="folder"){
            lbltb.innerHTML="folder";
          }
          if(filep[0]['type']=="file"){
            if(splitLastOccurrence(filep[0]['filepath'].split("/").pop(),".") !=filep[0]['filepath'] && splitLastOccurrence(filep[0]['filepath'].split("/").pop(),".") !="False"){
            lbltb.innerHTML=splitLastOccurrence(filep[0]['filepath'].split("/").pop(),".");
          }
          }
          
          if(preview.checked==true){
            if(filep[0]['type']=="file"){
              var ext=splitLastOccurrence(filep[0]['filepath'].split("/").pop(),".");
              if(ext=="jpg"||ext=="jpeg"||ext=="png"||ext=="gif"||ext=="ico"||ext=="bmp"){
          dvtp.style.backgroundImage="url('file:///"+filep[0]['filepath'].replaceAll('/', '/')+"')";
          
          dvtp.style.backgroundSize="contain";
          dvtp.style.backgroundRepeat="no-repeat";
          dvtp.style.backgroundPosition="center center"
            }        
    else{
     
      // alert(JSON.stringify(exten))
      try{
      // alert(JSON.stringify(exten[ext]["icon"]))
      dvtp.style.backgroundImage="url('file:///"+exten[ext]["icon"].replaceAll('/', '/').replaceAll('16x16', '48x48@2x')+"')";
          
          dvtp.style.backgroundSize="45px 45px";
          dvtp.style.backgroundRepeat="no-repeat";
          dvtp.style.backgroundPosition="center 15px"
        
    }catch(e){
      // alert(e)
      if(!filep[0]['icon']||filep[0]['icon']==""){
            icon.style.borderColor=filep[0]['background'];  
          icon.innerHTML=iconstyle(filep[0]['type'],filep[0]['filepath']);
          dvtp.appendChild(icon)
        }
        else{
          dvtp.style.backgroundImage="url('file:///"+filep[0]['icon'].replaceAll('/', '/').replaceAll('16x16', '48x48@2x')+"')";
          
          dvtp.style.backgroundSize="45px 45px";
          dvtp.style.backgroundRepeat="no-repeat";
          dvtp.style.backgroundPosition="center 15px"
        }
    }
    } 
            }
            else{
              icon.style.borderColor=filep[0]['background'];  
          icon.innerHTML=iconstyle(filep[0]['type'],filep[0]['filepath']);
          dvtp.appendChild(icon)
            }
            
          }else{
            if(!filep[0]['icon']||filep[0]['icon']==""){
            icon.style.borderColor=filep[0]['background'];  
          icon.innerHTML=iconstyle(filep[0]['type'],filep[0]['filepath']);
          dvtp.appendChild(icon)
        }
        else{
          dvtp.style.backgroundImage="url('file:///"+filep[0]['icon'].replaceAll('/', '/').replaceAll('16x16', '48x48@2x')+"')";
          
          dvtp.style.backgroundSize="45px 45px";
          dvtp.style.backgroundRepeat="no-repeat";
          dvtp.style.backgroundPosition="center 15px"
        }
          }
          dvtb.appendChild(lbltb)
          img.appendChild(dvtp)
          img.appendChild(dvtb)
          label.innerHTML=filep[0]['filename'];
          dve.draggable=true;
          img.style.borderColor=filep[0]['background'];  
          img.style.borderStyle=filep[0]['style'];
          dve.title=filep[0]['filename']
          
            
            if(filep[0]['type']=="web"){
            

            dve.addEventListener('click', function (event)  {
              eventrgt=event;
              
            let obj = arfile.find(x => x.filepath === event.target.id);
let index = arfile.indexOf(event.target.name);
var dta=arfile[index];
//alert(JSON.stringify(dta))
            dname.value=dta['filename'];
            pathclick=event.target.id;
            
          });

            } else if(filep[0]['type']=="folder"){
              dve.addEventListener('click', function (event)  {
                eventrgt=event;
                
            let obj = arfile.find(x => x.filepath === event.target.id);
let index = arfile.indexOf(event.target.name);
var dta=arfile[index];
            dname.value=dta['filename'];
            try{
            dtype.innerHTML=abbreviateNumber(getDirSize(dta['filepath']))
          }catch(e){
            
          }
            pathclick=event.target.id;
          });
        
            }
           else if(filep[0]['type']=="file"){
            
            dve.addEventListener('click', function (event)  {
              eventrgt=event;
              
            let obj = arfile.find(x => x.filepath === event.target.id);
let index = arfile.indexOf(event.target.name);
var dta=arfile[index];
            dname.value=dta['filename'];
            try{
            dtype.innerHTML=getFilesizeInBytes(dta['filepath'])
          }catch(e){
            
          }
            pathclick=event.target.id;
          });

        }
          dve.addEventListener('dblclick', () => { 
                var button = event.target.id;
                try{
                if(button.includes("http")){
                  window.open(button,'popup','width=600,height=600');  
                }
                else if(fs.lstatSync(button).isDirectory() ){
                  mainplace.innerHTML="";
            classmap.innerHTML="";
              arfile=[];
              classfile=[];
              curpage=1;
              
              
              pagesort=['normal'];
              if(pathcount==(pathsort.length)){
              foldsort.push("folder");
              pathsort.push(button);
            }
            else{
              foldsort[pathcount]="folder";
              pathsort[pathcount]=button;
              var a = pathcount+1;
var b = pathsort.length;

pathsort.splice(a, (b - a) + 1);
foldsort.splice(a, (b - a) + 1);
            }
            pathcount++;
              pathtype ="folder";
              pathname =button;
                startapp();
                }
                else{
                  window.open("file:///"+button,'popup','width=600,height=600');
                }
              }catch(e){alert(e)}
        
            });
          dve.addEventListener('dragstart', function (event)  {
            event.dataTransfer.setData("Text", event.target.id);
            var arfile2=arfile.filter((e) => e.page == curpage);
            let obj = arfile2.find(x => x.filepath === event.target.id);
let index = arfile.indexOf(event.target.name);
var idne=arfile[index]['ids'];
event.dataTransfer.setData("data", idne);
event.dataTransfer.setData("ids", index);
event.dataTransfer.setData("curp", curpage);
event.dataTransfer.setData("arfile", JSON.stringify(arfile[index]));

          }, false); 
   
              
          dve.appendChild(img);
          dve.appendChild(label); 
          var ress=~~result2[i]
        
            mainplace.children[ress].appendChild(dve);
            colorlist =[...new Set(colorlist)];
for(var w=0;w<colorlist.length;w++){
var opt =document.createElement('OPTION');
opt.innerHTML=colorlist[w];
opt.style.backgroundColor=colorlist[w];
opt.value=colorlist[w];
slcol.appendChild(opt);
}  
}

// alert(JSON.stringify(classfile));
}
function makeiconcls(){
  document.getElementById('clss').style.display="none";
  document.getElementById('keyw').style.display="none";
  document.getElementById('main').style.gridColumn="1/7";
  itmpg=false;
  mainplace.style.gridTemplateColumns="repeat(5, 220px)";
  mainplace.style.gridTemplateRows="repeat(3, 200px)";
  mainplace.style.gap="40px";
  mainplace.style.removeProperty('overflow-y');
  claspage=true;
  let colorlist = arfile.map(a => a.background);
  let classff = classfile.map(a => a.page);
  var classarfile=classfile.filter((e) => e.page == curpage);
  var arfile2=arfile.filter((e) => e.page == curpage);
// var classarfile=[];
var tlitem=40;
try{

var clf=10;
  var ix=1;
var ix2=1;

for(var o=0;o<clf;o++){
var fild=document.createElement('FIELDSET');
var legn=document.createElement('legend');
var btnclass=document.createElement('button');
legn.innerHTML=classarfile[o]["classname"];
btnclass.innerHTML=classarfile[o]["classname"];
btnclass.style.backgroundColor=classarfile[o]["background"];
var dvm=document.createElement('div');
dvm.className="classfile2";
btnclass.className="collapsible";
btnclass.name=classfile.indexOf(classarfile[o]);
dvm.name=classarfile[o]["classname"];

dvm.style.background="white";
fild.style.padding="0";
btnclass.addEventListener("click", function() {
    this.classList.toggle("active");
    var content = this.nextElementSibling;
    if (content.style.display === "grid") {
      content.style.display = "none";
    } else {
      content.style.display = "grid";
    }
  });

var ssp =classarfile[o];
var list=arfile2.filter((e) => e.class == ssp['classname']);

// var list=lst.map(a => a.ids);
for(var a=0;a<list.length;a++){
  var dvq =document.createElement('div');
var img=document.createElement('div');
          var label=document.createElement('label');
          var icon=document.createElement('div');
          var dvtp=document.createElement('div');
          var dvtb=document.createElement('div');
          var lbltb=document.createElement('label');
          icon.className="iconimg";
          dvtp.className="dvtp";
          dvtb.className="dvtb";
          lbltb.className="lbltb";
          dvq.id=list[a]['filepath'];            
          img.id=list[a]['filepath'];
          label.id=list[a]['filepath'];
           dvtp.id=list[a]['filepath'];
          icon.id=list[a]['filepath'];
          dvtb.id=list[a]['filepath'];
          lbltb.id=list[a]['filepath'];
          dvq.className="divfileclass";
          img.className="imgiconclass";
          label.className="txtfile";
          dvq.name=list[a];
          img.name=list[a];
          label.name=list[a];
          dvtp.name=list[a];
          icon.name=list[a];
          dvtb.name=list[a];
          lbltb.name=list[a];
          if(list[a]['type']=="web"){
            lbltb.innerHTML="web";
          }
          if(list[a]['type']=="folder"){
            lbltb.innerHTML="folder";
          }
          if(list[a]['type']=="file"){
            if(splitLastOccurrence(list[a]['filepath'].split("/").pop(),".") !=list[a]['filepath'] && splitLastOccurrence(list[a]['filepath'].split("/").pop(),".") !="False"){
            lbltb.innerHTML=splitLastOccurrence(list[a]['filepath'].split("/").pop(),".");
          }
            
          }
          
          if(preview.checked==true){
            if(list[a]['type']=="file"){
              var ext=splitLastOccurrence(list[a]['filepath'].split("/").pop(),".");
              if(ext=="jpg"||ext=="jpeg"||ext=="png"||ext=="gif"||ext=="ico"||ext=="bmp"){
          dvtp.style.backgroundImage="url('file:///"+list[a]['filepath'].replaceAll('/', '/')+"')";
          
          dvtp.style.backgroundSize="contain";
          dvtp.style.backgroundRepeat="no-repeat";
          dvtp.style.backgroundPosition="center center"
            }        
    else{
     
      // alert(JSON.stringify(exten))
      try{
      // alert(JSON.stringify(exten[ext]["icon"]))
      dvtp.style.backgroundImage="url('file:///"+exten[ext]["icon"].replaceAll('/', '/').replaceAll('16x16', '32x32@2x')+"')";
          
          dvtp.style.backgroundSize="35px 35px";
          dvtp.style.backgroundRepeat="no-repeat";
          dvtp.style.backgroundPosition="center 15px"
        
    }catch(e){
      // alert(e)
      if(!list[a]['icon']||list[a]['icon']==""){
            icon.style.borderColor=list[a]['background'];  
          icon.innerHTML=iconstyle(list[a]['type'],list[a]['filepath']);
          dvtp.appendChild(icon)
        }
        else{
          dvtp.style.backgroundImage="url('file:///"+list[a]['icon'].replaceAll('/', '/')+"')";
          
          dvtp.style.backgroundSize="35px 35px";
          dvtp.style.backgroundRepeat="no-repeat";
          dvtp.style.backgroundPosition="center 15px"
        }
    }
    } 
            }
            else{
              icon.style.borderColor=list[a]['background'];  
          icon.innerHTML=iconstyle(list[a]['type'],list[a]['filepath']);
          dvtp.appendChild(icon)
            }
            
          }else{
            if(!list[a]['icon']||list[a]['icon']==""){
            icon.style.borderColor=list[a]['background'];  
          icon.innerHTML=iconstyle(list[a]['type'],list[a]['filepath']);
          dvtp.appendChild(icon)
        }
        else{
          dvtp.style.backgroundImage="url('file:///"+list[a]['icon'].replaceAll('/', '/')+"')";
          
          dvtp.style.backgroundSize="35px 35px";
          dvtp.style.backgroundRepeat="no-repeat";
          dvtp.style.backgroundPosition="center 15px"
        }
          }
          // dvtb.appendChild(lbltb)
          img.appendChild(dvtp)
          img.appendChild(dvtb)
          label.innerHTML=list[a]['filename'];
          dvq.draggable=true;
          img.style.borderColor=list[a]['background'];
          img.style.borderStyle=list[a]['style']; 
          dvq.title=list[a]['filename'];
          dvq.addEventListener('dragstart', function (event)  { 
            event.dataTransfer.setData("Text", event.target.id);
            // var arfile2=arfile.filter((e) => e.page == curpage);
            // let obj = arfile2.find(x => x.filepath === event.target.id);
let index = arfile.indexOf(event.target.name);
var idne=arfile[index]['ids'];
event.dataTransfer.setData("data", idne);
event.dataTransfer.setData("ids", index);
event.dataTransfer.setData("curp", curpage);

          }, false); 
 
          dvq.addEventListener('dblclick', () => { 
                var button = event.target.id;
                try{
                if(button.includes("http")){
                  window.open(button,'popup','width=600,height=600');  
                }
                else if(fs.lstatSync(button).isDirectory() ){
                  mainplace.innerHTML="";
            classmap.innerHTML="";
              arfile=[];
              classfile=[];
              curpage=1;
              
              
              pagesort=['normal'];
              if(pathcount==(pathsort.length)){
              foldsort.push("folder");
              pathsort.push(button);
            }
            else{
              foldsort[pathcount]="folder";
              pathsort[pathcount]=button;
              var a = pathcount+1;
var b = pathsort.length;

pathsort.splice(a, (b - a) + 1);
foldsort.splice(a, (b - a) + 1);
            }
            pathcount++;
              pathtype ="folder";
              pathname =button;
                startapp();
                }
                else{
                  window.open("file:///"+button,'popup','width=600,height=600');
                }
                
              }catch(e){alert(e)}
            }); 

            if(list[a]['type']=="web"){
            

            dvq.addEventListener('click', function (event)  {
              
              
            let obj = arfile.find(x => x.filepath === event.target.id);
let index = arfile.indexOf(event.target.name);
var dta=arfile[index];
//alert(JSON.stringify(dta))
            dname.value=dta['filename'];
            pathclick=event.target.id;
            
          });
            } else if(list[a]['type']=="folder"){
              dvq.addEventListener('click', function (event)  {
                
                
            let obj = arfile.find(x => x.filepath === event.target.id);
let index = arfile.indexOf(event.target.name);
var dta=arfile[index];
            dname.value=dta['filename'];
            try{
            dtype.innerHTML=abbreviateNumber(getDirSize(dta['filepath']))
          }catch(e){
            
          }
            pathclick=event.target.id;
          });      
            }
           else if(list[a]['type']=="file"){
            
            dvq.addEventListener('click', function (event)  {
              
              
            let obj = arfile.find(x => x.filepath === event.target.id);
let index = arfile.indexOf(event.target.name);
var dta=arfile[index];
            dname.value=dta['filename'];
            try{
            dtype.innerHTML=getFilesizeInBytes(dta['filepath'])
          }catch(e){

          }
            pathclick=event.target.id;
          });

        }   
          dvq.appendChild(img);
          dvq.appendChild(label); 
         
        
          dvm.appendChild(dvq);
}
// fild.style.width="100%";
// fild.style.float="none";
dvm.addEventListener('dragover',function (event)  {  allowDrop(event)}, false);
dvm.addEventListener('drop',function (event)  { event.preventDefault();
                        const idx = event.dataTransfer.getData("data");
                        const data = event.dataTransfer.getData("Text");
                        const indx = event.dataTransfer.getData("ids");
                        const curp = event.dataTransfer.getData("curp");
                        const copybox = event.dataTransfer.getData("copybox");
                        const ardata = event.dataTransfer.getData("ardata");
                        if(copybox=="true")  {

  var obj=JSON.parse(ardata);
  var obj2={};
  var cls=event.currentTarget.name
  obj2['filename']=obj['filename'];
  obj2['filepath']=obj['filepath'];
  obj2['background']=obj['background'];
  obj2['style']=obj['style'];
  obj2['keywords']=obj['keywords'];
  obj2["ids"]=list.length;
  obj2["class"]=cls;
  obj2["page"]=curpage;  
  obj2['type']=obj['type'];


  // dvp.name=obj2; 
  arfile.push(obj2);
 
startapp();
savefile();
 
                        }
                        else{
                          arfile[indx]["ids"]=list.length;
var cls=event.currentTarget.name

arfile[indx]["class"]=cls;
arfile[indx]["page"]=curpage;

startapp();
savefile();
                        }


}, false);


var inp=document.createElement('OPTION');


inp.value=classarfile[o]["classname"];
inp.innerHTML=classarfile[o]["classname"];
var divm=document.createElement('div');
divm.className="classdiv";
divm.appendChild(btnclass)
divm.appendChild(dvm);
mainplace.appendChild(divm);
slclass.appendChild(inp);


}
colorlist =[...new Set(colorlist)];
for(var w=0;w<colorlist.length;w++){
var opt =document.createElement('OPTION');
opt.innerHTML=colorlist[w];
opt.style.backgroundColor=colorlist[w];
opt.value=colorlist[w];
}
slcol.appendChild(opt);
var inp=document.createElement('OPTION');
if(slclass.value==""){
  inp.value="none";
  inp.innerHTML="none";
  inp.selected = true;
}else{
inp.value=classarfile[0]["classname"];
inp.innerHTML=classarfile[0]["classname"];
inp.selected = true;
}
slclass.appendChild(inp);

}

catch(e){}

}
function makeicon(){
  document.getElementById('clss').style.display="block";
  document.getElementById('keyw').style.display="block";
  document.getElementById('main').style.gridColumn="2/7";
  document.getElementById('clss').style.gridRow="2/11";
  document.getElementById('clslbl').innerHTML="Class";
  itmpg=false;
  mainplace.style.gridTemplateColumns="repeat(8, 120px)";
  mainplace.style.gridAutoRows="110px";
  mainplace.style.gap="7px 14px";
  mainplace.style.removeProperty('grid-template-rows');
  mainplace.style.removeProperty('overflow-y');
  claspage=false;
 arfile=[{"filename":"test.desktop","filepath":"test.desktop","keywords":"","type":"file","background":"#99f09f","style":"","icon":"","class":"Tutorial","page":1,"ids":10},{"filename":"lek","filepath":"exampl","keywords":"","type":"file","background":"#a18787","style":"","icon":"","class":"","page":1,"ids":0}]
          // var curpage=1;
          var classfile=[{"classname":"Tutorial","list":[],"background":"#97d39b","keywords":"","fil":-18,"ids":0,"page":1},{"classname":"Classsss","list":[27,27,72,21],"background":"#4d5c2e","keywords":"","fil":1,"ids":1,"page":2}]
  try{
 
 var arfile2=arfile.filter((e) => e.page == curpage);
 
 
var arfile3=arfile2.filter((e) => e.class == "");
let result = arfile2.map(a => a.ids);
let colorlist = arfile.map(a => a.background);
let result2 = arfile3.map(a => a.ids);
let classff = classfile.map(a => a.page);
var classarfile=classfile.filter((e) => e.page == curpage);
// var result=[];
// var classarfile=[];
var tlitem=40;
console.log(arfile)
var clf=classarfile.length;
// var itmc=tlitem-(clf*4);
var itmc=tlitem;
//alert(itmc)
for(var p=0;p<itmc;p++){
var dv=document.createElement('div');
dv.className="divpar";
dv.id=p;
dv.style.background="transparent"

dv.addEventListener('dragover',function (event)  {  allowDrop(event)}, false);
                      dv.addEventListener('drop',function (event)  { event.preventDefault();
                        const idx = event.dataTransfer.getData("data");
                        const data = event.dataTransfer.getData("Text");
                        const indx = event.dataTransfer.getData("ids");
                        const curp = event.dataTransfer.getData("curp");
                        const copybox = event.dataTransfer.getData("copybox");
                        const ardata = event.dataTransfer.getData("ardata");
                        // alert(data)
                        if(copybox=="true")  {
                          if (event.currentTarget.hasChildNodes()) {
                            
  // It has at least one
  var co=0;
          var sts;
          try{
              while(mainplace.children[co].childElementCount > 0 ){
                
                co++;  
     
              }
            }catch(e){
              alert('Page is Full');
              sts="Page is Full";
            }if(sts!="Page is Full"){
  var obj=JSON.parse(ardata);
  var obj2={};
  
  obj2['filename']=obj['filename'];
  obj2['filepath']=obj['filepath'];
  obj2['background']=obj['background'];
  obj2['style']=obj['style'];
  obj2['keywords']=obj['keywords'];
  obj2["ids"]=co;
  obj2["class"]="";
  obj2["page"]=curpage;  
  obj2['type']=obj['type'];
  // dvp.name=obj2; 
  arfile.push(obj2);
  // alert(JSON.stringify(arfile))
  
  
  startapp();
  savefile();
            }
 
}else{
// 
var obj=JSON.parse(ardata);
  var obj2={};
  
  obj2['filename']=obj['filename'];
  obj2['filepath']=obj['filepath'];
  obj2['background']=obj['background'];
  obj2['style']=obj['style'];
  obj2['keywords']=obj['keywords'];
  obj2["ids"]=~~event.target.id;
  obj2["class"]="";
  obj2["page"]=curpage;  
  obj2['type']=obj['type'];

  
  // dvp.name=obj2; 
  arfile.push(obj2);
 
startapp();
savefile();

}
                        }
                        else{
                          if (event.currentTarget.hasChildNodes()) {
  // It has at least one
  
  var arfile2=arfile.filter((e) => e.page == curpage);
  let obj = arfile2.find(x => x.filepath === event.target.id);
let index = arfile.indexOf(event.target.name);
var idne=arfile[index]['ids'];
  
  arfile[index]["ids"]=~~idx;
  arfile[indx]["ids"]=idne;
  arfile[index]["class"]=arfile[indx]["class"];
  arfile[indx]["class"]="";
  arfile[index]["page"]=~~curp;
  arfile[indx]["page"]=curpage;
  
  
  
  startapp();
  savefile();
 
}else{
// 

  arfile[indx]["ids"]=~~event.target.id;
  arfile[indx]["page"]=curpage;
  if(arfile[indx]["class"] !=""){
    let decr = classfile.find(x => x.classname === arfile[indx]["class"]);
    let indexdec = classfile.indexOf(decr);
    classfile[indexdec]['fil']=~~classfile[indexdec]['fil']-1;
    
classfile[indexdec]['list'] = classfile[indexdec]['list'].filter(e => e !== ~~indx)

    arfile[indx]["class"]="";
  }
  
  

 
startapp();
savefile();

}
                        }


}, false);

mainplace.appendChild(dv);



}
// var ix=1;
// var ix2=1;

for(var o=0;o<clf;o++){
var fild=document.createElement('FIELDSET');
var legn=document.createElement('legend');
var btnclass=document.createElement('button');
legn.innerHTML=classarfile[o]["classname"];
btnclass.innerHTML=classarfile[o]["classname"];
btnclass.style.backgroundColor=classarfile[o]["background"];
var dvm=document.createElement('div');
dvm.className="classfile";
btnclass.className="collapsible";
btnclass.name=classfile.indexOf(classarfile[o]);
dvm.name=classarfile[o]["classname"];

dvm.style.background="white";
fild.style.padding="0";
btnclass.addEventListener("click", function() {
    this.classList.toggle("active");
    var content = this.nextElementSibling;
    if (content.style.display === "grid") {
      content.style.display = "none";
    } else {
      content.style.display = "grid";
    }
  });

// var ssp =classarfile[o]
var list=arfile2.filter((e) => e.class == classarfile[o]["classname"]);
for(var a=0;a<list.length;a++){
var dvq =document.createElement('div');
var img=document.createElement('div');
          var label=document.createElement('label');
          var icon=document.createElement('div');
          var dvtp=document.createElement('div');
          var dvtb=document.createElement('div');
          var lbltb=document.createElement('label');
          icon.className="iconimg";
          dvtp.className="dvtp";
          dvtb.className="dvtb";
          lbltb.className="lbltb";
          dvq.id=list[a]['filepath'];            
          img.id=list[a]['filepath'];
          label.id=list[a]['filepath'];
           dvtp.id=list[a]['filepath']+"icon";
          icon.id=list[a]['filepath']+"mc";
          dvtb.id=list[a]['filepath'];
          lbltb.id=list[a]['filepath'];
          dvq.className="divfileclass";
          img.className="imgiconclass";
          label.className="txtfile";
          dvq.name=list[a];
          img.name=list[a];
          label.name=list[a];
          dvtp.name=list[a];
          icon.name=list[a];
          dvtb.name=list[a];
          lbltb.name=list[a];
          if(list[a]['type']=="web"){
            lbltb.innerHTML="web";
          }
          if(list[a]['type']=="folder"){
            lbltb.innerHTML="folder";
          }
          if(list[a]['type']=="file"){
            if(splitLastOccurrence(list[a]['filepath'].split("/").pop(),".") !=list[a]['filepath'] && splitLastOccurrence(list[a]['filepath'].split("/").pop(),".") !="False"){
            lbltb.innerHTML=splitLastOccurrence(list[a]['filepath'].split("/").pop(),".");
          }
          }
          
          if(preview.checked==true){
            if(list[a]['type']=="file"){
              var ext=splitLastOccurrence(list[a]['filepath'].split("/").pop(),".");
              if(ext=="jpg"||ext=="jpeg"||ext=="png"||ext=="gif"||ext=="ico"||ext=="bmp"){
          dvtp.style.backgroundImage="url('file:///"+list[a]['filepath'].replaceAll('/', '/')+"')";
          
          dvtp.style.backgroundSize="contain";
          dvtp.style.backgroundRepeat="no-repeat";
          dvtp.style.backgroundPosition="center center"
            }        
    else{
     
      // alert(JSON.stringify(exten))
      try{
      // alert(JSON.stringify(exten[ext]["icon"]))
      dvtp.style.backgroundImage="url('file:///"+exten[ext]["icon"].replaceAll('/', '/').replaceAll('16x16', '32x32@2x')+"')";
          
          dvtp.style.backgroundSize="35px 35px";
          dvtp.style.backgroundRepeat="no-repeat";
          dvtp.style.backgroundPosition="center 15px"
        
    }catch(e){
      // alert(e)
      if(!list[a]['icon']||list[a]['icon']==""){
            icon.style.borderColor=list[a]['background'];  
          icon.innerHTML=iconstyle(list[a]['type'],list[a]['filepath']);
          dvtp.appendChild(icon)
        }
        else{
          dvtp.style.backgroundImage="url('file:///"+list[a]["icon"].replaceAll('/', '/')+"')";
          
          dvtp.style.backgroundSize="35px 35px";
          dvtp.style.backgroundRepeat="no-repeat";
          dvtp.style.backgroundPosition="center 15px"
        }
    }
    } 
            }
            else{
              icon.style.borderColor=list[a]['background'];  
          icon.innerHTML=iconstyle(list[a]['type'],list[a]['filepath']);
          dvtp.appendChild(icon)
            }
            
          }else{
            if(!list[a]['icon']||list[a]['icon']==""){
            icon.style.borderColor=list[a]['background'];  
          icon.innerHTML=iconstyle(list[a]['type'],list[a]['filepath']);
          dvtp.appendChild(icon)
        }
        else{
          dvtp.style.backgroundImage="url('file:///"+list[a]["icon"].replaceAll('/', '/')+"')";
          
          dvtp.style.backgroundSize="35px 35px";
          
          dvtp.style.backgroundRepeat="no-repeat";
          dvtp.style.backgroundPosition="center 15px"
        }
          }
          // dvtb.appendChild(lbltb)
          img.appendChild(dvtp)
          img.appendChild(dvtb)
          label.innerHTML=list[a]['filename'];
          dvq.draggable=true;
          img.style.borderColor=list[a]['background'];
          img.style.borderStyle=list[a]['style']; 
          dvq.title=list[a]['filename'];
         
          dvq.addEventListener('dragstart', function (event)  { 
            event.dataTransfer.setData("Text", event.target.id);
            var arfile2=arfile.filter((e) => e.page == curpage);
            let obj = arfile2.find(x => x.filepath === event.target.id);
let index = arfile.indexOf(event.target.name);
var idne=arfile[index]['ids'];
event.dataTransfer.setData("data", idne);
event.dataTransfer.setData("ids", index);
event.dataTransfer.setData("curp", curpage);

          }, false); 
if(list[a]['type']=="web"){
            

            dvq.addEventListener('click', function (event)  {
              
              
            let obj = arfile.find(x => x.filepath === event.target.id);
let index = arfile.indexOf(event.target.name);
var dta=arfile[index];
//alert(JSON.stringify(dta))
            dname.value=dta['filename'];
            pathclick=event.target.id;
            
          });
            } else if(list[a]['type']=="folder"){
              dvq.addEventListener('click', function (event)  {
                
                
            let obj = arfile.find(x => x.filepath === event.target.id);
let index = arfile.indexOf(event.target.name);
var dta=arfile[index];
            dname.value=dta['filename'];
            try{
            dtype.innerHTML=abbreviateNumber(getDirSize(dta['filepath']))
          }catch(e){

          }
            pathclick=event.target.id;
          });      
            }
           else if(list[a]['type']=="file"){
            
            dvq.addEventListener('click', function (event)  {
              
              
            let obj = arfile.find(x => x.filepath === event.target.id);
let index = arfile.indexOf(event.target.name);
var dta=arfile[index];
            dname.value=dta['filename'];
            try{
            dtype.innerHTML=getFilesizeInBytes(dta['filepath'])
          }catch(e){
            
          }
            pathclick=event.target.id;
          });

        } 
          dvq.addEventListener('dblclick', () => { 
                var button = event.target.id;
                try{
                if(button.includes("http")){
                  window.open(button,'popup','width=600,height=600');  
                }
                else if(fs.lstatSync(button).isDirectory() ){
                  mainplace.innerHTML="";
            classmap.innerHTML="";
              arfile=[];
              classfile=[];
              curpage=1;
              
              
              pagesort=['normal'];
              if(pathcount==(pathsort.length)){
              foldsort.push("folder");
              pathsort.push(button);
            }
            else{
              foldsort[pathcount]="folder";
              pathsort[pathcount]=button;
              var a = pathcount+1;
var b = pathsort.length;

pathsort.splice(a, (b - a) + 1);
foldsort.splice(a, (b - a) + 1);
            }
            pathcount++;
              pathtype ="folder";
              pathname =button;
                startapp();
                }
                else{
                  window.open("file:///"+button,'popup','width=600,height=600');
                }
              }catch(e){alert(e)} 
        
            }); 
 
          dvq.appendChild(img);
          dvq.appendChild(label); 
         
          dvm.appendChild(dvq);
}
// fild.style.width="100%";
// fild.style.float="none";
dvm.addEventListener('dragover',function (event)  {  allowDrop(event)}, false);
dvm.addEventListener('drop',function (event)  { event.preventDefault();
                        const idx = event.dataTransfer.getData("data");
                        const data = event.dataTransfer.getData("Text");
                        const indx = event.dataTransfer.getData("ids");
                        const curp = event.dataTransfer.getData("curp");
                        const copybox = event.dataTransfer.getData("copybox");
                        const ardata = event.dataTransfer.getData("ardata");
                        if(copybox=="true")  {

var obj=JSON.parse(ardata);
var obj2={};
var cls=event.currentTarget.name
obj2['filename']=obj['filename'];
obj2['filepath']=obj['filepath'];
obj2['background']=obj['background'];
obj2['keywords']=obj['keywords'];
obj2["ids"]=list.length;
obj2["class"]=cls;
obj2["page"]=curpage;  
obj2['type']=obj['type'];


// dvp.name=obj2; 
arfile.push(obj2);

startapp();
savefile();

                      }
                      else{
arfile[indx]["ids"]=list.length;
var cls=event.currentTarget.name

arfile[indx]["class"]=cls;
arfile[indx]["page"]=curpage;

startapp();
savefile();
                      }
}, false);


var inp=document.createElement('OPTION');


inp.value=classarfile[o]["classname"];
inp.innerHTML=classarfile[o]["classname"];
classmap.appendChild(btnclass)
classmap.appendChild(dvm)
slclass.appendChild(inp);
//alert(ix+"s")
// ix=ix+2;
// ix2=ix2+2;
}
var inp=document.createElement('OPTION');

inp.selected = true; 
inp.value="none";
inp.innerHTML="none";
slclass.appendChild(inp);
result2=result2.reverse();
// alert(JSON.stringify(result))

for(var i=0;i<result2.length;i++){
  
  
 


// // Create a new text node:

var filep=arfile3.filter((e) => e.ids == ~~result2[i]);
// alert(JSON.stringify(arfile3))
    // if(filep[0]['class']==""){
      var dve=document.createElement('div');
          var img=document.createElement('div');
          var label=document.createElement('label');
          var icon=document.createElement('div');
          var dvtp=document.createElement('div');
          var dvtb=document.createElement('div');
          var lbltb=document.createElement('label');
          
          icon.className="iconimg";
          dvtp.className="dvtp";
          dvtb.className="dvtb";
          lbltb.className="lbltb";
          // imgs.id=result2[i].toString()+"s";
          dve.id=filep[0]['filepath'];  
          img.id=filep[0]['filepath'];
          label.id=filep[0]['filepath'];
          dvtp.id=filep[0]['filepath']+"icon";
          icon.id=filep[0]['filepath']+"mc";
          dvtb.id=filep[0]['filepath'];
          lbltb.id=filep[0]['filepath'];
          dve.className="divfile";
          dve.name=filep[0];
          
          img.name=filep[0];
          label.name=filep[0];
          dvtp.name=filep[0];
          icon.name=filep[0];
          dvtb.name=filep[0];
          lbltb.name=filep[0];
          img.className="imgicon";
          label.className="txtfile";
         
          if(filep[0]['type']=="web"){
            lbltb.innerHTML="web";
          }
          if(filep[0]['type']=="folder"){
            lbltb.innerHTML="folder";
          }
          if(filep[0]['type']=="file"){
            if(splitLastOccurrence(filep[0]['filepath'].split("/").pop(),".") !=filep[0]['filepath'] && splitLastOccurrence(filep[0]['filepath'].split("/").pop(),".") !="False"){
            lbltb.innerHTML=splitLastOccurrence(filep[0]['filepath'].split("/").pop(),".");
          }
          
          }
          
          if(preview.checked==true){
            if(filep[0]['type']=="file"){
              var ext=splitLastOccurrence(filep[0]['filepath'].split("/").pop(),".");
              if(ext=="jpg"||ext=="jpeg"||ext=="png"||ext=="gif"||ext=="ico"||ext=="bmp"){
          dvtp.style.backgroundImage="url('file:///"+filep[0]['filepath'].replaceAll('/', '/')+"')";
          
          dvtp.style.backgroundSize="contain";
          dvtp.style.backgroundRepeat="no-repeat";
          dvtp.style.backgroundPosition="center center"
            }        
    else{
     
      // alert(JSON.stringify(exten))
      try{
      // alert(JSON.stringify(exten[ext]["icon"]))
      dvtp.style.backgroundImage="url('file:///"+exten[ext]["icon"].replaceAll('/', '/').replaceAll('16x16', '48x48@2x')+"')";
          
          dvtp.style.backgroundSize="45px 45px";
          dvtp.style.backgroundRepeat="no-repeat";
          dvtp.style.backgroundPosition="center 15px"
        
    }catch(e){
      // alert(e)
      if(!filep[0]['icon']||filep[0]['icon']==""){
            icon.style.borderColor=filep[0]['background'];  
          icon.innerHTML=iconstyle(filep[0]['type'],filep[0]['filepath']);
          dvtp.appendChild(icon)
        }
        else{
          dvtp.style.backgroundImage="url('file:///"+filep[0]['icon'].replaceAll('/', '/').replaceAll('16x16', '48x48@2x')+"')";
          
          dvtp.style.backgroundSize="45px 45px";
          dvtp.style.backgroundRepeat="no-repeat";
          dvtp.style.backgroundPosition="center 15px"
        }
    }
    } 
            }
            else{
              icon.style.borderColor=filep[0]['background'];  
          icon.innerHTML=iconstyle(filep[0]['type'],filep[0]['filepath']);
          dvtp.appendChild(icon)
            }
            
          }else{
            if(!filep[0]['icon']||filep[0]['icon']==""){
            icon.style.borderColor=filep[0]['background'];  
          icon.innerHTML=iconstyle(filep[0]['type'],filep[0]['filepath']);
          dvtp.appendChild(icon)
        }
        else{
          dvtp.style.backgroundImage="url('file:///"+filep[0]['icon'].replaceAll('/', '/').replaceAll('16x16', '48x48@2x')+"')";
          
          dvtp.style.backgroundSize="45px 45px";
          dvtp.style.backgroundRepeat="no-repeat";
          dvtp.style.backgroundPosition="center 15px"
        }
          }
          
          
          dvtb.appendChild(lbltb)
          img.appendChild(dvtp)
          img.appendChild(dvtb)
          label.innerHTML=filep[0]['filename'];
          dve.draggable=true;
          img.style.borderColor=filep[0]['background'];  
          img.style.borderStyle=filep[0]['style'];
          dve.title=filep[0]['filename']
          
          
            
            if(filep[0]['type']=="web"){
            

            dve.addEventListener('click', function (event)  {
              eventrgt=event;
              
            let obj = arfile.find(x => x.filepath === event.target.id);
let index = arfile.indexOf(event.target.name);
var dta=arfile[index];
// alert()
            dname.value=dta['filename'];
            pathclick=event.target.id;
            
          });
            } else if(filep[0]['type']=="folder"){
              dve.addEventListener('click', function (event)  {
                eventrgt=event;
                
            let obj = arfile.find(x => x.filepath === event.target.id);
let index = arfile.indexOf(event.target.name);
var dta=arfile[index];
            dname.value=dta['filename'];
            try{
            dtype.innerHTML=abbreviateNumber(getDirSize(dta['filepath']))
          }catch(e){
            
          }
            pathclick=event.target.id;
          });      
            }
           else if(filep[0]['type']=="file"){
            
            dve.addEventListener('click', function (event)  {
              eventrgt=event;
              
            let obj = arfile.find(x => x.filepath === event.target.id);
let index = arfile.indexOf(event.target.name);

var dta=arfile[index];

            dname.value=dta['filename'];
             try{
            dtype.innerHTML=getFilesizeInBytes(dta['filepath'])
          }catch(e){
            
          }
            pathclick=event.target.id;
          });

        }
          dve.addEventListener('dblclick', () => { 
                var button = event.target.id;
                try{
                if(button.includes("http")){
                  window.open(button,'popup','width=600,height=600');  
                }
                else if(fs.lstatSync(button).isDirectory() ){
                  mainplace.innerHTML="";
            classmap.innerHTML="";
              arfile=[];
              classfile=[];
              curpage=1;
              
              
              pagesort=['normal'];
              if(pathcount==(pathsort.length)){
              foldsort.push("folder");
              pathsort.push(button);
            }
            else{
              foldsort[pathcount]="folder";
              pathsort[pathcount]=button;
              var a = pathcount+1;
var b = pathsort.length;

pathsort.splice(a, (b - a) + 1);
foldsort.splice(a, (b - a) + 1);
            }
            pathcount++;
              pathtype ="folder";
              pathname =button;
                startapp();
                }
                else{
                  window.open("file:///"+button,'popup','width=600,height=600');
                }
              }catch(e){alert(e)}
        
            });
          dve.addEventListener('dragstart', function (event)  {
            event.dataTransfer.setData("Text", event.target.id);
            var arfile2=arfile.filter((e) => e.page == curpage);
            let obj = arfile2.find(x => x.filepath === event.target.id);
let index = arfile.indexOf(event.target.name);
var idne=arfile[index]['ids'];
event.dataTransfer.setData("data", idne);
event.dataTransfer.setData("ids", index);
event.dataTransfer.setData("curp", curpage);
event.dataTransfer.setData("arfile", JSON.stringify(arfile[index]));

          }, false); 
          
          dve.appendChild(img);
          dve.appendChild(label); 
          var ress=~~result2[i]
        
            mainplace.children[ress].appendChild(dve);
        
}
var arkey = arfile.map(a => a.keywords);

var words = arkey.join(",").split(",");

var ul= document.createElement('ul');
keywordlist.innerHTML="";
words=words.sort();
words=[...new Set(words)];

for(var e=0;e<words.length;e++){
  if(words[e]!=="" ){
    
  var li= document.createElement('li');
  li.className= "likeyword";
  li.innerHTML=words[e];
  li.addEventListener('dblclick', () => { 
    var button = event.target.innerHTML;
    filter = button;
    var result=arfile;
    // event.target.style.backgroundColor="blue";
    mainplace.innerHTML="";
            classmap.innerHTML="";
      src();
      
      dv = document.getElementsByClassName("divfile");
      li = document.getElementsByClassName("divpar");
      
      
      for (i = 0; i <arfile.length; i++) {td = dv[i];if (td) {
        txtValue = dv[i].name["keywords"];
       
        if(typeof txtValue!="undefined"){
        if(txtValue.includes(filter)){
        // if (txtValue.toUpperCase().indexOf(filter) > -1) {
      // li[i].style.display = "";
      dv[i].style.display = "";
      
      // dv[i].style.background = "white";
    } else {
      // li[i].style.display = "none";
      dv[i].style.display = "none";
      // dv[i].style.background = "white";
    }}
  // }
  }
  }
  })
ul.appendChild(li);
}
}

keywordlist.appendChild(ul);
colorlist =[...new Set(colorlist)];
for(var w=0;w<colorlist.length;w++){
var opt =document.createElement('OPTION');
opt.innerHTML=colorlist[w];
opt.style.backgroundColor=colorlist[w];
opt.value=colorlist[w];
slcol.appendChild(opt);
}

}catch(e){alert(e)}
}
function makeiconhome(){
  document.getElementById('clss').style.display="block";
  document.getElementById('keyw').style.display="none";
  document.getElementById('main').style.gridColumn="2/7";
  document.getElementById('clss').style.gridRow="2/15";
  document.getElementById('clslbl').innerHTML="Recent";
  mainplace.style.gridTemplateColumns="repeat(8, 120px)";
  itmpg=false;
  mainplace.style.gridAutoRows="110px";
  mainplace.style.gap="7px 14px";
  mainplace.style.removeProperty('grid-template-rows');
  mainplace.style.removeProperty('overflow-y');
  claspage=false;
  try{

 var arfile2=arfile.filter((e) => e.page == curpage);
 let colorlist = arfile.map(a => a.background);
var arfile3=arfile2.filter((e) => e.class == "");
let result = arfile2.map(a => a.ids);
let result2 = arfile3.map(a => a.ids);
let classff = classfile.map(a => a.page);
// var result=[];
var classarfile=[];
var tlitem=40;

for(var e=0;e<classff.length;e++){
  if((~~classff[e])==(curpage)){
    classarfile.push(classfile[e])
  }
}

var clf=classarfile.length;

var itmc=tlitem;

for(var p=0;p<itmc;p++){
var dv=document.createElement('div');
dv.className="divpar";
dv.id=p;
dv.style.background="transparent"

dv.addEventListener('dragover',function (event)  {  allowDrop(event)}, false);
                      dv.addEventListener('drop',function (event)  { event.preventDefault();
                        const idx = event.dataTransfer.getData("data");
                        const data = event.dataTransfer.getData("Text");
                        const indx = event.dataTransfer.getData("ids");
                        const curp = event.dataTransfer.getData("curp");
                        const copybox = event.dataTransfer.getData("copybox");
                        const ardata = event.dataTransfer.getData("ardata");
                        //alert(JSON.stringify(arfile[indx]))
                        
                        // alert(data)
if(copybox=="true")  {
  
  if (event.currentTarget.hasChildNodes()) {
  // It has at least one
  var co=0;
          var sts;
          try{
              while(mainplace.children[co].childElementCount > 0 ){
                
                co++;  
     
              }
            }catch(e){
              alert('Page is Full');
              sts="Page is Full";
            }if(sts!="Page is Full"){
  var obj=JSON.parse(ardata);
  var obj2={};
  
  obj2['filename']=obj['filename'];
  obj2['filepath']=obj['filepath'];
  obj2['background']=obj['background'];
  obj2['style']=obj['style'];
  obj2['keywords']=obj['keywords'];
  obj2["ids"]=co;
  obj2["class"]="";
  obj2["page"]=curpage;  
  obj2['type']=obj['type'];
  // dvp.name=obj2; 
  arfile.push(obj2);
  // alert(JSON.stringify(arfile))
  
  
  startapp();
  savefile();
            }
}else{

  var obj=JSON.parse(ardata);
  var obj2={};
  
  obj2['filename']=obj['filename'];
  obj2['filepath']=obj['filepath'];
  obj2['background']=obj['background'];
  obj2['style']=obj['style'];
  obj2['keywords']=obj['keywords'];
  obj2["ids"]=~~event.target.id;
  obj2["class"]="";
  obj2["page"]=curpage;  
  obj2['type']=obj['type'];


  // dvp.name=obj2; 
  arfile.push(obj2);
 
startapp();
savefile();
 
}
} else{
  if (event.currentTarget.hasChildNodes()) {
  // It has at least one
  var arfile2=arfile.filter((e) => e.page == curpage);
  let obj = arfile2.find(x => x.filepath === event.target.id);
let index = arfile.indexOf(event.target.name);
var idne=arfile[index]['ids'];
 
  arfile[index]["ids"]=~~idx;
  arfile[indx]["ids"]=idne;
  arfile[index]["page"]=~~curp;
  arfile[indx]["page"]=curpage;
  // alert(JSON.stringify(arfile))
  
  
  startapp();
  savefile();
 
}else{

  arfile[indx]["ids"]=~~event.target.id;
  arfile[indx]["page"]=curpage;
  if(arfile[indx]["class"] !=""){
    let decr = classfile.find(x => x.classname === arfile[indx]["class"]);
    let indexdec = classfile.indexOf(decr);
    classfile[indexdec]['fil']=~~classfile[indexdec]['fil']-1;
    
classfile[indexdec]['list'] = classfile[indexdec]['list'].filter(e => e !== ~~indx)
// alert(JSON.stringify(classfile[indexdec]['list']))
    arfile[indx]["class"]="";
  }
 
startapp();
savefile();
 
}
}

}, false);

mainplace.appendChild(dv);



}

result2=result2.reverse();
// alert(JSON.stringify(result))

for(var i=0;i<result2.length;i++){
  
  
 


// // Create a new text node:

var filep=arfile3.filter((e) => e.ids == ~~result2[i]);
// alert(JSON.stringify(arfile3))
    // if(filep[0]['class']==""){
      var dve=document.createElement('div');
          var img=document.createElement('div');
          var label=document.createElement('label');
          var icon=document.createElement('div');
          var dvtp=document.createElement('div');
          var dvtb=document.createElement('div');
          var lbltb=document.createElement('label');
          icon.className="iconimg";
          dvtp.className="dvtp";
          dvtb.className="dvtb";
          lbltb.className="lbltb";
          dve.id=filep[0]['filename'];            
          img.id=filep[0]['filename'];
          label.id=filep[0]['filename'];
          dvtp.id=filep[0]['filename'];
          icon.id=filep[0]['filename'];
          dvtb.id=filep[0]['filename'];
          lbltb.id=filep[0]['filename'];
          dve.className="divfile";
          dve.name=filep[0];
          img.name=filep[0];
          label.name=filep[0];
          dvtp.name=filep[0];
          icon.name=filep[0];
          dvtb.name=filep[0];
          lbltb.name=filep[0];
          img.className="imgicon";
          label.className="txtfile";
          label.innerHTML=filep[0]['filename'];
          icon.style.borderColor=filep[0]['background'];  
            lbltb.innerHTML="project";
            if(!filep[0]['icon']||filep[0]['icon']==""){
              icon.innerHTML="&#x1F4D7;";
          if(filep[0]['filepath']){
            lbltb.innerHTML="folder";
            icon.innerHTML="&#x1F4C1;";
          }
          dvtp.appendChild(icon)
        }
        else{
          dvtp.style.backgroundImage="url('file:///"+filep[0]['icon'].replaceAll('/', '/').replaceAll('16x16', '48x48@2x')+"')";
          if(filep[0]['filepath']){
            lbltb.innerHTML="folder";
          }
          dvtp.style.backgroundSize="45px 45px";
          dvtp.style.backgroundRepeat="no-repeat";
          dvtp.style.backgroundPosition="center 15px"
        }
           
          icon.style.borderColor=filep[0]['background'];  
          
          
          dvtb.appendChild(lbltb)
          img.appendChild(dvtp)
          img.appendChild(dvtb)
          dve.draggable=true;
          img.style.borderColor=filep[0]['background']; 
          img.style.borderStyle=filep[0]['style'];
          dve.title=filep[0]['filename'];
          
            
             if(filep[0]['filepath']){
              dve.addEventListener('click', function (event)  {
                eventrgt=event;
                
            let obj = arfile.find(x => x.filepath === event.target.id);
let index = arfile.indexOf(event.target.name);
var dta=arfile[index];
            dname.value=dta['filename'];
            try{
            dtype.innerHTML=abbreviateNumber(getDirSize(dta['filepath']))
          }catch(e){
            
          }
            pathclick=event.target.id;
          });
//           
            
            }else{
              dve.addEventListener('click', function (event)  {
                eventrgt=event;
                
            let obj = arfile.find(x => x.filepath === event.target.id);
let index = arfile.indexOf(event.target.name);
var dta=arfile[index];
            dname.value=dta['filename'];
            try{
            dtype.innerHTML=abbreviateNumber(getDirSize(dta['filepath']))
          }catch(e){
            
          }
            pathclick=event.target.id;
          });
            }
          
          dve.addEventListener('dblclick', () => { 
                var button = event.target.id;
    mainplace.innerHTML="";
            classmap.innerHTML="";
            curpage=1;
            arfile=[];
              classfile=[];
               pagesort=["normal"];
            pagenamelst=["1"]
               if(event.target.name["filepath"]){
                if(pathcount==(pathsort.length)){
              foldsort.push("folder");
              pathsort.push(event.target.name["filepath"]);
            }
            else{
              foldsort[pathcount]="folder";
              pathsort[pathcount]=event.target.name["filepath"];
              var a = pathcount+1;
var b = pathsort.length;

pathsort.splice(a, (b - a) + 1);
foldsort.splice(a, (b - a) + 1);
            }
                
    pathcount++;
  pathtype="folder";
  pathname=event.target.name["filepath"];
  var arflrc =[];
    // if(localStorage.getItem("recent")){
      if(localStorage.getItem('recentfpl')){
    arflrc = JSON.parse(localStorage["recentfpl"]);
      }

  // var arc=[];
 if(arflrc.length==7){
  arflrc.pop();
 }
  arflrc.splice(0, 0, event.target.name["filepath"]);
  let unique_ar = [];
  arflrc.forEach((ar) => {
    if (!unique_ar.includes(ar)) {
      unique_ar.push(ar);
    }
  });
  
  
  localStorage["recentfpl"] = JSON.stringify(unique_ar);
 
               }else{
                if(pathcount==(pathsort.length)){
              foldsort.push("custom");
              pathsort.push("./project/"+button);
            }
            else{
              foldsort[pathcount]="custom";
              pathsort[pathcount]="./project/"+button;
              var a = pathcount+1;
var b = pathsort.length;

pathsort.splice(a, (b - a) + 1);
foldsort.splice(a, (b - a) + 1);
            }              
    pathcount++;
  pathtype="custom";
  pathname="./project/"+button; 
  var arflrc =[];
    // if(localStorage.getItem("recent")){
      if(localStorage.getItem('recentfpl')){
    arflrc = JSON.parse(localStorage["recentfpl"]);
      }

  // var arc=[];
 if(arflrc.length==7){
  arflrc.pop();
 }
  arflrc.splice(0, 0, button);
  let unique_ar = [];
  arflrc.forEach((ar) => {
    if (!unique_ar.includes(ar)) {
      unique_ar.push(ar);
    }
  });
  
  
  localStorage["recentfpl"] = JSON.stringify(unique_ar);

}
  
//   arfile=fildet["file"];
// pagesort=fildet["pagesort"]; 

  startapp();
  lastpath=pathname;
        
            });
          dve.addEventListener('dragstart', function (event)  {
            event.dataTransfer.setData("Text", event.target.id);
            var arfile2=arfile.filter((e) => e.page == curpage);
            let obj = arfile2.find(x => x.filepath === event.target.id);
let index = arfile.indexOf(event.target.name);
var idne=arfile[index]['ids'];
event.dataTransfer.setData("data", idne);
event.dataTransfer.setData("ids", index);
event.dataTransfer.setData("curp", curpage);
event.dataTransfer.setData("arfile", JSON.stringify(arfile[index]));

          }, false); 
        
           
              
          dve.appendChild(img);
          dve.appendChild(label); 
          var ress=~~result2[i]
         
            mainplace.children[ress].appendChild(dve);
          
}
var arkey = arfile.map(a => a.keywords);

var words = arkey.join(",").split(",");

var ul= document.createElement('ul');
keywordlist.innerHTML="";
words=words.sort();


for(var e=0;e<words.length;e++){
  if(words[e]!=="" ){
    
  var li= document.createElement('li');
  li.className= "likeyword";
  li.innerHTML=words[e];
  li.addEventListener('dblclick', () => { 
    var button = event.target.innerHTML;
    filter = button;
    var result=arfile;
    // event.target.style.backgroundColor="blue";
    mainplace.innerHTML="";
            classmap.innerHTML="";
      src();
      
      dv = document.getElementsByClassName("divfile");
      li = document.getElementsByClassName("divpar");
      
      
      for (i = 0; i <arfile.length; i++) {td = dv[i];if (td) {
        txtValue = dv[i].name["keywords"];
       
        if(typeof txtValue!="undefined"){
        if(txtValue.includes(filter)){
        // if (txtValue.toUpperCase().indexOf(filter) > -1) {
      // li[i].style.display = "";
      dv[i].style.display = "";
      
      // dv[i].style.background = "white";
    } else {
      // li[i].style.display = "none";
      dv[i].style.display = "none";
      // dv[i].style.background = "white";
    }}
  // }
  }
  }
  })
ul.appendChild(li);
}
}

keywordlist.appendChild(ul);
colorlist =[...new Set(colorlist)];
for(var w=0;w<colorlist.length;w++){
var opt =document.createElement('OPTION');
opt.innerHTML=colorlist[w];
opt.style.backgroundColor=colorlist[w];
opt.value=colorlist[w];
slcol.appendChild(opt);

}

if(localStorage.getItem('recentfpl')){
      var arflrc = JSON.parse(localStorage["recentfpl"]);         
           for(var i=0;i<arflrc.length;i++){
                var txl=document.createElement("label");
                var br=document.createElement("br");
                 txl.innerHTML=arflrc[i];
                 txl.id=arflrc[i];
                 txl.className="lablre";
                 
                 txl.addEventListener('click', () => { 
                    // sessionStorage.removeItem('ad');
                    var button = event.target.id;
    mainplace.innerHTML="";
            classmap.innerHTML="";
            curpage=1;
            arfile=[];
              classfile=[];
              if(fs.existsSync(button)){   
              if(fs.lstatSync(button).isDirectory()){
                foldsort.push("folder");
                pathsort.push(button);
    pathcount++;
  pathtype="folder";
  pathname=button;
              }}else{
                
               foldsort.push("custom");
              pathsort.push("./project/"+button);
    pathcount++;
  pathtype="custom";
  pathname="./project/"+button; 
}

//   arfile=fildet["file"];
// pagesort=fildet["pagesort"]; 
var arflrc =[];
    // if(localStorage.getItem("recent")){
      if(localStorage.getItem('recentfpl')){
    arflrc = JSON.parse(localStorage["recentfpl"]);
      }

  // var arc=[];
 if(arflrc.length==7){
  arflrc.pop();
 }
  arflrc.splice(0, 0, button);
  let unique_ar = [];
  arflrc.forEach((ar) => {
    if (!unique_ar.includes(ar)) {
      unique_ar.push(ar);
    }
  });
  
  
  localStorage["recentfpl"] = JSON.stringify(unique_ar);

  startapp();
  
  lastpath=pathname;
                 });
                 classmap.appendChild(txl);
                 classmap.appendChild(br);
         
        }
            
        }
}catch(e){alert(e)}

}
function iconstyle(type,filename){
  var txt;
  if(pathtype=="home"){
    if(type=="folder"){
    txt="&#x1F4C1;";
  }
  else{
    txt="&#x1F4D7;";
  }
  }else{
  if(type=="file"){
    var ext=filename.split('.').pop().toLocaleLowerCase();
   
    
    if(ext=="mp3"||ext=="wav"||ext=="flac"||ext=="aac"||ext=="ogg"||ext=="aiff"||ext=="wma"||ext=="alac"||ext=="pcm"){
txt="&#x1F50A;";
    }
   else if(ext=="avi"||ext=="mp4"||ext=="mpg"||ext=="mov"||ext=="3gp"||ext=="wmv"||ext=="webm"||ext=="mkv"||ext=="avchd"){
    txt="&#x1F3AC;";
    }
   else if(ext=="jpg"||ext=="jpeg"||ext=="png"||ext=="gif"||ext=="tiff"||ext=="bmp"||ext=="psd"||ext=="ico"||ext=="eps"||ext=="ai"){
    txt="&#x1F4F7;";
    }
    else{
      txt="&#x1F4C4;";
    }
  }
  if(type=="folder"){
    txt="&#x1F4C1;";
  }
  if(type=="web"){
    txt="&#x1F310;";
  }
}
  return txt;
}
const getKeyByValue = (obj, value) => {
  return Object.keys(obj).find(key => obj[key] === value);
};
function createThumb(srcha) {
    
  // var thumbUrl = await getThumbnailForVideo(srcha);
  getThumbnailForVideo("file:///"+srcha+"").then(result => {
    var imgs = document.getElementsByClassName('imgs');  

 
    var num,ids;
    ids=getKeyByValue(imcoun, srcha)
 
    
    num=getKeyByValue(imgl, ~~ids)
    
    
    const newElement = document.createElement('img');
    newElement.id=srcha;
    // newElement.name=num;

    newElement.src=result;
    newElement.className="imgs"
    newElement.style.width="100%";
    
    newElement.style.height="100%";
    newElement.style.borderStyle="none";
        
document.getElementById(ids.toString()+"s").replaceWith(newElement);

    delete imgl[num];
    delete imcoun[ids];
     
  });
  
}
async function getThumbnailForVideo(videoUrl) {
  const video = document.createElement("video");
  const canvas = document.createElement("canvas");
  video.style.display = "none";
  canvas.style.display = "none";
  var imgs = document.getElementsByClassName('imgs');  
  // Trigger video load
  await new Promise((resolve, reject) => {
    video.addEventListener("loadedmetadata", () => {
      video.width = video.videoWidth;
      video.height = video.videoHeight;
      canvas.width = video.videoWidth;
      canvas.height = video.videoHeight;
      // Seek the video to 25%
      video.currentTime = video.duration * 0.25;
    });
    video.addEventListener("seeked", () => resolve());
    video.src = videoUrl;
  });

  // Draw the thumbnailz
  canvas
    .getContext("2d")
    .drawImage(video, 0, 0, video.videoWidth, video.videoHeight);
  const imageUrl = canvas.toDataURL("image/png");
  // imgs[num].src=imageUrl;
  // alert(imgs.length)
  return imageUrl;
}
// ads();
// update();
var thcount="";
function ads(){

$.ajax({
            url: "http://wistanomic.com/mmkl/adsfl4.txt",
       type: 'GET',
cache: false,
            beforeSend: function(xhr){
              if (xhr.overrideMimeType)
              {
                xhr.overrideMimeType("application/json");
              }
            },
            dataType: 'json',
            data: null,
            success:  function(data, textStatus, request) {
              var so =data;
                 
                 if(so.length!==0){
              window.open("infopage.html","popup",'width=600,height=600');
                 }
               },error: function (request, status, error) {
            }
          });  
}  
function update(){
  

$.ajax({
            url: "http://wistanomic.com/FileyTale/lstupd4.txt",
       type: 'GET',
cache: false,
            beforeSend: function(xhr){
              if (xhr.overrideMimeType)
              {
                xhr.overrideMimeType("application/json");
              }
            },
            dataType: 'json',
            data: null,
            success:  function(data, textStatus, request) {
              var so =data;
                 
                 if(so.length!==0){
            document.getElementById("updbtn").disabled=false;
            document.getElementById("updbtn").style.background="linear-gradient(145deg, #f0f0f0, #cacaca)";
            document.getElementById("updbtn").style.boxShadow="5px 5px 42px #d0d0d0, -5px -5px 42px #f0f0f0";
                 }
               },error: function (request, status, error) {
            }
          });
  
}

// var date = localStorage.getItem('endli');
// var today = new Date(new Date().setDate(new Date().getDate()));

// if(localStorage.getItem('active')||fs.existsSync("./premium/likey.json")){
  
// var date1=new Date(today);
// var date2=new Date(date);
//       if(date1 > date2){
              
//         var ob={};
//         if(fs.existsSync("./premium/alke.json")){
//           fs.readFile("./premium/alke.json", (err, data)=> {

// var d=JSON.parse(data);
// ob['code']=localStorage.getItem('active');
      
//       d.push(ob);
//       fs.writeFileSync("./premium/alke.json", JSON.stringify(d));
//       d=[];
//  localStorage.removeItem('active');
//         localStorage.removeItem('endli');
//         fs.unlink("./premium/likey.json", function(err) {
//   if(err && err.code == 'ENOENT') {
//         //file doens't exist
//      console.info("File doesn't exist, won't remove it.");
//     } else if (err) {
//         // other errors, e.g. maybe we don't have enough permission
//       console.error("Error occurred while trying to remove file");
//     } else {
//        console.info(`removed`);
//    }
// });
//         alert("Expired");        
//         // clearInterval(timer);

//         location.reload();
// });
//         }
//         else{

//           var d=[];
// ob['code']=localStorage.getItem('active');
      
//       d.push(ob);
//       if (!fs.existsSync("./premium/")){
//             fs.mkdirSync("./premium/");

//            }  
//       fs.writeFileSync("./premium/alke.json", JSON.stringify(d));
//       d=[];
//        localStorage.removeItem('active');
//         localStorage.removeItem('endli');        
//         fs.unlink("./premium/likey.json", function(err) {
//   if(err && err.code == 'ENOENT') {
//         //file doens't exist
//      console.info("File doesn't exist, won't remove it.");
//     } else if (err) {
//         // other errors, e.g. maybe we don't have enough permission
//       console.error("Error occurred while trying to remove file");
//     } else {
//        console.info(`removed`);
//    }
// });
//         alert("Expired");        
//         // clearInterval(timer);

//         location.reload();
//         }
       
        
//       }
//       else{
//         if(!localStorage.getItem('active')){
//           fs.readFile("./premium/likey.json", (err, data)=> {

// var d=JSON.parse(data);

// localStorage.setItem('active',d.data.license_key);
// localStorage.setItem('endli',d.end_date);
// location.reload();
// });
//         }
       
        
//       }  
// }

function get(types){

return types;
}
function icon(types){

return types;
}
function colour(types){

return types;
}
function tag(types){

return types;
}
function from(types){

return types;
}
function withvalue(types){

return types;
}
function thatcontain(types){
  
return types;
}
function by(types){

return types;
}

// function startexc(){
//   execute().then(() => {
//     alert("suces")
//   })
// }

function execute(){
  var fl =code.value;
  var fl2=[];
  var fn=[];
  var fn2=[];
  var statar=[];
  var arfile4=[];
  fl=fl.split(".");
  for(var i=0;i<fl.length;i++){
    fl2.push(fl[i].split("(")[0])
  }
  
  if(fl2.includes("get")){
    alert("ok")
    if(fl2.includes("from")){
      alert("lll")
      var ex=eval(fl[fl2.indexOf("get")])

var co=0;
          var arfile2=arfile.filter((e) => e.page == curpage);
 
//  var classn=flnm.value;
var classn="Class";
var arfile3=arfile2.filter((e) => e.class == classn);
var arfimap=arfile3.map((e) => e.filepath);
co=arfile3.length;
     var testFolder = eval(fl[fl2.indexOf("from")])
      fnu(testFolder).then((d) =>{ 
    // alert(d);
   
    d=JSON.parse(d);
    // alert(d+"l");
    var p=[];
    d.forEach(filep => {
  var obj={};
  // var id=i;
  
  if(fl2.includes("thatcontain")){
    var tc=eval(fl[fl2.indexOf("thatcontain")]).toString()
    if(filep.includes(tc)){

      var filePath =testFolder+"/"+filep;
        
      // alert(filePath)
      // fs.stat(filePath, function(err, stats) {
        var stats = fs.statSync(filePath)
              // alert(JSON.stringify(stats))
              var ppt=filePath
              if(fl2.includes("by")){
                var tc=eval(fl[fl2.indexOf("by")]);
              
                if(tc.includes("size")){
          var sizar= tc.split("size");
          // alert(JSON.stringify(sizar));
          // alert(JSON.stringify(arfile3[i]))
          if(sizar[0]!=""){
            const parts = sizar[1].match(/[a-zA-Z]+|[0-9]+/g);
            const parts2 = sizar[0].split("b")[1].match(/[a-zA-Z]+|[0-9]+/g);
            const parts3 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
            const parts4 = sizar[0].match(/[0-9]+/g);
            const parts5 = sizar[1].match(/[0-9]+/g);
            // var lin=parts3[parts3.length-1].split('').pop();
            
//             const lastIndex = sizar[0].split(lin);
// const newStr = lastIndex[lastIndex.length - 1];

            var lin2=parts[0].split('')[0];

            const lastIndex2 = sizar[1].split(lin2);
            
const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(JSON.stringify(sizsame +sizar[0].split("b")[1]+parts4.join(".")));
// alert(JSON.stringify(sizsame2 +newStr2+parts5.join(".")));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
// alert(sizar[0]+"dso")
try{
// if(sizar[0]==""){
  // alert(sizar[0]+"dso")

// }else{
  if(eval(parts4.join(".")+sizar[0].split("b")[1]+sizsame ) &&eval(sizsame2 +newStr2+parts5.join("."))){
              // alert(JSON.stringify(abbreviateNumber(stats['size']))+"e")
              // if(){
// alert(JSON.stringify(`Path file: ${filePath}`))
              // alert(JSON.stringify(abbreviateNumber(stats['size'])))
               var obj2={};
  
  obj2['filename']=`${filePath}`.split('/').pop();
  obj2['filepath']=`${filePath}`;
  obj2['background']="transparent";
  obj2['style']="solid";            
  obj2['keywords']="";
  obj2["ids"]=co;
  obj2["class"]=classn;
  obj2["page"]=curpage;  
  
    
              if(ex=="all"){
              fn.push(`${filePath}`)
              if(stats.isDirectory()){
                obj2['type']="folder";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
                
               
              }
              if(stats.isFile()){
                obj2['type']="file";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
              }
              
            }else if(ex =="folder"){
              if(stats.isDirectory()){
                obj2['type']="folder";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
                // fn.push(`${filePath}`)
              }
            }else{
              if(stats.isFile()){
                obj2['type']="file";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
                // fn.push(`${filePath}`)
              }
            }
            
              
              const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              // alert(json/)
              var arfil=arfile.filter((e) => e.keywords == "skak");
              alert(JSON.stringify(arfil)+" lplplp")
              alert(JSON.stringify(fn))
              // alert(stats.isDirectory())
              // alert(ex)
              // alert(stats.isFile()+" d")
            // }
            }
// }
          
          }catch(e){alert(e)}
            // alert(sizar[1])
            // get("all").thatcontain("jpg").by("3,5mb<size<4,2mb")
          }else{

            const parts = sizar[1].match(/[a-zA-Z]+|[0-9]+/g);
            // const parts2 = sizar[0].split("b")[1].match(/[a-zA-Z]+|[0-9]+/g);
            // const parts3 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
            // const parts4 = sizar[0].match(/[0-9]+/g);
            const parts5 = sizar[1].match(/[0-9]+/g);
            // var lin=parts3[parts3.length-1].split('').pop();
            
//             const lastIndex = sizar[0].split(lin);
// const newStr = lastIndex[lastIndex.length - 1];
            var lin2=parts[0].split('')[0];

            const lastIndex2 = sizar[1].split(lin2);
            
const newStr2 = lastIndex2[0];

 
// alert(parts5.join(","))
var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
alert(JSON.stringify(sizsame2 +newStr2+parts5.join(".")+"sdk"));
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(JSON.stringify(sizsame +sizar[0].split("b")[1]+parts4.join(".")));
// alert(JSON.stringify(sizsame2 +newStr2+parts5.join(".")));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
// try{
            if(eval(sizsame2 +newStr2+parts5.join("."))){
              // alert(JSON.stringify(abbreviateNumber(stats['size']))+"e")
              // if(){
// alert(JSON.stringify(`Path file: ${filePath}`))
              // alert(JSON.stringify(abbreviateNumber(stats['size'])))
              var obj2={};
  
  obj2['filename']=`${filePath}`.split('/').pop();
  obj2['filepath']=`${filePath}`;
  obj2['background']="transparent";
  obj2['style']="solid";            
  obj2['keywords']="";
  obj2["ids"]=co;
  obj2["class"]=classn;
  obj2["page"]=curpage;  
  
    
              if(ex=="all"){
              fn.push(`${filePath}`)
              if(stats.isDirectory()){
                obj2['type']="folder";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
                
               
              }
              if(stats.isFile()){
                obj2['type']="file";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
              }
              
            }else if(ex =="folder"){
              if(stats.isDirectory()){
                obj2['type']="folder";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
                // fn.push(`${filePath}`)
              }
            }else{
              if(stats.isFile()){
                obj2['type']="file";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
                // fn.push(`${filePath}`)
              }
            }
              alert(JSON.stringify(fn))
            // }
            }
//           }catch(e){alert(e)}
            // alert(sizar[1])
            // get("all").thatcontain("jpg").by("3,5mb<size<4,2mb")
        
          }
          // alert(JSON.stringify(fn))
          // var adff=fn2.filter((e) => abbreviateNumber(e.size) == tc);
        }
        if(tc.includes("cdate")){

var sizar= tc.split("cdate");
// alert(JSON.stringify(statar));
alert(JSON.stringify(sizar));
if(sizar[0]!=""){
//   const parts = sizar[1].match(/[a-zA-Z]+|[0-9]+/g);
//   const parts2 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
//   const parts3 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
  const parts4 = sizar[0].match(/[0-9]+/g);
  const parts5 = sizar[1].match(/[0-9]+/g);
  

  var lin=parts4[parts4.length-1].split('').pop();
  
            const lastIndex = sizar[0].split(lin);
            
const newStr = lastIndex[lastIndex.length - 1];

  var lin2=parts5[0].split('')[0];

  const lastIndex2 = sizar[1].split(lin2);

const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
// var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(parts4.join("/")+newStr)
var date1=new Date(parts4.join("/"));
var date2=new Date(parts5.join("/"));
var fdate=new Date(stats['ctime']);
// alert(JSON.stringify(date1+newStr+parts4.join(",")));
// alert(JSON.stringify(date2+newStr2+parts5.join(",")));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
try{
  if(eval(date1.getTime()+newStr+fdate.getTime())&&eval(fdate.getTime() +newStr2+date2.getTime())){
    var obj2={};
  
  obj2['filename']=`${filePath}`.split('/').pop();
  obj2['filepath']=`${filePath}`;
  obj2['background']="transparent";
  obj2['style']="solid";            
  obj2['keywords']="";
  obj2["ids"]=co;
  obj2["class"]=classn;
  obj2["page"]=curpage;  
  
    
              if(ex=="all"){
              fn.push(`${filePath}`)
              if(stats.isDirectory()){
                obj2['type']="folder";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
                
               
              }
              if(stats.isFile()){
                obj2['type']="file";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
              }
              
            }else if(ex =="folder"){
              if(stats.isDirectory()){
                obj2['type']="folder";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
                // fn.push(`${filePath}`)
              }
            }else{
              if(stats.isFile()){
                obj2['type']="file";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
                // fn.push(`${filePath}`)
              }
            }
    alert(JSON.stringify(fn))
  }}catch(e){alert(e)}
  // alert(sizar[1])
  // alert(sizar[0].split("b")[1])
}
else{
  const parts4 = sizar[0].match(/[0-9]+/g);
  const parts5 = sizar[1].match(/[0-9]+/g);
  

//   var lin=parts4[parts4.length-1].split('').pop();
  
//             const lastIndex = sizar[0].split(lin);
            
// const newStr = lastIndex[lastIndex.length - 1];

  var lin2=parts5[0].split('')[0];

  const lastIndex2 = sizar[1].split(lin2);

const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
// var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(parts4.join("/")+newStr)
// var date1=new Date(parts4.join("/"));
var date2=new Date(parts5.join("/"));
var fdate=new Date(stats['ctime']);
// alert(JSON.stringify(date1+newStr+parts4.join(",")));
alert(JSON.stringify(fdate.getTime() +newStr2+date2.getTime()));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
try{
  if(eval(fdate.getTime() +newStr2+date2.getTime())){
    var obj2={};
  
  obj2['filename']=`${filePath}`.split('/').pop();
  obj2['filepath']=`${filePath}`;
  obj2['background']="transparent";
  obj2['style']="solid";            
  obj2['keywords']="";
  obj2["ids"]=co;
  obj2["class"]=classn;
  obj2["page"]=curpage;  
  
    
              if(ex=="all"){
              fn.push(`${filePath}`)
              if(stats.isDirectory()){
                obj2['type']="folder";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
                
               
              }
              if(stats.isFile()){
                obj2['type']="file";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
              }
              
            }else if(ex =="folder"){
              if(stats.isDirectory()){
                obj2['type']="folder";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
                // fn.push(`${filePath}`)
              }
            }else{
              if(stats.isFile()){
                obj2['type']="file";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
                // fn.push(`${filePath}`)
              }
            }
    alert(JSON.stringify(fn))
  }}catch(e){alert(e)}
}
      }
      if(tc.includes("adate")){

var sizar= tc.split("adate");
// alert(JSON.stringify(statar));
alert(JSON.stringify(sizar));
if(sizar[0]!=""){
//   const parts = sizar[1].match(/[a-zA-Z]+|[0-9]+/g);
//   const parts2 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
//   const parts3 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
  const parts4 = sizar[0].match(/[0-9]+/g);
  const parts5 = sizar[1].match(/[0-9]+/g);
  

  var lin=parts4[parts4.length-1].split('').pop();
  
            const lastIndex = sizar[0].split(lin);
            
const newStr = lastIndex[lastIndex.length - 1];

  var lin2=parts5[0].split('')[0];

  const lastIndex2 = sizar[1].split(lin2);

const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
// var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(parts4.join("/")+newStr)
var date1=new Date(parts4.join("/"));
var date2=new Date(parts5.join("/"));
var fdate=new Date(stats['atime']);
// alert(JSON.stringify(date1+newStr+parts4.join(",")));
// alert(JSON.stringify(date2+newStr2+parts5.join(",")));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
try{
  if(eval(date1.getTime()+newStr+fdate.getTime())&&eval(fdate.getTime() +newStr2+date2.getTime())){
    var obj2={};
  
  obj2['filename']=`${filePath}`.split('/').pop();
  obj2['filepath']=`${filePath}`;
  obj2['background']="transparent";
  obj2['style']="solid";            
  obj2['keywords']="";
  obj2["ids"]=co;
  obj2["class"]=classn;
  obj2["page"]=curpage;  
  
    
              if(ex=="all"){
              fn.push(`${filePath}`)
              if(stats.isDirectory()){
                obj2['type']="folder";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
                
               
              }
              if(stats.isFile()){
                obj2['type']="file";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
              }
              
            }else if(ex =="folder"){
              if(stats.isDirectory()){
                obj2['type']="folder";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
                // fn.push(`${filePath}`)
              }
            }else{
              if(stats.isFile()){
                obj2['type']="file";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
                // fn.push(`${filePath}`)
              }
            }
    alert(JSON.stringify(fn))
  }}catch(e){alert(e)}
  // alert(sizar[1])
  // alert(sizar[0].split("b")[1])
}
else{
  const parts4 = sizar[0].match(/[0-9]+/g);
  const parts5 = sizar[1].match(/[0-9]+/g);
  

//   var lin=parts4[parts4.length-1].split('').pop();
  
//             const lastIndex = sizar[0].split(lin);
            
// const newStr = lastIndex[lastIndex.length - 1];

  var lin2=parts5[0].split('')[0];

  const lastIndex2 = sizar[1].split(lin2);

const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
// var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(parts4.join("/")+newStr)
// var date1=new Date(parts4.join("/"));
var date2=new Date(parts5.join("/"));
var fdate=new Date(stats['atime']);
// alert(JSON.stringify(date1+newStr+parts4.join(",")));
alert(JSON.stringify(fdate.getTime() +newStr2+date2.getTime()));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
try{
  if(eval(fdate.getTime() +newStr2+date2.getTime())){
    var obj2={};
  
  obj2['filename']=`${filePath}`.split('/').pop();
  obj2['filepath']=`${filePath}`;
  obj2['background']="transparent";
  obj2['style']="solid";            
  obj2['keywords']="";
  obj2["ids"]=co;
  obj2["class"]=classn;
  obj2["page"]=curpage;  
  
    
              if(ex=="all"){
              fn.push(`${filePath}`)
              if(stats.isDirectory()){
                obj2['type']="folder";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
                
               
              }
              if(stats.isFile()){
                obj2['type']="file";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
              }
              
            }else if(ex =="folder"){
              if(stats.isDirectory()){
                obj2['type']="folder";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
                // fn.push(`${filePath}`)
              }
            }else{
              if(stats.isFile()){
                obj2['type']="file";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
                // fn.push(`${filePath}`)
              }
            }
    alert(JSON.stringify(fn))
  }}catch(e){alert(e)}
}
      }
      if(tc.includes("mdate")){

var sizar= tc.split("mdate");
// alert(JSON.stringify(statar));
alert(JSON.stringify(sizar));
if(sizar[0]!=""){
//   const parts = sizar[1].match(/[a-zA-Z]+|[0-9]+/g);
//   const parts2 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
//   const parts3 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
  const parts4 = sizar[0].match(/[0-9]+/g);
  const parts5 = sizar[1].match(/[0-9]+/g);
  

  var lin=parts4[parts4.length-1].split('').pop();
  
            const lastIndex = sizar[0].split(lin);
            
const newStr = lastIndex[lastIndex.length - 1];

  var lin2=parts5[0].split('')[0];

  const lastIndex2 = sizar[1].split(lin2);

const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
// var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(parts4.join("/")+newStr)
var date1=new Date(parts4.join("/"));
var date2=new Date(parts5.join("/"));
var fdate=new Date(stats['mtime']);
// alert(JSON.stringify(date1+newStr+parts4.join(",")));
// alert(JSON.stringify(date2+newStr2+parts5.join(",")));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
try{
  if(eval(date1.getTime()+newStr+fdate.getTime())&&eval(fdate.getTime() +newStr2+date2.getTime())){
    var obj2={};
  
  obj2['filename']=`${filePath}`.split('/').pop();
  obj2['filepath']=`${filePath}`;
  obj2['background']="transparent";
  obj2['style']="solid";            
  obj2['keywords']="";
  obj2["ids"]=co;
  obj2["class"]=classn;
  obj2["page"]=curpage;  
  
    
              if(ex=="all"){
              fn.push(`${filePath}`)
              if(stats.isDirectory()){
                obj2['type']="folder";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
                
               
              }
              if(stats.isFile()){
                obj2['type']="file";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
              }
              
            }else if(ex =="folder"){
              if(stats.isDirectory()){
                obj2['type']="folder";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
                // fn.push(`${filePath}`)
              }
            }else{
              if(stats.isFile()){
                obj2['type']="file";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
                // fn.push(`${filePath}`)
              }
            }
    alert(JSON.stringify(fn))
  }}catch(e){alert(e)}
  // alert(sizar[1])
  // alert(sizar[0].split("b")[1])
}
else{
  const parts4 = sizar[0].match(/[0-9]+/g);
  const parts5 = sizar[1].match(/[0-9]+/g);
  

//   var lin=parts4[parts4.length-1].split('').pop();
  
//             const lastIndex = sizar[0].split(lin);
            
// const newStr = lastIndex[lastIndex.length - 1];

  var lin2=parts5[0].split('')[0];

  const lastIndex2 = sizar[1].split(lin2);

const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
// var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(parts4.join("/")+newStr)
// var date1=new Date(parts4.join("/"));
var date2=new Date(parts5.join("/"));
var fdate=new Date(stats['mtime']);
// alert(JSON.stringify(date1+newStr+parts4.join(",")));
alert(JSON.stringify(fdate.getTime() +newStr2+date2.getTime()));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
try{
  if(eval(fdate.getTime() +newStr2+date2.getTime())){
    var obj2={};
  
  obj2['filename']=`${filePath}`.split('/').pop();
  obj2['filepath']=`${filePath}`;
  obj2['background']="transparent";
  obj2['style']="solid";            
  obj2['keywords']="";
  obj2["ids"]=co;
  obj2["class"]=classn;
  obj2["page"]=curpage;  
  
    
              if(ex=="all"){
              fn.push(`${filePath}`)
              if(stats.isDirectory()){
                obj2['type']="folder";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
                
               
              }
              if(stats.isFile()){
                obj2['type']="file";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
              }
              
            }else if(ex =="folder"){
              if(stats.isDirectory()){
                obj2['type']="folder";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
                // fn.push(`${filePath}`)
              }
            }else{
              if(stats.isFile()){
                obj2['type']="file";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
                // fn.push(`${filePath}`)
              }
            }
    alert(JSON.stringify(fn))
  }}catch(e){alert(e)}
}
      }
      if(tc.includes("tag")){

var sizar= tc.split("tag").pop();
// alert(tc.replace("tag","keywords"))
alert(JSON.stringify(sizar.split("=").pop()))
var pf=arfile2.findIndex(obj => obj.filepath === `${filePath}`)

if(arfile2[pf]['keywords']==sizar.split("=").pop()){
  // alert(json)
  if(ex=="all"){
              fn.push(`${filePath}`)
            }else if(ex =="folder"){
              if(stats.isDirectory()){
                fn.push(`${filePath}`)
              }
            }else{
              if(stats.isFile()){
                fn.push(`${filePath}`)
              }
            }
  alert(JSON.stringify(fn))
}
// arfile4=ar
// file2.filter((e) => e.keywords == ex);
}
              }else{          var obj2={};
  
  obj2['filename']=`${filePath}`.split('/').pop();
  obj2['filepath']=`${filePath}`;
  obj2['background']="transparent";
  obj2['style']="solid";            
  obj2['keywords']="";
  obj2["ids"]=co;
  obj2["class"]=classn;
  obj2["page"]=curpage;  
  
    
              if(ex=="all"){
              fn.push(`${filePath}`)
              if(stats.isDirectory()){
                obj2['type']="folder";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
                
               
              }
              if(stats.isFile()){
                obj2['type']="file";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
              }
              
            }else if(ex =="folder"){
              if(stats.isDirectory()){
                obj2['type']="folder";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
                // fn.push(`${filePath}`)
              }
            }else{
              if(stats.isFile()){
                obj2['type']="file";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
                // fn.push(`${filePath}`)
              }
            }
                
                alert(JSON.stringify(fn))
              }
statar.push(stats)
    // alert(abbreviateNumber(stats.size));
// }).then((d) => {alert("dsjjn")});;
    }
  }else{
    ////


    ///
    var filePath =testFolder+"/"+filep;
        
        // alert(filePath)
        // fs.stat(filePath, function(err, stats) {
          var stats = fs.statSync(filePath)
                // alert(JSON.stringify(stats))
                var ppt=filePath
                if(fl2.includes("by")){
                var tc=eval(fl[fl2.indexOf("by")]);
              
                if(tc.includes("size")){
          var sizar= tc.split("size");
          // alert(JSON.stringify(sizar));
          // alert(JSON.stringify(arfile3[i]))
          if(sizar[0]!=""){
            const parts = sizar[1].match(/[a-zA-Z]+|[0-9]+/g);
            const parts2 = sizar[0].split("b")[1].match(/[a-zA-Z]+|[0-9]+/g);
            const parts3 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
            const parts4 = sizar[0].match(/[0-9]+/g);
            const parts5 = sizar[1].match(/[0-9]+/g);
            // var lin=parts3[parts3.length-1].split('').pop();
            
//             const lastIndex = sizar[0].split(lin);
// const newStr = lastIndex[lastIndex.length - 1];

            var lin2=parts[0].split('')[0];

            const lastIndex2 = sizar[1].split(lin2);
            
const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(JSON.stringify(sizsame +sizar[0].split("b")[1]+parts4.join(".")));
// alert(JSON.stringify(sizsame2 +newStr2+parts5.join(".")));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
// alert(sizar[0]+"dso")
try{
// if(sizar[0]==""){
  // alert(sizar[0]+"dso")

// }else{
  if(eval(parts4.join(".")+sizar[0].split("b")[1]+sizsame ) &&eval(sizsame2 +newStr2+parts5.join("."))){
              // alert(JSON.stringify(abbreviateNumber(stats['size']))+"e")
              // if(){
// alert(JSON.stringify(`Path file: ${filePath}`))
              // alert(JSON.stringify(abbreviateNumber(stats['size'])))
               var obj2={};
  
  obj2['filename']=`${filePath}`.split('/').pop();
  obj2['filepath']=`${filePath}`;
  obj2['background']="transparent";
  obj2['style']="solid";            
  obj2['keywords']="";
  obj2["ids"]=co;
  obj2["class"]=classn;
  obj2["page"]=curpage;  
  
    
              if(ex=="all"){
              fn.push(`${filePath}`)
              if(stats.isDirectory()){
                obj2['type']="folder";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
                
               
              }
              if(stats.isFile()){
                obj2['type']="file";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
              }
              
            }else if(ex =="folder"){
              if(stats.isDirectory()){
                obj2['type']="folder";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
                // fn.push(`${filePath}`)
              }
            }else{
              if(stats.isFile()){
                obj2['type']="file";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
                // fn.push(`${filePath}`)
              }
            }
            
              
              const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              // alert(json/)
              var arfil=arfile.filter((e) => e.keywords == "skak");
              alert(JSON.stringify(arfil)+" lplplp")
              alert(JSON.stringify(fn))
              // alert(stats.isDirectory())
              // alert(ex)
              // alert(stats.isFile()+" d")
            // }
            }
// }
          
          }catch(e){alert(e)}
            // alert(sizar[1])
            // get("all").thatcontain("jpg").by("3,5mb<size<4,2mb")
          }else{

            const parts = sizar[1].match(/[a-zA-Z]+|[0-9]+/g);
            // const parts2 = sizar[0].split("b")[1].match(/[a-zA-Z]+|[0-9]+/g);
            // const parts3 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
            // const parts4 = sizar[0].match(/[0-9]+/g);
            const parts5 = sizar[1].match(/[0-9]+/g);
            // var lin=parts3[parts3.length-1].split('').pop();
            
//             const lastIndex = sizar[0].split(lin);
// const newStr = lastIndex[lastIndex.length - 1];
            var lin2=parts[0].split('')[0];

            const lastIndex2 = sizar[1].split(lin2);
            
const newStr2 = lastIndex2[0];

 
// alert(parts5.join(","))
var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
alert(JSON.stringify(sizsame2 +newStr2+parts5.join(".")+"sdk"));
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(JSON.stringify(sizsame +sizar[0].split("b")[1]+parts4.join(".")));
// alert(JSON.stringify(sizsame2 +newStr2+parts5.join(".")));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
// try{
            if(eval(sizsame2 +newStr2+parts5.join("."))){
              // alert(JSON.stringify(abbreviateNumber(stats['size']))+"e")
              // if(){
// alert(JSON.stringify(`Path file: ${filePath}`))
              // alert(JSON.stringify(abbreviateNumber(stats['size'])))
              var obj2={};
  
  obj2['filename']=`${filePath}`.split('/').pop();
  obj2['filepath']=`${filePath}`;
  obj2['background']="transparent";
  obj2['style']="solid";            
  obj2['keywords']="";
  obj2["ids"]=co;
  obj2["class"]=classn;
  obj2["page"]=curpage;  
  
    
              if(ex=="all"){
              fn.push(`${filePath}`)
              if(stats.isDirectory()){
                obj2['type']="folder";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
                
               
              }
              if(stats.isFile()){
                obj2['type']="file";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
              }
              
            }else if(ex =="folder"){
              if(stats.isDirectory()){
                obj2['type']="folder";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
                // fn.push(`${filePath}`)
              }
            }else{
              if(stats.isFile()){
                obj2['type']="file";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
                // fn.push(`${filePath}`)
              }
            }
              alert(JSON.stringify(fn))
            // }
            }
//           }catch(e){alert(e)}
            // alert(sizar[1])
            // get("all").thatcontain("jpg").by("3,5mb<size<4,2mb")
        
          }
          // alert(JSON.stringify(fn))
          // var adff=fn2.filter((e) => abbreviateNumber(e.size) == tc);
        }
        if(tc.includes("cdate")){

var sizar= tc.split("cdate");
// alert(JSON.stringify(statar));
alert(JSON.stringify(sizar));
if(sizar[0]!=""){
//   const parts = sizar[1].match(/[a-zA-Z]+|[0-9]+/g);
//   const parts2 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
//   const parts3 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
  const parts4 = sizar[0].match(/[0-9]+/g);
  const parts5 = sizar[1].match(/[0-9]+/g);
  

  var lin=parts4[parts4.length-1].split('').pop();
  
            const lastIndex = sizar[0].split(lin);
            
const newStr = lastIndex[lastIndex.length - 1];

  var lin2=parts5[0].split('')[0];

  const lastIndex2 = sizar[1].split(lin2);

const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
// var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(parts4.join("/")+newStr)
var date1=new Date(parts4.join("/"));
var date2=new Date(parts5.join("/"));
var fdate=new Date(stats['ctime']);
// alert(JSON.stringify(date1+newStr+parts4.join(",")));
// alert(JSON.stringify(date2+newStr2+parts5.join(",")));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
try{
  if(eval(date1.getTime()+newStr+fdate.getTime())&&eval(fdate.getTime() +newStr2+date2.getTime())){
    var obj2={};
  
  obj2['filename']=`${filePath}`.split('/').pop();
  obj2['filepath']=`${filePath}`;
  obj2['background']="transparent";
  obj2['style']="solid";            
  obj2['keywords']="";
  obj2["ids"]=co;
  obj2["class"]=classn;
  obj2["page"]=curpage;  
  
    
              if(ex=="all"){
              fn.push(`${filePath}`)
              if(stats.isDirectory()){
                obj2['type']="folder";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
                
               
              }
              if(stats.isFile()){
                obj2['type']="file";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
              }
              
            }else if(ex =="folder"){
              if(stats.isDirectory()){
                obj2['type']="folder";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
                // fn.push(`${filePath}`)
              }
            }else{
              if(stats.isFile()){
                obj2['type']="file";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
                // fn.push(`${filePath}`)
              }
            }
    alert(JSON.stringify(fn))
  }}catch(e){alert(e)}
  // alert(sizar[1])
  // alert(sizar[0].split("b")[1])
}
else{
  const parts4 = sizar[0].match(/[0-9]+/g);
  const parts5 = sizar[1].match(/[0-9]+/g);
  

//   var lin=parts4[parts4.length-1].split('').pop();
  
//             const lastIndex = sizar[0].split(lin);
            
// const newStr = lastIndex[lastIndex.length - 1];

  var lin2=parts5[0].split('')[0];

  const lastIndex2 = sizar[1].split(lin2);

const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
// var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(parts4.join("/")+newStr)
// var date1=new Date(parts4.join("/"));
var date2=new Date(parts5.join("/"));
var fdate=new Date(stats['ctime']);
// alert(JSON.stringify(date1+newStr+parts4.join(",")));
alert(JSON.stringify(fdate.getTime() +newStr2+date2.getTime()));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
try{
  if(eval(fdate.getTime() +newStr2+date2.getTime())){
    var obj2={};
  
  obj2['filename']=`${filePath}`.split('/').pop();
  obj2['filepath']=`${filePath}`;
  obj2['background']="transparent";
  obj2['style']="solid";            
  obj2['keywords']="";
  obj2["ids"]=co;
  obj2["class"]=classn;
  obj2["page"]=curpage;  
  
    
              if(ex=="all"){
              fn.push(`${filePath}`)
              if(stats.isDirectory()){
                obj2['type']="folder";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
                
               
              }
              if(stats.isFile()){
                obj2['type']="file";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
              }
              
            }else if(ex =="folder"){
              if(stats.isDirectory()){
                obj2['type']="folder";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
                // fn.push(`${filePath}`)
              }
            }else{
              if(stats.isFile()){
                obj2['type']="file";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
                // fn.push(`${filePath}`)
              }
            }
    alert(JSON.stringify(fn))
  }}catch(e){alert(e)}
}
      }
      if(tc.includes("adate")){

var sizar= tc.split("adate");
// alert(JSON.stringify(statar));
alert(JSON.stringify(sizar));
if(sizar[0]!=""){
//   const parts = sizar[1].match(/[a-zA-Z]+|[0-9]+/g);
//   const parts2 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
//   const parts3 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
  const parts4 = sizar[0].match(/[0-9]+/g);
  const parts5 = sizar[1].match(/[0-9]+/g);
  

  var lin=parts4[parts4.length-1].split('').pop();
  
            const lastIndex = sizar[0].split(lin);
            
const newStr = lastIndex[lastIndex.length - 1];

  var lin2=parts5[0].split('')[0];

  const lastIndex2 = sizar[1].split(lin2);

const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
// var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(parts4.join("/")+newStr)
var date1=new Date(parts4.join("/"));
var date2=new Date(parts5.join("/"));
var fdate=new Date(stats['atime']);
// alert(JSON.stringify(date1+newStr+parts4.join(",")));
// alert(JSON.stringify(date2+newStr2+parts5.join(",")));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
try{
  if(eval(date1.getTime()+newStr+fdate.getTime())&&eval(fdate.getTime() +newStr2+date2.getTime())){
    var obj2={};
  
  obj2['filename']=`${filePath}`.split('/').pop();
  obj2['filepath']=`${filePath}`;
  obj2['background']="transparent";
  obj2['style']="solid";            
  obj2['keywords']="";
  obj2["ids"]=co;
  obj2["class"]=classn;
  obj2["page"]=curpage;  
  
    
              if(ex=="all"){
              fn.push(`${filePath}`)
              if(stats.isDirectory()){
                obj2['type']="folder";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
                
               
              }
              if(stats.isFile()){
                obj2['type']="file";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
              }
              
            }else if(ex =="folder"){
              if(stats.isDirectory()){
                obj2['type']="folder";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
                // fn.push(`${filePath}`)
              }
            }else{
              if(stats.isFile()){
                obj2['type']="file";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
                // fn.push(`${filePath}`)
              }
            }
    alert(JSON.stringify(fn))
  }}catch(e){alert(e)}
  // alert(sizar[1])
  // alert(sizar[0].split("b")[1])
}
else{
  const parts4 = sizar[0].match(/[0-9]+/g);
  const parts5 = sizar[1].match(/[0-9]+/g);
  

//   var lin=parts4[parts4.length-1].split('').pop();
  
//             const lastIndex = sizar[0].split(lin);
            
// const newStr = lastIndex[lastIndex.length - 1];

  var lin2=parts5[0].split('')[0];

  const lastIndex2 = sizar[1].split(lin2);

const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
// var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(parts4.join("/")+newStr)
// var date1=new Date(parts4.join("/"));
var date2=new Date(parts5.join("/"));
var fdate=new Date(stats['atime']);
// alert(JSON.stringify(date1+newStr+parts4.join(",")));
alert(JSON.stringify(fdate.getTime() +newStr2+date2.getTime()));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
try{
  if(eval(fdate.getTime() +newStr2+date2.getTime())){
    var obj2={};
  
  obj2['filename']=`${filePath}`.split('/').pop();
  obj2['filepath']=`${filePath}`;
  obj2['background']="transparent";
  obj2['style']="solid";            
  obj2['keywords']="";
  obj2["ids"]=co;
  obj2["class"]=classn;
  obj2["page"]=curpage;  
  
    
              if(ex=="all"){
              fn.push(`${filePath}`)
              if(stats.isDirectory()){
                obj2['type']="folder";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
                
               
              }
              if(stats.isFile()){
                obj2['type']="file";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
              }
              
            }else if(ex =="folder"){
              if(stats.isDirectory()){
                obj2['type']="folder";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
                // fn.push(`${filePath}`)
              }
            }else{
              if(stats.isFile()){
                obj2['type']="file";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
                // fn.push(`${filePath}`)
              }
            }
    alert(JSON.stringify(fn))
  }}catch(e){alert(e)}
}
      }
      if(tc.includes("mdate")){

var sizar= tc.split("mdate");
// alert(JSON.stringify(statar));
alert(JSON.stringify(sizar));
if(sizar[0]!=""){
//   const parts = sizar[1].match(/[a-zA-Z]+|[0-9]+/g);
//   const parts2 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
//   const parts3 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
  const parts4 = sizar[0].match(/[0-9]+/g);
  const parts5 = sizar[1].match(/[0-9]+/g);
  

  var lin=parts4[parts4.length-1].split('').pop();
  
            const lastIndex = sizar[0].split(lin);
            
const newStr = lastIndex[lastIndex.length - 1];

  var lin2=parts5[0].split('')[0];

  const lastIndex2 = sizar[1].split(lin2);

const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
// var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(parts4.join("/")+newStr)
var date1=new Date(parts4.join("/"));
var date2=new Date(parts5.join("/"));
var fdate=new Date(stats['mtime']);
// alert(JSON.stringify(date1+newStr+parts4.join(",")));
// alert(JSON.stringify(date2+newStr2+parts5.join(",")));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
try{
  if(eval(date1.getTime()+newStr+fdate.getTime())&&eval(fdate.getTime() +newStr2+date2.getTime())){
    var obj2={};
  
  obj2['filename']=`${filePath}`.split('/').pop();
  obj2['filepath']=`${filePath}`;
  obj2['background']="transparent";
  obj2['style']="solid";            
  obj2['keywords']="";
  obj2["ids"]=co;
  obj2["class"]=classn;
  obj2["page"]=curpage;  
  
    
              if(ex=="all"){
              fn.push(`${filePath}`)
              if(stats.isDirectory()){
                obj2['type']="folder";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
                
               
              }
              if(stats.isFile()){
                obj2['type']="file";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
              }
              
            }else if(ex =="folder"){
              if(stats.isDirectory()){
                obj2['type']="folder";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
                // fn.push(`${filePath}`)
              }
            }else{
              if(stats.isFile()){
                obj2['type']="file";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
                // fn.push(`${filePath}`)
              }
            }
    alert(JSON.stringify(fn))
  }}catch(e){alert(e)}
  // alert(sizar[1])
  // alert(sizar[0].split("b")[1])
}
else{
  const parts4 = sizar[0].match(/[0-9]+/g);
  const parts5 = sizar[1].match(/[0-9]+/g);
  

//   var lin=parts4[parts4.length-1].split('').pop();
  
//             const lastIndex = sizar[0].split(lin);
            
// const newStr = lastIndex[lastIndex.length - 1];

  var lin2=parts5[0].split('')[0];

  const lastIndex2 = sizar[1].split(lin2);

const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
// var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(parts4.join("/")+newStr)
// var date1=new Date(parts4.join("/"));
var date2=new Date(parts5.join("/"));
var fdate=new Date(stats['mtime']);
// alert(JSON.stringify(date1+newStr+parts4.join(",")));
alert(JSON.stringify(fdate.getTime() +newStr2+date2.getTime()));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
try{
  if(eval(fdate.getTime() +newStr2+date2.getTime())){
    var obj2={};
  
  obj2['filename']=`${filePath}`.split('/').pop();
  obj2['filepath']=`${filePath}`;
  obj2['background']="transparent";
  obj2['style']="solid";            
  obj2['keywords']="";
  obj2["ids"]=co;
  obj2["class"]=classn;
  obj2["page"]=curpage;  
  
    
              if(ex=="all"){
              fn.push(`${filePath}`)
              if(stats.isDirectory()){
                obj2['type']="folder";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
                
               
              }
              if(stats.isFile()){
                obj2['type']="file";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
              }
              
            }else if(ex =="folder"){
              if(stats.isDirectory()){
                obj2['type']="folder";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
                // fn.push(`${filePath}`)
              }
            }else{
              if(stats.isFile()){
                obj2['type']="file";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
                // fn.push(`${filePath}`)
              }
            }
    alert(JSON.stringify(fn))
  }}catch(e){alert(e)}
}
      }
      if(tc.includes("tag")){

var sizar= tc.split("tag").pop();
// alert(tc.replace("tag","keywords"))
alert(JSON.stringify(sizar.split("=").pop()))
var pf=arfile2.findIndex(obj => obj.filepath === `${filePath}`)

if(arfile2[pf]['keywords']==sizar.split("=").pop()){
  // alert(json)
  if(ex=="all"){
              fn.push(`${filePath}`)
            }else if(ex =="folder"){
              if(stats.isDirectory()){
                fn.push(`${filePath}`)
              }
            }else{
              if(stats.isFile()){
                fn.push(`${filePath}`)
              }
            }
  alert(JSON.stringify(fn))
}
// arfile4=ar
// file2.filter((e) => e.keywords == ex);
}
              }else{          var obj2={};
  
  obj2['filename']=`${filePath}`.split('/').pop();
  obj2['filepath']=`${filePath}`;
  obj2['background']="transparent";
  obj2['style']="solid";            
  obj2['keywords']="";
  obj2["ids"]=co;
  obj2["class"]=classn;
  obj2["page"]=curpage;  
  
    
              if(ex=="all"){
              fn.push(`${filePath}`)
              if(stats.isDirectory()){
                obj2['type']="folder";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
                
               
              }
              if(stats.isFile()){
                obj2['type']="file";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
              }
              
            }else if(ex =="folder"){
              if(stats.isDirectory()){
                obj2['type']="folder";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
                // fn.push(`${filePath}`)
              }
            }else{
              if(stats.isFile()){
                obj2['type']="file";
                if(!arfimap.includes(`${filePath}`)){
                arfile.push(obj2);
                co++
                }
                // fn.push(`${filePath}`)
              }
            }
                
                alert(JSON.stringify(fn))
              }
  statar.push(stats)
      // alert(abbreviateNumber(stats.size));
  // });
  }
              // obj['filename']=d[i];
              // if(ex=="all"){

              // }else if(ex=="file"){

              // }else if(ex=="folder"){

              // }
              
              p.push(testFolder+"/"+d[i]);
            });
  
  
  
    
   
            
        
  
  }).then((d) => {
    alert("njnj")
    startapp();
  });
 

    }else{
      var ex=eval(fl[fl2.indexOf("get")])
      // alert(ex)
      if(ex=="all"){
        var arfile2=arfile;
      }else{
        var arfile2=arfile.filter((e) => e.type == ex);
      }
      var co=0;
          var arfile21=arfile.filter((e) => e.page == curpage);
 
//  var classn=flnm.value;
var classn="Class";
var arfile31=arfile21.filter((e) => e.class == classn);
var arfimap=arfile31.map((e) => e.filepath);
co=arfile31.length;
      if(fl2.includes("thatcontain")){
        var arfile3 = arfile2.map(a => a.filepath);
        var tc=eval(fl[fl2.indexOf("thatcontain")]).toString()
        // alert(JSON.stringify(tc))
        var cts=0;
        var fcn=0;
        arfile3.forEach(filePath => {
          // alert("plk")
          if(filePath.includes(tc)){
            // alert(JSON.stringify(arfile3[i]))
            // try{
            fcn++;
//from("/home/lawliet/Downloads/tutorina/aja").get("all").thatcontain("jpg").by("3,5mb<size<4,2mb")
// }catch(e){alert(e)}
            fs.stat(filePath, function(err, stats) {
              cts++
            // alert("pp")
            //   var stats = fs.statSync(`${filePath}`)
            // alert("dsk")
              // alert(JSON.stringify(stats))
              var ppt=filePath
              if(fl2.includes("by")){
                var tc=eval(fl[fl2.indexOf("by")]);
              
                if(tc.includes("size")){
          var sizar= tc.split("size");
          // alert(JSON.stringify(sizar));
          // alert(JSON.stringify(arfile3[i]))
          if(sizar[0]!=""){
            const parts = sizar[1].match(/[a-zA-Z]+|[0-9]+/g);
            const parts2 = sizar[0].split("b")[1].match(/[a-zA-Z]+|[0-9]+/g);
            const parts3 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
            const parts4 = sizar[0].match(/[0-9]+/g);
            const parts5 = sizar[1].match(/[0-9]+/g);
            // var lin=parts3[parts3.length-1].split('').pop();
            
//             const lastIndex = sizar[0].split(lin);
// const newStr = lastIndex[lastIndex.length - 1];

            var lin2=parts[0].split('')[0];

            const lastIndex2 = sizar[1].split(lin2);
            
const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(JSON.stringify(sizsame +sizar[0].split("b")[1]+parts4.join(".")));
// alert(JSON.stringify(sizsame2 +newStr2+parts5.join(".")));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
// alert(sizar[0]+"dso")
try{
// if(sizar[0]==""){
  // alert(sizar[0]+"dso")

// }else{
  if(eval(parts4.join(".")+sizar[0].split("b")[1]+sizsame ) &&eval(sizsame2 +newStr2+parts5.join("."))){
              // alert(JSON.stringify(abbreviateNumber(stats['size']))+"e")
              // if(){
// alert(JSON.stringify(`Path file: ${filePath}`))
              // alert(JSON.stringify(abbreviateNumber(stats['size'])))
              fn.push(`${filePath}`)
              
              const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(!arfimap.includes(`${filePath}`)){
              arfile[index]["class"]=classn;
              arfile[index]["ids"]=co;
              arfile[index]["page"]=curpage;
              co++
              }
              // alert(json/)
              alert(JSON.stringify(arfile[index])+" sdjnjnj")
            // }
            }
// }
          
          }catch(e){alert(e)}
            // alert(sizar[1])
            // get("all").thatcontain("jpg").by("3,5mb<size<4,2mb")
          }else{

            const parts = sizar[1].match(/[a-zA-Z]+|[0-9]+/g);
            // const parts2 = sizar[0].split("b")[1].match(/[a-zA-Z]+|[0-9]+/g);
            // const parts3 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
            // const parts4 = sizar[0].match(/[0-9]+/g);
            const parts5 = sizar[1].match(/[0-9]+/g);
            // var lin=parts3[parts3.length-1].split('').pop();
            
//             const lastIndex = sizar[0].split(lin);
// const newStr = lastIndex[lastIndex.length - 1];
            var lin2=parts[0].split('')[0];

            const lastIndex2 = sizar[1].split(lin2);
            
const newStr2 = lastIndex2[0];

 
// alert(parts5.join(","))
var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
alert(JSON.stringify(sizsame2 +newStr2+parts5.join(".")+"sdk"));
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(JSON.stringify(sizsame +sizar[0].split("b")[1]+parts4.join(".")));
// alert(JSON.stringify(sizsame2 +newStr2+parts5.join(".")));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
// try{
            if(eval(sizsame2 +newStr2+parts5.join("."))){
              // alert(JSON.stringify(abbreviateNumber(stats['size']))+"e")
              // if(){
// alert(JSON.stringify(`Path file: ${filePath}`))
              // alert(JSON.stringify(abbreviateNumber(stats['size'])))
              const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(!arfimap.includes(`${filePath}`)){
              arfile[index]["class"]=classn;
              arfile[index]["ids"]=co;
              arfile[index]["page"]=curpage;
              co++
              }
              alert(JSON.stringify(fn))
            // }
            }
//           }catch(e){alert(e)}
            // alert(sizar[1])
            // get("all").thatcontain("jpg").by("3,5mb<size<4,2mb")
        
          }
          // alert(JSON.stringify(fn))
          // var adff=fn2.filter((e) => abbreviateNumber(e.size) == tc);
        }
        if(tc.includes("cdate")){

var sizar= tc.split("cdate");
// alert(JSON.stringify(statar));
alert(JSON.stringify(sizar));
if(sizar[0]!=""){
//   const parts = sizar[1].match(/[a-zA-Z]+|[0-9]+/g);
//   const parts2 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
//   const parts3 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
  const parts4 = sizar[0].match(/[0-9]+/g);
  const parts5 = sizar[1].match(/[0-9]+/g);
  

  var lin=parts4[parts4.length-1].split('').pop();
  
            const lastIndex = sizar[0].split(lin);
            
const newStr = lastIndex[lastIndex.length - 1];

  var lin2=parts5[0].split('')[0];

  const lastIndex2 = sizar[1].split(lin2);

const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
// var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(parts4.join("/")+newStr)
var date1=new Date(parts4.join("/"));
var date2=new Date(parts5.join("/"));
var fdate=new Date(stats['ctime']);
// alert(JSON.stringify(date1+newStr+parts4.join(",")));
// alert(JSON.stringify(date2+newStr2+parts5.join(",")));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
try{
  if(eval(date1.getTime()+newStr+fdate.getTime())&&eval(fdate.getTime() +newStr2+date2.getTime())){
    alert((fdate));
    const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(!arfimap.includes(`${filePath}`)){
              arfile[index]["class"]=classn;
              arfile[index]["ids"]=co;
              arfile[index]["page"]=curpage;
              co++
              }
  }}catch(e){alert(e)}
  // alert(sizar[1])
  // alert(sizar[0].split("b")[1])
}
else{
  const parts4 = sizar[0].match(/[0-9]+/g);
  const parts5 = sizar[1].match(/[0-9]+/g);
  

//   var lin=parts4[parts4.length-1].split('').pop();
  
//             const lastIndex = sizar[0].split(lin);
            
// const newStr = lastIndex[lastIndex.length - 1];

  var lin2=parts5[0].split('')[0];

  const lastIndex2 = sizar[1].split(lin2);

const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
// var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(parts4.join("/")+newStr)
// var date1=new Date(parts4.join("/"));
var date2=new Date(parts5.join("/"));
var fdate=new Date(stats['ctime']);
// alert(JSON.stringify(date1+newStr+parts4.join(",")));
alert(JSON.stringify(fdate.getTime() +newStr2+date2.getTime()));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
try{
  if(eval(fdate.getTime() +newStr2+date2.getTime())){
    alert((fdate));
    const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(!arfimap.includes(`${filePath}`)){
              arfile[index]["class"]=classn;
              arfile[index]["ids"]=co;
              arfile[index]["page"]=curpage;
              co++
              }
  }}catch(e){alert(e)}
}
      }
      if(tc.includes("adate")){

var sizar= tc.split("adate");
// alert(JSON.stringify(statar));
alert(JSON.stringify(sizar));
if(sizar[0]!=""){
//   const parts = sizar[1].match(/[a-zA-Z]+|[0-9]+/g);
//   const parts2 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
//   const parts3 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
  const parts4 = sizar[0].match(/[0-9]+/g);
  const parts5 = sizar[1].match(/[0-9]+/g);
  

  var lin=parts4[parts4.length-1].split('').pop();
  
            const lastIndex = sizar[0].split(lin);
            
const newStr = lastIndex[lastIndex.length - 1];

  var lin2=parts5[0].split('')[0];

  const lastIndex2 = sizar[1].split(lin2);

const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
// var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(parts4.join("/")+newStr)
var date1=new Date(parts4.join("/"));
var date2=new Date(parts5.join("/"));
var fdate=new Date(stats['atime']);
// alert(JSON.stringify(date1+newStr+parts4.join(",")));
// alert(JSON.stringify(date2+newStr2+parts5.join(",")));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
try{
  if(eval(date1.getTime()+newStr+fdate.getTime())&&eval(fdate.getTime() +newStr2+date2.getTime())){
    alert((fdate));
    const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(!arfimap.includes(`${filePath}`)){
              arfile[index]["class"]=classn;
              arfile[index]["ids"]=co;
              arfile[index]["page"]=curpage;
              co++
              }
  }}catch(e){alert(e)}
  // alert(sizar[1])
  // alert(sizar[0].split("b")[1])
}
else{
  const parts4 = sizar[0].match(/[0-9]+/g);
  const parts5 = sizar[1].match(/[0-9]+/g);
  

//   var lin=parts4[parts4.length-1].split('').pop();
  
//             const lastIndex = sizar[0].split(lin);
            
// const newStr = lastIndex[lastIndex.length - 1];

  var lin2=parts5[0].split('')[0];

  const lastIndex2 = sizar[1].split(lin2);

const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
// var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(parts4.join("/")+newStr)
// var date1=new Date(parts4.join("/"));
var date2=new Date(parts5.join("/"));
var fdate=new Date(stats['atime']);
// alert(JSON.stringify(date1+newStr+parts4.join(",")));
alert(JSON.stringify(fdate.getTime() +newStr2+date2.getTime()));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
try{
  if(eval(fdate.getTime() +newStr2+date2.getTime())){
    alert((fdate));
    const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(!arfimap.includes(`${filePath}`)){
              arfile[index]["class"]=classn;
              arfile[index]["ids"]=co;
              arfile[index]["page"]=curpage;
              co++
              }
  }}catch(e){alert(e)}
}
      }
      if(tc.includes("mdate")){

var sizar= tc.split("mdate");
// alert(JSON.stringify(statar));
alert(JSON.stringify(sizar));
if(sizar[0]!=""){
//   const parts = sizar[1].match(/[a-zA-Z]+|[0-9]+/g);
//   const parts2 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
//   const parts3 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
  const parts4 = sizar[0].match(/[0-9]+/g);
  const parts5 = sizar[1].match(/[0-9]+/g);
  

  var lin=parts4[parts4.length-1].split('').pop();
  
            const lastIndex = sizar[0].split(lin);
            
const newStr = lastIndex[lastIndex.length - 1];

  var lin2=parts5[0].split('')[0];

  const lastIndex2 = sizar[1].split(lin2);

const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
// var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(parts4.join("/")+newStr)
var date1=new Date(parts4.join("/"));
var date2=new Date(parts5.join("/"));
var fdate=new Date(stats['mtime']);
// alert(JSON.stringify(date1+newStr+parts4.join(",")));
// alert(JSON.stringify(date2+newStr2+parts5.join(",")));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
try{
  if(eval(date1.getTime()+newStr+fdate.getTime())&&eval(fdate.getTime() +newStr2+date2.getTime())){
    alert((fdate));
    const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(!arfimap.includes(`${filePath}`)){
              arfile[index]["class"]=classn;
              arfile[index]["ids"]=co;
              arfile[index]["page"]=curpage;
              co++
              }
  }}catch(e){alert(e)}
  // alert(sizar[1])
  // alert(sizar[0].split("b")[1])
}
else{
  const parts4 = sizar[0].match(/[0-9]+/g);
  const parts5 = sizar[1].match(/[0-9]+/g);
  

//   var lin=parts4[parts4.length-1].split('').pop();
  
//             const lastIndex = sizar[0].split(lin);
            
// const newStr = lastIndex[lastIndex.length - 1];

  var lin2=parts5[0].split('')[0];

  const lastIndex2 = sizar[1].split(lin2);

const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
// var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(parts4.join("/")+newStr)
// var date1=new Date(parts4.join("/"));
var date2=new Date(parts5.join("/"));
var fdate=new Date(stats['mtime']);
// alert(JSON.stringify(date1+newStr+parts4.join(",")));
alert(JSON.stringify(fdate.getTime() +newStr2+date2.getTime()));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
try{
  if(eval(fdate.getTime() +newStr2+date2.getTime())){
    alert((fdate));
    const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(!arfimap.includes(`${filePath}`)){
              arfile[index]["class"]=classn;
              arfile[index]["ids"]=co;
              arfile[index]["page"]=curpage;
              co++
              }
  }}catch(e){alert(e)}
}
      }
      if(tc.includes("tag")){

var sizar= tc.split("tag").pop();
// alert(tc.replace("tag","keywords"))
alert(JSON.stringify(sizar.split("=").pop()))
var pf=arfile2.findIndex(obj => obj.filepath === `${filePath}`)

if(arfile2[pf]['keywords']==sizar.split("=").pop()){
  // alert(json)
  const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(!arfimap.includes(`${filePath}`)){
              arfile[index]["class"]=classn;
              arfile[index]["ids"]=co;
              arfile[index]["page"]=curpage;
              co++
              }
  alert(JSON.stringify(fn))
}
// arfile4=ar
// file2.filter((e) => e.keywords == ex);
}
              }else{
                const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(!arfimap.includes(`${filePath}`)){
              arfile[index]["class"]=classn;
              arfile[index]["ids"]=co;
              arfile[index]["page"]=curpage;
              co++
              }
              }
statar.push(stats)
    // alert(abbreviateNumber(stats.size));
    alert(cts +"d "+fcn)
    if(cts==fcn){
      startapp();
      alert("finish")
    }
});

            // fn.push(arfile2[i]);
          }
        });
    //  alert("sklo")
    // startapp()
      }else{
        if(fl2.includes("by")){
        var arfile3 = arfile2.map(a => a.filepath);
        var tc=eval(fl[fl2.indexOf("by")]).toString()
        alert(JSON.stringify(tc))
        var cts=0;
        var fcn=0;
        arfile3.forEach(filePath => {
          
            // alert(JSON.stringify(arfile3[i]))
            // try{
              fcn++;
// }catch(e){alert(e)}
            fs.stat(filePath, function(err, stats) {
              // var stats = fs.statSync(filePath)
              // alert(JSON.stringify(stats))
              cts++
              var ppt=filePath
              if(fl2.includes("by")){
                var tc=eval(fl[fl2.indexOf("by")]);
              
                if(tc.includes("size")){
          var sizar= tc.split("size");
          // alert(JSON.stringify(sizar));
          // alert(JSON.stringify(arfile3[i]))
          if(sizar[0]!=""){
            const parts = sizar[1].match(/[a-zA-Z]+|[0-9]+/g);
            const parts2 = sizar[0].split("b")[1].match(/[a-zA-Z]+|[0-9]+/g);
            const parts3 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
            const parts4 = sizar[0].match(/[0-9]+/g);
            const parts5 = sizar[1].match(/[0-9]+/g);
            // var lin=parts3[parts3.length-1].split('').pop();
            
//             const lastIndex = sizar[0].split(lin);
// const newStr = lastIndex[lastIndex.length - 1];

            var lin2=parts[0].split('')[0];

            const lastIndex2 = sizar[1].split(lin2);
            
const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(JSON.stringify(sizsame +sizar[0].split("b")[1]+parts4.join(".")));
// alert(JSON.stringify(sizsame2 +newStr2+parts5.join(".")));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
// alert(sizar[0]+"dso")
try{
// if(sizar[0]==""){
  // alert(sizar[0]+"dso")

// }else{
  if(eval(parts4.join(".")+sizar[0].split("b")[1]+sizsame ) &&eval(sizsame2 +newStr2+parts5.join("."))){
              // alert(JSON.stringify(abbreviateNumber(stats['size']))+"e")
              // if(){
// alert(JSON.stringify(`Path file: ${filePath}`))
              // alert(JSON.stringify(abbreviateNumber(stats['size'])))
              fn.push(`${filePath}`)
              
             
              // alert(json/)
              const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(!arfimap.includes(`${filePath}`)){
              arfile[index]["class"]=classn;
              arfile[index]["ids"]=co;
              arfile[index]["page"]=curpage;
              co++
              }
              alert(JSON.stringify(arfile[index])+" sdjnjnj")
            // }
            }
// }
          
          }catch(e){alert(e)}
            // alert(sizar[1])
            // get("all").thatcontain("jpg").by("3,5mb<size<4,2mb")
          }else{

            const parts = sizar[1].match(/[a-zA-Z]+|[0-9]+/g);
            // const parts2 = sizar[0].split("b")[1].match(/[a-zA-Z]+|[0-9]+/g);
            // const parts3 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
            // const parts4 = sizar[0].match(/[0-9]+/g);
            const parts5 = sizar[1].match(/[0-9]+/g);
            // var lin=parts3[parts3.length-1].split('').pop();
            
//             const lastIndex = sizar[0].split(lin);
// const newStr = lastIndex[lastIndex.length - 1];
            var lin2=parts[0].split('')[0];

            const lastIndex2 = sizar[1].split(lin2);
            
const newStr2 = lastIndex2[0];

 
// alert(parts5.join(","))
var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
alert(JSON.stringify(sizsame2 +newStr2+parts5.join(".")+"sdk"));
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(JSON.stringify(sizsame +sizar[0].split("b")[1]+parts4.join(".")));
// alert(JSON.stringify(sizsame2 +newStr2+parts5.join(".")));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
// try{
            if(eval(sizsame2 +newStr2+parts5.join("."))){
              // alert(JSON.stringify(abbreviateNumber(stats['size']))+"e")
              // if(){
// alert(JSON.stringify(`Path file: ${filePath}`))
              // alert(JSON.stringify(abbreviateNumber(stats['size'])))
              const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(!arfimap.includes(`${filePath}`)){
              arfile[index]["class"]=classn;
              arfile[index]["ids"]=co;
              arfile[index]["page"]=curpage;
              co++
              }
              alert(JSON.stringify(fn))
            // }
            }
//           }catch(e){alert(e)}
            // alert(sizar[1])
            // get("all").thatcontain("jpg").by("3,5mb<size<4,2mb")
        
          }
          // alert(JSON.stringify(fn))
          // var adff=fn2.filter((e) => abbreviateNumber(e.size) == tc);
        }
        if(tc.includes("cdate")){

var sizar= tc.split("cdate");
// alert(JSON.stringify(statar));
alert(JSON.stringify(sizar));
if(sizar[0]!=""){
//   const parts = sizar[1].match(/[a-zA-Z]+|[0-9]+/g);
//   const parts2 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
//   const parts3 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
  const parts4 = sizar[0].match(/[0-9]+/g);
  const parts5 = sizar[1].match(/[0-9]+/g);
  

  var lin=parts4[parts4.length-1].split('').pop();
  
            const lastIndex = sizar[0].split(lin);
            
const newStr = lastIndex[lastIndex.length - 1];

  var lin2=parts5[0].split('')[0];

  const lastIndex2 = sizar[1].split(lin2);

const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
// var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(parts4.join("/")+newStr)
var date1=new Date(parts4.join("/"));
var date2=new Date(parts5.join("/"));
var fdate=new Date(stats['ctime']);
// alert(JSON.stringify(date1+newStr+parts4.join(",")));
// alert(JSON.stringify(date2+newStr2+parts5.join(",")));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
try{
  if(eval(date1.getTime()+newStr+fdate.getTime())&&eval(fdate.getTime() +newStr2+date2.getTime())){
    alert((fdate));
    const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(!arfimap.includes(`${filePath}`)){
              arfile[index]["class"]=classn;
              arfile[index]["ids"]=co;
              arfile[index]["page"]=curpage;
              co++
              }
  }}catch(e){alert(e)}
  // alert(sizar[1])
  // alert(sizar[0].split("b")[1])
}
else{
  const parts4 = sizar[0].match(/[0-9]+/g);
  const parts5 = sizar[1].match(/[0-9]+/g);
  

//   var lin=parts4[parts4.length-1].split('').pop();
  
//             const lastIndex = sizar[0].split(lin);
            
// const newStr = lastIndex[lastIndex.length - 1];

  var lin2=parts5[0].split('')[0];

  const lastIndex2 = sizar[1].split(lin2);

const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
// var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(parts4.join("/")+newStr)
// var date1=new Date(parts4.join("/"));
var date2=new Date(parts5.join("/"));
var fdate=new Date(stats['ctime']);
// alert(JSON.stringify(date1+newStr+parts4.join(",")));
alert(JSON.stringify(fdate.getTime() +newStr2+date2.getTime()));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
try{
  if(eval(fdate.getTime() +newStr2+date2.getTime())){
    alert((fdate));
    const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(!arfimap.includes(`${filePath}`)){
              arfile[index]["class"]=classn;
              arfile[index]["ids"]=co;
              arfile[index]["page"]=curpage;
              co++
              }
  }}catch(e){alert(e)}
}
      }
      if(tc.includes("adate")){

var sizar= tc.split("adate");
// alert(JSON.stringify(statar));
alert(JSON.stringify(sizar));
if(sizar[0]!=""){
//   const parts = sizar[1].match(/[a-zA-Z]+|[0-9]+/g);
//   const parts2 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
//   const parts3 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
  const parts4 = sizar[0].match(/[0-9]+/g);
  const parts5 = sizar[1].match(/[0-9]+/g);
  

  var lin=parts4[parts4.length-1].split('').pop();
  
            const lastIndex = sizar[0].split(lin);
            
const newStr = lastIndex[lastIndex.length - 1];

  var lin2=parts5[0].split('')[0];

  const lastIndex2 = sizar[1].split(lin2);

const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
// var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(parts4.join("/")+newStr)
var date1=new Date(parts4.join("/"));
var date2=new Date(parts5.join("/"));
var fdate=new Date(stats['atime']);
// alert(JSON.stringify(date1+newStr+parts4.join(",")));
// alert(JSON.stringify(date2+newStr2+parts5.join(",")));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
try{
  if(eval(date1.getTime()+newStr+fdate.getTime())&&eval(fdate.getTime() +newStr2+date2.getTime())){
    alert((fdate));
    const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(!arfimap.includes(`${filePath}`)){
              arfile[index]["class"]=classn;
              arfile[index]["ids"]=co;
              arfile[index]["page"]=curpage;
              co++
              }
  }}catch(e){alert(e)}
  // alert(sizar[1])
  // alert(sizar[0].split("b")[1])
}
else{
  const parts4 = sizar[0].match(/[0-9]+/g);
  const parts5 = sizar[1].match(/[0-9]+/g);
  

//   var lin=parts4[parts4.length-1].split('').pop();
  
//             const lastIndex = sizar[0].split(lin);
            
// const newStr = lastIndex[lastIndex.length - 1];

  var lin2=parts5[0].split('')[0];

  const lastIndex2 = sizar[1].split(lin2);

const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
// var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(parts4.join("/")+newStr)
// var date1=new Date(parts4.join("/"));
var date2=new Date(parts5.join("/"));
var fdate=new Date(stats['atime']);
// alert(JSON.stringify(date1+newStr+parts4.join(",")));
alert(JSON.stringify(fdate.getTime() +newStr2+date2.getTime()));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
try{
  if(eval(fdate.getTime() +newStr2+date2.getTime())){
    alert((fdate));
    const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(!arfimap.includes(`${filePath}`)){
              arfile[index]["class"]=classn;
              arfile[index]["ids"]=co;
              arfile[index]["page"]=curpage;
              co++
              }
  }}catch(e){alert(e)}
}
      }
      if(tc.includes("mdate")){

var sizar= tc.split("mdate");
// alert(JSON.stringify(statar));
alert(JSON.stringify(sizar));
if(sizar[0]!=""){
//   const parts = sizar[1].match(/[a-zA-Z]+|[0-9]+/g);
//   const parts2 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
//   const parts3 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
  const parts4 = sizar[0].match(/[0-9]+/g);
  const parts5 = sizar[1].match(/[0-9]+/g);
  

  var lin=parts4[parts4.length-1].split('').pop();
  
            const lastIndex = sizar[0].split(lin);
            
const newStr = lastIndex[lastIndex.length - 1];

  var lin2=parts5[0].split('')[0];

  const lastIndex2 = sizar[1].split(lin2);

const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
// var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(parts4.join("/")+newStr)
var date1=new Date(parts4.join("/"));
var date2=new Date(parts5.join("/"));
var fdate=new Date(stats['mtime']);
// alert(JSON.stringify(date1+newStr+parts4.join(",")));
// alert(JSON.stringify(date2+newStr2+parts5.join(",")));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
try{
  if(eval(date1.getTime()+newStr+fdate.getTime())&&eval(fdate.getTime() +newStr2+date2.getTime())){
    alert((fdate));
    const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(!arfimap.includes(`${filePath}`)){
              arfile[index]["class"]=classn;
              arfile[index]["ids"]=co;
              arfile[index]["page"]=curpage;
              co++
              }
  }}catch(e){alert(e)}
  // alert(sizar[1])
  // alert(sizar[0].split("b")[1])
}
else{
  const parts4 = sizar[0].match(/[0-9]+/g);
  const parts5 = sizar[1].match(/[0-9]+/g);
  

//   var lin=parts4[parts4.length-1].split('').pop();
  
//             const lastIndex = sizar[0].split(lin);
            
// const newStr = lastIndex[lastIndex.length - 1];

  var lin2=parts5[0].split('')[0];

  const lastIndex2 = sizar[1].split(lin2);

const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
// var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(parts4.join("/")+newStr)
// var date1=new Date(parts4.join("/"));
var date2=new Date(parts5.join("/"));
var fdate=new Date(stats['mtime']);
// alert(JSON.stringify(date1+newStr+parts4.join(",")));
alert(JSON.stringify(fdate.getTime() +newStr2+date2.getTime()));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
try{
  if(eval(fdate.getTime() +newStr2+date2.getTime())){
    alert((fdate));
    const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(!arfimap.includes(`${filePath}`)){
              arfile[index]["class"]=classn;
              arfile[index]["ids"]=co;
              arfile[index]["page"]=curpage;
              co++
              }
  }}catch(e){alert(e)}
}
      }
      if(tc.includes("tag")){

var sizar= tc.split("tag").pop();
// alert(tc.replace("tag","keywords"))
alert(JSON.stringify(sizar.split("=").pop()))
var pf=arfile2.findIndex(obj => obj.filepath === `${filePath}`)

if(arfile2[pf]['keywords']==sizar.split("=").pop()){
  // alert(json)
  const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(!arfimap.includes(`${filePath}`)){
              arfile[index]["class"]=classn;
              arfile[index]["ids"]=co;
              arfile[index]["page"]=curpage;
              co++
              }
}
// arfile4=ar
// file2.filter((e) => e.keywords == ex);
}
              }else{
                
                const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(!arfimap.includes(`${filePath}`)){
              arfile[index]["class"]=classn;
              arfile[index]["ids"]=co;
              arfile[index]["page"]=curpage;
              co++
              }
              }
statar.push(stats)
alert(cts +"d "+fcn)
    if(cts==fcn){
      startapp();
      alert("finish")
    }
    // alert(abbreviateNumber(stats.size));
});

            // fn.push(arfile2[i]);
          
        });
          
}
      }
      // alert(JSON.stringify(fn))
    

    }
    // alert(JSON.stringify(fn))
  }
  if(fl2.includes("tag")){
      var ex=eval(fl[fl2.indexOf("tag")])
      // alert(ex)
      if(ex=="all"){
        var arfile2=arfile;
      }else{
        var arfile2=arfile.filter((e) => e.type == ex);
      }
      
      if(fl2.includes("thatcontain")){
        var arfile3 = arfile2.map(a => a.filepath);
        var tc=eval(fl[fl2.indexOf("thatcontain")]).toString()
        // alert(JSON.stringify(tc))
        var cts=0;
        var fcn=0;
        arfile3.forEach(filePath => {
          if(filePath.includes(tc)){
            // alert(JSON.stringify(arfile3[i]))
            // try{
              fcn++;
//from("/home/lawliet/Downloads/tutorina/aja").get("all").thatcontain("jpg").by("3,5mb<size<4,2mb")
// }catch(e){alert(e)}
            fs.stat(filePath, function(err, stats) {
              cts++
              // alert(JSON.stringify(stats))
              var ppt=filePath
              if(fl2.includes("by")){
                var tc=eval(fl[fl2.indexOf("by")]);
              
                if(tc.includes("size")){
          var sizar= tc.split("size");
          // alert(JSON.stringify(sizar));
          // alert(JSON.stringify(arfile3[i]))
          if(sizar[0]!=""){
            const parts = sizar[1].match(/[a-zA-Z]+|[0-9]+/g);
            const parts2 = sizar[0].split("b")[1].match(/[a-zA-Z]+|[0-9]+/g);
            const parts3 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
            const parts4 = sizar[0].match(/[0-9]+/g);
            const parts5 = sizar[1].match(/[0-9]+/g);
            // var lin=parts3[parts3.length-1].split('').pop();
            
//             const lastIndex = sizar[0].split(lin);
// const newStr = lastIndex[lastIndex.length - 1];

            var lin2=parts[0].split('')[0];

            const lastIndex2 = sizar[1].split(lin2);
            
const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(JSON.stringify(sizsame +sizar[0].split("b")[1]+parts4.join(".")));
// alert(JSON.stringify(sizsame2 +newStr2+parts5.join(".")));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
// alert(sizar[0]+"dso")
try{
// if(sizar[0]==""){
  // alert(sizar[0]+"dso")

// }else{
  if(eval(parts4.join(".")+sizar[0].split("b")[1]+sizsame ) &&eval(sizsame2 +newStr2+parts5.join("."))){
              // alert(JSON.stringify(abbreviateNumber(stats['size']))+"e")
              // if(){
// alert(JSON.stringify(`Path file: ${filePath}`))
              // alert(JSON.stringify(abbreviateNumber(stats['size'])))
              fn.push(`${filePath}`)
              
              const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              // arfile[index]["class"]=
              // arfile[index]["ids"]=
              // arfile[index]["page"]=
              if(fl2.includes("withvalue")){
                if(arfile[index]["keywords"]!=""){
              arfile[index]["keywords"]=arfile[index]["keywords"]+","+eval(fl[fl2.indexOf("withvalue")]);
            }else{
              arfile[index]["keywords"]=eval(fl[fl2.indexOf("withvalue")]);
            }
            }
              // alert(json/)
              alert(JSON.stringify(arfile[index])+" sdjnjnj")
            // }
            }
// }
          
          }catch(e){alert(e)}
            // alert(sizar[1])
            // get("all").thatcontain("jpg").by("3,5mb<size<4,2mb")
          }else{

            const parts = sizar[1].match(/[a-zA-Z]+|[0-9]+/g);
            // const parts2 = sizar[0].split("b")[1].match(/[a-zA-Z]+|[0-9]+/g);
            // const parts3 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
            // const parts4 = sizar[0].match(/[0-9]+/g);
            const parts5 = sizar[1].match(/[0-9]+/g);
            // var lin=parts3[parts3.length-1].split('').pop();
            
//             const lastIndex = sizar[0].split(lin);
// const newStr = lastIndex[lastIndex.length - 1];
            var lin2=parts[0].split('')[0];

            const lastIndex2 = sizar[1].split(lin2);
            
const newStr2 = lastIndex2[0];

 
// alert(parts5.join(","))
var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
alert(JSON.stringify(sizsame2 +newStr2+parts5.join(".")+"sdk"));
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(JSON.stringify(sizsame +sizar[0].split("b")[1]+parts4.join(".")));
// alert(JSON.stringify(sizsame2 +newStr2+parts5.join(".")));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
// try{
            if(eval(sizsame2 +newStr2+parts5.join("."))){
              // alert(JSON.stringify(abbreviateNumber(stats['size']))+"e")
              // if(){
// alert(JSON.stringify(`Path file: ${filePath}`))
              // alert(JSON.stringify(abbreviateNumber(stats['size'])))
              fn.push(`${filePath}`)
              const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(fl2.includes("withvalue")){
                if(arfile[index]["keywords"]!=""){
              arfile[index]["keywords"]=arfile[index]["keywords"]+","+eval(fl[fl2.indexOf("withvalue")]);
            }else{
              arfile[index]["keywords"]=eval(fl[fl2.indexOf("withvalue")]);
            }
            }
              alert(JSON.stringify(fn))
            // }
            }
//           }catch(e){alert(e)}
            // alert(sizar[1])
            // get("all").thatcontain("jpg").by("3,5mb<size<4,2mb")
        
          }
          // alert(JSON.stringify(fn))
          // var adff=fn2.filter((e) => abbreviateNumber(e.size) == tc);
        }
        if(tc.includes("cdate")){

var sizar= tc.split("cdate");
// alert(JSON.stringify(statar));
alert(JSON.stringify(sizar));
if(sizar[0]!=""){
//   const parts = sizar[1].match(/[a-zA-Z]+|[0-9]+/g);
//   const parts2 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
//   const parts3 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
  const parts4 = sizar[0].match(/[0-9]+/g);
  const parts5 = sizar[1].match(/[0-9]+/g);
  

  var lin=parts4[parts4.length-1].split('').pop();
  
            const lastIndex = sizar[0].split(lin);
            
const newStr = lastIndex[lastIndex.length - 1];

  var lin2=parts5[0].split('')[0];

  const lastIndex2 = sizar[1].split(lin2);

const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
// var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(parts4.join("/")+newStr)
var date1=new Date(parts4.join("/"));
var date2=new Date(parts5.join("/"));
var fdate=new Date(stats['ctime']);
// alert(JSON.stringify(date1+newStr+parts4.join(",")));
// alert(JSON.stringify(date2+newStr2+parts5.join(",")));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
try{
  if(eval(date1.getTime()+newStr+fdate.getTime())&&eval(fdate.getTime() +newStr2+date2.getTime())){
    alert((fdate));
    fn.push(`${filePath}`)
    const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(fl2.includes("withvalue")){
                if(arfile[index]["keywords"]!=""){
              arfile[index]["keywords"]=arfile[index]["keywords"]+","+eval(fl[fl2.indexOf("withvalue")]);
            }else{
              arfile[index]["keywords"]=eval(fl[fl2.indexOf("withvalue")]);
            }
            }
    alert(JSON.stringify(`${filePath}`))
  }}catch(e){alert(e)}
  // alert(sizar[1])
  // alert(sizar[0].split("b")[1])
}
else{
  const parts4 = sizar[0].match(/[0-9]+/g);
  const parts5 = sizar[1].match(/[0-9]+/g);
  

//   var lin=parts4[parts4.length-1].split('').pop();
  
//             const lastIndex = sizar[0].split(lin);
            
// const newStr = lastIndex[lastIndex.length - 1];

  var lin2=parts5[0].split('')[0];

  const lastIndex2 = sizar[1].split(lin2);

const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
// var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(parts4.join("/")+newStr)
// var date1=new Date(parts4.join("/"));
var date2=new Date(parts5.join("/"));
var fdate=new Date(stats['ctime']);
// alert(JSON.stringify(date1+newStr+parts4.join(",")));
alert(JSON.stringify(fdate.getTime() +newStr2+date2.getTime()));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
try{
  if(eval(fdate.getTime() +newStr2+date2.getTime())){
    alert((fdate));
    fn.push(`${filePath}`)
    const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(fl2.includes("withvalue")){
                if(arfile[index]["keywords"]!=""){
              arfile[index]["keywords"]=arfile[index]["keywords"]+","+eval(fl[fl2.indexOf("withvalue")]);
            }else{
              arfile[index]["keywords"]=eval(fl[fl2.indexOf("withvalue")]);
            }
            }
    alert(JSON.stringify(`${filePath}`))
  }}catch(e){alert(e)}
}
      }
      if(tc.includes("adate")){

var sizar= tc.split("adate");
// alert(JSON.stringify(statar));
alert(JSON.stringify(sizar));
if(sizar[0]!=""){
//   const parts = sizar[1].match(/[a-zA-Z]+|[0-9]+/g);
//   const parts2 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
//   const parts3 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
  const parts4 = sizar[0].match(/[0-9]+/g);
  const parts5 = sizar[1].match(/[0-9]+/g);
  

  var lin=parts4[parts4.length-1].split('').pop();
  
            const lastIndex = sizar[0].split(lin);
            
const newStr = lastIndex[lastIndex.length - 1];

  var lin2=parts5[0].split('')[0];

  const lastIndex2 = sizar[1].split(lin2);

const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
// var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(parts4.join("/")+newStr)
var date1=new Date(parts4.join("/"));
var date2=new Date(parts5.join("/"));
var fdate=new Date(stats['atime']);
// alert(JSON.stringify(date1+newStr+parts4.join(",")));
// alert(JSON.stringify(date2+newStr2+parts5.join(",")));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
try{
  if(eval(date1.getTime()+newStr+fdate.getTime())&&eval(fdate.getTime() +newStr2+date2.getTime())){
    alert((fdate));
    fn.push(`${filePath}`)
    const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(fl2.includes("withvalue")){
                if(arfile[index]["keywords"]!=""){
              arfile[index]["keywords"]=arfile[index]["keywords"]+","+eval(fl[fl2.indexOf("withvalue")]);
            }else{
              arfile[index]["keywords"]=eval(fl[fl2.indexOf("withvalue")]);
            }
            }
    alert(JSON.stringify(`${filePath}`))
  }}catch(e){alert(e)}
  // alert(sizar[1])
  // alert(sizar[0].split("b")[1])
}
else{
  const parts4 = sizar[0].match(/[0-9]+/g);
  const parts5 = sizar[1].match(/[0-9]+/g);
  

//   var lin=parts4[parts4.length-1].split('').pop();
  
//             const lastIndex = sizar[0].split(lin);
            
// const newStr = lastIndex[lastIndex.length - 1];

  var lin2=parts5[0].split('')[0];

  const lastIndex2 = sizar[1].split(lin2);

const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
// var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(parts4.join("/")+newStr)
// var date1=new Date(parts4.join("/"));
var date2=new Date(parts5.join("/"));
var fdate=new Date(stats['atime']);
// alert(JSON.stringify(date1+newStr+parts4.join(",")));
alert(JSON.stringify(fdate.getTime() +newStr2+date2.getTime()));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
try{
  if(eval(fdate.getTime() +newStr2+date2.getTime())){
    alert((fdate));
    fn.push(`${filePath}`)
    const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(fl2.includes("withvalue")){
                if(arfile[index]["keywords"]!=""){
              arfile[index]["keywords"]=arfile[index]["keywords"]+","+eval(fl[fl2.indexOf("withvalue")]);
            }else{
              arfile[index]["keywords"]=eval(fl[fl2.indexOf("withvalue")]);
            }
            }
    alert(JSON.stringify(`${filePath}`))
  }}catch(e){alert(e)}
}
      }
      if(tc.includes("mdate")){

var sizar= tc.split("mdate");
// alert(JSON.stringify(statar));
alert(JSON.stringify(sizar));
if(sizar[0]!=""){
//   const parts = sizar[1].match(/[a-zA-Z]+|[0-9]+/g);
//   const parts2 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
//   const parts3 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
  const parts4 = sizar[0].match(/[0-9]+/g);
  const parts5 = sizar[1].match(/[0-9]+/g);
  

  var lin=parts4[parts4.length-1].split('').pop();
  
            const lastIndex = sizar[0].split(lin);
            
const newStr = lastIndex[lastIndex.length - 1];

  var lin2=parts5[0].split('')[0];

  const lastIndex2 = sizar[1].split(lin2);

const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
// var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(parts4.join("/")+newStr)
var date1=new Date(parts4.join("/"));
var date2=new Date(parts5.join("/"));
var fdate=new Date(stats['mtime']);
// alert(JSON.stringify(date1+newStr+parts4.join(",")));
// alert(JSON.stringify(date2+newStr2+parts5.join(",")));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
try{
  if(eval(date1.getTime()+newStr+fdate.getTime())&&eval(fdate.getTime() +newStr2+date2.getTime())){
    alert((fdate));
    fn.push(`${filePath}`)
    const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(fl2.includes("withvalue")){
                if(arfile[index]["keywords"]!=""){
              arfile[index]["keywords"]=arfile[index]["keywords"]+","+eval(fl[fl2.indexOf("withvalue")]);
            }else{
              arfile[index]["keywords"]=eval(fl[fl2.indexOf("withvalue")]);
            }
            }
    alert(JSON.stringify(`${filePath}`))
  }}catch(e){alert(e)}
  // alert(sizar[1])
  // alert(sizar[0].split("b")[1])
}
else{
  const parts4 = sizar[0].match(/[0-9]+/g);
  const parts5 = sizar[1].match(/[0-9]+/g);
  

//   var lin=parts4[parts4.length-1].split('').pop();
  
//             const lastIndex = sizar[0].split(lin);
            
// const newStr = lastIndex[lastIndex.length - 1];

  var lin2=parts5[0].split('')[0];

  const lastIndex2 = sizar[1].split(lin2);

const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
// var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(parts4.join("/")+newStr)
// var date1=new Date(parts4.join("/"));
var date2=new Date(parts5.join("/"));
var fdate=new Date(stats['mtime']);
// alert(JSON.stringify(date1+newStr+parts4.join(",")));
alert(JSON.stringify(fdate.getTime() +newStr2+date2.getTime()));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
try{
  if(eval(fdate.getTime() +newStr2+date2.getTime())){
    alert((fdate));
    fn.push(`${filePath}`)
    const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(fl2.includes("withvalue")){
                if(arfile[index]["keywords"]!=""){
              arfile[index]["keywords"]=arfile[index]["keywords"]+","+eval(fl[fl2.indexOf("withvalue")]);
            }else{
              arfile[index]["keywords"]=eval(fl[fl2.indexOf("withvalue")]);
            }
            }
    alert(JSON.stringify(`${filePath}`))
  }}catch(e){alert(e)}
}
      }
      if(tc.includes("tag")){

var sizar= tc.split("tag").pop();
// alert(tc.replace("tag","keywords"))
alert(JSON.stringify(sizar.split("=").pop()))
var pf=arfile2.findIndex(obj => obj.filepath === `${filePath}`)

if(arfile2[pf]['keywords']==sizar.split("=").pop()){
  // alert(json)
  fn.push(`${filePath}`)
  const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(fl2.includes("withvalue")){
                if(arfile[index]["keywords"]!=""){
              arfile[index]["keywords"]=arfile[index]["keywords"]+","+eval(fl[fl2.indexOf("withvalue")]);
            }else{
              arfile[index]["keywords"]=eval(fl[fl2.indexOf("withvalue")]);
            }
            }
  alert(JSON.stringify(fn))
}
// arfile4=ar
// file2.filter((e) => e.keywords == ex);
}
              }else{
                const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(fl2.includes("withvalue")){
                if(arfile[index]["keywords"]!=""){
              arfile[index]["keywords"]=arfile[index]["keywords"]+","+eval(fl[fl2.indexOf("withvalue")]);
            }else{
              arfile[index]["keywords"]=eval(fl[fl2.indexOf("withvalue")]);
            }
            }
              }
statar.push(stats)
alert(cts +"d "+fcn)
    if(cts==fcn){
      startapp();
      alert("finish")
    }
    // alert(abbreviateNumber(stats.size));
});

            // fn.push(arfile2[i]);
          }
        });
     
      }else{
        if(fl2.includes("by")){
        var arfile3 = arfile2.map(a => a.filepath);
        var tc=eval(fl[fl2.indexOf("by")]).toString()
        alert(JSON.stringify(tc))
        var cts=0;
        var fcn=0;
        arfile3.forEach(filePath => {
          
            // alert(JSON.stringify(arfile3[i]))
            // try{
              fcn++;
// }catch(e){alert(e)}
            fs.stat(filePath, function(err, stats) {
              // alert(JSON.stringify(stats))
              cts++
              var ppt=filePath
              if(fl2.includes("by")){
                var tc=eval(fl[fl2.indexOf("by")]);
              
                if(tc.includes("size")){
          var sizar= tc.split("size");
          // alert(JSON.stringify(sizar));
          // alert(JSON.stringify(arfile3[i]))
          if(sizar[0]!=""){
            const parts = sizar[1].match(/[a-zA-Z]+|[0-9]+/g);
            const parts2 = sizar[0].split("b")[1].match(/[a-zA-Z]+|[0-9]+/g);
            const parts3 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
            const parts4 = sizar[0].match(/[0-9]+/g);
            const parts5 = sizar[1].match(/[0-9]+/g);
            // var lin=parts3[parts3.length-1].split('').pop();
            
//             const lastIndex = sizar[0].split(lin);
// const newStr = lastIndex[lastIndex.length - 1];

            var lin2=parts[0].split('')[0];

            const lastIndex2 = sizar[1].split(lin2);
            
const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(JSON.stringify(sizsame +sizar[0].split("b")[1]+parts4.join(".")));
// alert(JSON.stringify(sizsame2 +newStr2+parts5.join(".")));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
// alert(sizar[0]+"dso")
try{
// if(sizar[0]==""){
  // alert(sizar[0]+"dso")

// }else{
  if(eval(parts4.join(".")+sizar[0].split("b")[1]+sizsame ) &&eval(sizsame2 +newStr2+parts5.join("."))){
              // alert(JSON.stringify(abbreviateNumber(stats['size']))+"e")
              // if(){
// alert(JSON.stringify(`Path file: ${filePath}`))
              // alert(JSON.stringify(abbreviateNumber(stats['size'])))
              fn.push(`${filePath}`)
              
              const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              // arfile[index]["class"]=
              // arfile[index]["ids"]=
              // arfile[index]["page"]=
              if(fl2.includes("withvalue")){
                if(arfile[index]["keywords"]!=""){
              arfile[index]["keywords"]=arfile[index]["keywords"]+","+eval(fl[fl2.indexOf("withvalue")]);
            }else{
              arfile[index]["keywords"]=eval(fl[fl2.indexOf("withvalue")]);
            }
            }
              // alert(json/)
              alert(JSON.stringify(arfile[index])+" sdjnjnj")
            // }
            }
// }
          
          }catch(e){alert(e)}
            // alert(sizar[1])
            // get("all").thatcontain("jpg").by("3,5mb<size<4,2mb")
          }else{

            const parts = sizar[1].match(/[a-zA-Z]+|[0-9]+/g);
            // const parts2 = sizar[0].split("b")[1].match(/[a-zA-Z]+|[0-9]+/g);
            // const parts3 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
            // const parts4 = sizar[0].match(/[0-9]+/g);
            const parts5 = sizar[1].match(/[0-9]+/g);
            // var lin=parts3[parts3.length-1].split('').pop();
            
//             const lastIndex = sizar[0].split(lin);
// const newStr = lastIndex[lastIndex.length - 1];
            var lin2=parts[0].split('')[0];

            const lastIndex2 = sizar[1].split(lin2);
            
const newStr2 = lastIndex2[0];

 
// alert(parts5.join(","))
var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
alert(JSON.stringify(sizsame2 +newStr2+parts5.join(".")+"sdk"));
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(JSON.stringify(sizsame +sizar[0].split("b")[1]+parts4.join(".")));
// alert(JSON.stringify(sizsame2 +newStr2+parts5.join(".")));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
// try{
            if(eval(sizsame2 +newStr2+parts5.join("."))){
              // alert(JSON.stringify(abbreviateNumber(stats['size']))+"e")
              // if(){
// alert(JSON.stringify(`Path file: ${filePath}`))
              // alert(JSON.stringify(abbreviateNumber(stats['size'])))
              fn.push(`${filePath}`)
              const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(fl2.includes("withvalue")){
                if(arfile[index]["keywords"]!=""){
              arfile[index]["keywords"]=arfile[index]["keywords"]+","+eval(fl[fl2.indexOf("withvalue")]);
            }else{
              arfile[index]["keywords"]=eval(fl[fl2.indexOf("withvalue")]);
            }
            }
              alert(JSON.stringify(fn))
            // }
            }
//           }catch(e){alert(e)}
            // alert(sizar[1])
            // get("all").thatcontain("jpg").by("3,5mb<size<4,2mb")
        
          }
          // alert(JSON.stringify(fn))
          // var adff=fn2.filter((e) => abbreviateNumber(e.size) == tc);
        }
        if(tc.includes("cdate")){

var sizar= tc.split("cdate");
// alert(JSON.stringify(statar));
alert(JSON.stringify(sizar));
if(sizar[0]!=""){
//   const parts = sizar[1].match(/[a-zA-Z]+|[0-9]+/g);
//   const parts2 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
//   const parts3 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
  const parts4 = sizar[0].match(/[0-9]+/g);
  const parts5 = sizar[1].match(/[0-9]+/g);
  

  var lin=parts4[parts4.length-1].split('').pop();
  
            const lastIndex = sizar[0].split(lin);
            
const newStr = lastIndex[lastIndex.length - 1];

  var lin2=parts5[0].split('')[0];

  const lastIndex2 = sizar[1].split(lin2);

const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
// var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(parts4.join("/")+newStr)
var date1=new Date(parts4.join("/"));
var date2=new Date(parts5.join("/"));
var fdate=new Date(stats['ctime']);
// alert(JSON.stringify(date1+newStr+parts4.join(",")));
// alert(JSON.stringify(date2+newStr2+parts5.join(",")));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
try{
  if(eval(date1.getTime()+newStr+fdate.getTime())&&eval(fdate.getTime() +newStr2+date2.getTime())){
    alert((fdate));
    fn.push(`${filePath}`)
    const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(fl2.includes("withvalue")){
                if(arfile[index]["keywords"]!=""){
              arfile[index]["keywords"]=arfile[index]["keywords"]+","+eval(fl[fl2.indexOf("withvalue")]);
            }else{
              arfile[index]["keywords"]=eval(fl[fl2.indexOf("withvalue")]);
            }
            }
    alert(JSON.stringify(`${filePath}`))
  }}catch(e){alert(e)}
  // alert(sizar[1])
  // alert(sizar[0].split("b")[1])
}
else{
  const parts4 = sizar[0].match(/[0-9]+/g);
  const parts5 = sizar[1].match(/[0-9]+/g);
  

//   var lin=parts4[parts4.length-1].split('').pop();
  
//             const lastIndex = sizar[0].split(lin);
            
// const newStr = lastIndex[lastIndex.length - 1];

  var lin2=parts5[0].split('')[0];

  const lastIndex2 = sizar[1].split(lin2);

const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
// var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(parts4.join("/")+newStr)
// var date1=new Date(parts4.join("/"));
var date2=new Date(parts5.join("/"));
var fdate=new Date(stats['ctime']);
// alert(JSON.stringify(date1+newStr+parts4.join(",")));
alert(JSON.stringify(fdate.getTime() +newStr2+date2.getTime()));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
try{
  if(eval(fdate.getTime() +newStr2+date2.getTime())){
    alert((fdate));
    fn.push(`${filePath}`)
    const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(fl2.includes("withvalue")){
                if(arfile[index]["keywords"]!=""){
              arfile[index]["keywords"]=arfile[index]["keywords"]+","+eval(fl[fl2.indexOf("withvalue")]);
            }else{
              arfile[index]["keywords"]=eval(fl[fl2.indexOf("withvalue")]);
            }
            }
    alert(JSON.stringify(`${filePath}`))
  }}catch(e){alert(e)}
}
      }
      if(tc.includes("adate")){

var sizar= tc.split("adate");
// alert(JSON.stringify(statar));
alert(JSON.stringify(sizar));
if(sizar[0]!=""){
//   const parts = sizar[1].match(/[a-zA-Z]+|[0-9]+/g);
//   const parts2 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
//   const parts3 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
  const parts4 = sizar[0].match(/[0-9]+/g);
  const parts5 = sizar[1].match(/[0-9]+/g);
  

  var lin=parts4[parts4.length-1].split('').pop();
  
            const lastIndex = sizar[0].split(lin);
            
const newStr = lastIndex[lastIndex.length - 1];

  var lin2=parts5[0].split('')[0];

  const lastIndex2 = sizar[1].split(lin2);

const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
// var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(parts4.join("/")+newStr)
var date1=new Date(parts4.join("/"));
var date2=new Date(parts5.join("/"));
var fdate=new Date(stats['atime']);
// alert(JSON.stringify(date1+newStr+parts4.join(",")));
// alert(JSON.stringify(date2+newStr2+parts5.join(",")));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
try{
  if(eval(date1.getTime()+newStr+fdate.getTime())&&eval(fdate.getTime() +newStr2+date2.getTime())){
    alert((fdate));
    fn.push(`${filePath}`)
    const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(fl2.includes("withvalue")){
                if(arfile[index]["keywords"]!=""){
              arfile[index]["keywords"]=arfile[index]["keywords"]+","+eval(fl[fl2.indexOf("withvalue")]);
            }else{
              arfile[index]["keywords"]=eval(fl[fl2.indexOf("withvalue")]);
            }
            }
    alert(JSON.stringify(`${filePath}`))
  }}catch(e){alert(e)}
  // alert(sizar[1])
  // alert(sizar[0].split("b")[1])
}
else{
  const parts4 = sizar[0].match(/[0-9]+/g);
  const parts5 = sizar[1].match(/[0-9]+/g);
  

//   var lin=parts4[parts4.length-1].split('').pop();
  
//             const lastIndex = sizar[0].split(lin);
            
// const newStr = lastIndex[lastIndex.length - 1];

  var lin2=parts5[0].split('')[0];

  const lastIndex2 = sizar[1].split(lin2);

const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
// var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(parts4.join("/")+newStr)
// var date1=new Date(parts4.join("/"));
var date2=new Date(parts5.join("/"));
var fdate=new Date(stats['atime']);
// alert(JSON.stringify(date1+newStr+parts4.join(",")));
alert(JSON.stringify(fdate.getTime() +newStr2+date2.getTime()));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
try{
  if(eval(fdate.getTime() +newStr2+date2.getTime())){
    alert((fdate));
    fn.push(`${filePath}`)
    const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(fl2.includes("withvalue")){
                if(arfile[index]["keywords"]!=""){
              arfile[index]["keywords"]=arfile[index]["keywords"]+","+eval(fl[fl2.indexOf("withvalue")]);
            }else{
              arfile[index]["keywords"]=eval(fl[fl2.indexOf("withvalue")]);
            }
            }
    alert(JSON.stringify(`${filePath}`))
  }}catch(e){alert(e)}
}
      }
      if(tc.includes("mdate")){

var sizar= tc.split("mdate");
// alert(JSON.stringify(statar));
alert(JSON.stringify(sizar));
if(sizar[0]!=""){
//   const parts = sizar[1].match(/[a-zA-Z]+|[0-9]+/g);
//   const parts2 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
//   const parts3 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
  const parts4 = sizar[0].match(/[0-9]+/g);
  const parts5 = sizar[1].match(/[0-9]+/g);
  

  var lin=parts4[parts4.length-1].split('').pop();
  
            const lastIndex = sizar[0].split(lin);
            
const newStr = lastIndex[lastIndex.length - 1];

  var lin2=parts5[0].split('')[0];

  const lastIndex2 = sizar[1].split(lin2);

const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
// var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(parts4.join("/")+newStr)
var date1=new Date(parts4.join("/"));
var date2=new Date(parts5.join("/"));
var fdate=new Date(stats['mtime']);
// alert(JSON.stringify(date1+newStr+parts4.join(",")));
// alert(JSON.stringify(date2+newStr2+parts5.join(",")));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
try{
  if(eval(date1.getTime()+newStr+fdate.getTime())&&eval(fdate.getTime() +newStr2+date2.getTime())){
    alert((fdate));
    fn.push(`${filePath}`)
    const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(fl2.includes("withvalue")){
                if(arfile[index]["keywords"]!=""){
              arfile[index]["keywords"]=arfile[index]["keywords"]+","+eval(fl[fl2.indexOf("withvalue")]);
            }else{
              arfile[index]["keywords"]=eval(fl[fl2.indexOf("withvalue")]);
            }
            }
    alert(JSON.stringify(`${filePath}`))
  }}catch(e){alert(e)}
  // alert(sizar[1])
  // alert(sizar[0].split("b")[1])
}
else{
  const parts4 = sizar[0].match(/[0-9]+/g);
  const parts5 = sizar[1].match(/[0-9]+/g);
  

//   var lin=parts4[parts4.length-1].split('').pop();
  
//             const lastIndex = sizar[0].split(lin);
            
// const newStr = lastIndex[lastIndex.length - 1];

  var lin2=parts5[0].split('')[0];

  const lastIndex2 = sizar[1].split(lin2);

const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
// var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(parts4.join("/")+newStr)
// var date1=new Date(parts4.join("/"));
var date2=new Date(parts5.join("/"));
var fdate=new Date(stats['mtime']);
// alert(JSON.stringify(date1+newStr+parts4.join(",")));
alert(JSON.stringify(fdate.getTime() +newStr2+date2.getTime()));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
try{
  if(eval(fdate.getTime() +newStr2+date2.getTime())){
    alert((fdate));
    fn.push(`${filePath}`)
    const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(fl2.includes("withvalue")){
                if(arfile[index]["keywords"]!=""){
              arfile[index]["keywords"]=arfile[index]["keywords"]+","+eval(fl[fl2.indexOf("withvalue")]);
            }else{
              arfile[index]["keywords"]=eval(fl[fl2.indexOf("withvalue")]);
            }
            }
    alert(JSON.stringify(`${filePath}`))
  }}catch(e){alert(e)}
}
      }
      if(tc.includes("tag")){

var sizar= tc.split("tag").pop();
// alert(tc.replace("tag","keywords"))
alert(JSON.stringify(sizar.split("=").pop()))
var pf=arfile2.findIndex(obj => obj.filepath === `${filePath}`)

if(arfile2[pf]['keywords']==sizar.split("=").pop()){
  // alert(json)
  fn.push(`${filePath}`)
  const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(fl2.includes("withvalue")){
                if(arfile[index]["keywords"]!=""){
              arfile[index]["keywords"]=arfile[index]["keywords"]+","+eval(fl[fl2.indexOf("withvalue")]);
            }else{
              arfile[index]["keywords"]=eval(fl[fl2.indexOf("withvalue")]);
            }
            }
  alert(JSON.stringify(fn))
}
// arfile4=ar
// file2.filter((e) => e.keywords == ex);
}
              }else{
                const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(fl2.includes("withvalue")){
                if(arfile[index]["keywords"]!=""){
              arfile[index]["keywords"]=arfile[index]["keywords"]+","+eval(fl[fl2.indexOf("withvalue")]);
            }else{
              arfile[index]["keywords"]=eval(fl[fl2.indexOf("withvalue")]);
            }
            }
              }
statar.push(stats)
alert(cts +"d "+fcn)
    if(cts==fcn){
      startapp();
      alert("finish")
    }
    // alert(abbreviateNumber(stats.size));
});

            // fn.push(arfile2[i]);
          
        });
          
}
      }
      // alert(JSON.stringify(fn))
    
    // alert(fl[fl2.indexOf("get")])
  }

  ///

  ///
  if(fl2.includes("colour")){
      var ex=eval(fl[fl2.indexOf("colour")])
      // alert(ex)
      if(ex=="all"){
        var arfile2=arfile;
      }else{
        var arfile2=arfile.filter((e) => e.type == ex);
      }
      
      if(fl2.includes("thatcontain")){
        var arfile3 = arfile2.map(a => a.filepath);
        var tc=eval(fl[fl2.indexOf("thatcontain")]).toString()
        // alert(JSON.stringify(tc))
        var cts=0;
        var fcn=0;
        arfile3.forEach(filePath => {
          if(filePath.includes(tc)){
            // alert(JSON.stringify(arfile3[i]))
            // try{
              fcn++;
//from("/home/lawliet/Downloads/tutorina/aja").get("all").thatcontain("jpg").by("3,5mb<size<4,2mb")
// }catch(e){alert(e)}
            fs.stat(filePath, function(err, stats) {
              cts++
              // alert(JSON.stringify(stats))
              var ppt=filePath
              if(fl2.includes("by")){
                var tc=eval(fl[fl2.indexOf("by")]);
              
                if(tc.includes("size")){
          var sizar= tc.split("size");
          // alert(JSON.stringify(sizar));
          // alert(JSON.stringify(arfile3[i]))
          if(sizar[0]!=""){
            const parts = sizar[1].match(/[a-zA-Z]+|[0-9]+/g);
            const parts2 = sizar[0].split("b")[1].match(/[a-zA-Z]+|[0-9]+/g);
            const parts3 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
            const parts4 = sizar[0].match(/[0-9]+/g);
            const parts5 = sizar[1].match(/[0-9]+/g);
            // var lin=parts3[parts3.length-1].split('').pop();
            
//             const lastIndex = sizar[0].split(lin);
// const newStr = lastIndex[lastIndex.length - 1];

            var lin2=parts[0].split('')[0];

            const lastIndex2 = sizar[1].split(lin2);
            
const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(JSON.stringify(sizsame +sizar[0].split("b")[1]+parts4.join(".")));
// alert(JSON.stringify(sizsame2 +newStr2+parts5.join(".")));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
// alert(sizar[0]+"dso")
try{
// if(sizar[0]==""){
  // alert(sizar[0]+"dso")

// }else{
  if(eval(parts4.join(".")+sizar[0].split("b")[1]+sizsame ) &&eval(sizsame2 +newStr2+parts5.join("."))){
              // alert(JSON.stringify(abbreviateNumber(stats['size']))+"e")
              // if(){
// alert(JSON.stringify(`Path file: ${filePath}`))
              // alert(JSON.stringify(abbreviateNumber(stats['size'])))
              fn.push(`${filePath}`)
              
              const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              // arfile[index]["class"]=
              // arfile[index]["ids"]=
              // arfile[index]["page"]=
              if(fl2.includes("withvalue")){
                arfile[index]["background"]=eval(fl[fl2.indexOf("withvalue")]);
            }
              // alert(json/)
              alert(JSON.stringify(arfile[index])+" sdjnjnj")
            // }
            }
// }
          
          }catch(e){alert(e)}
            // alert(sizar[1])
            // get("all").thatcontain("jpg").by("3,5mb<size<4,2mb")
          }else{

            const parts = sizar[1].match(/[a-zA-Z]+|[0-9]+/g);
            // const parts2 = sizar[0].split("b")[1].match(/[a-zA-Z]+|[0-9]+/g);
            // const parts3 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
            // const parts4 = sizar[0].match(/[0-9]+/g);
            const parts5 = sizar[1].match(/[0-9]+/g);
            // var lin=parts3[parts3.length-1].split('').pop();
            
//             const lastIndex = sizar[0].split(lin);
// const newStr = lastIndex[lastIndex.length - 1];
            var lin2=parts[0].split('')[0];

            const lastIndex2 = sizar[1].split(lin2);
            
const newStr2 = lastIndex2[0];

 
// alert(parts5.join(","))
var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
alert(JSON.stringify(sizsame2 +newStr2+parts5.join(".")+"sdk"));
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(JSON.stringify(sizsame +sizar[0].split("b")[1]+parts4.join(".")));
// alert(JSON.stringify(sizsame2 +newStr2+parts5.join(".")));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
// try{
            if(eval(sizsame2 +newStr2+parts5.join("."))){
              // alert(JSON.stringify(abbreviateNumber(stats['size']))+"e")
              // if(){
// alert(JSON.stringify(`Path file: ${filePath}`))
              // alert(JSON.stringify(abbreviateNumber(stats['size'])))
              fn.push(`${filePath}`)
              const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(fl2.includes("withvalue")){
                arfile[index]["background"]=eval(fl[fl2.indexOf("withvalue")]);
            }
              alert(JSON.stringify(fn))
            // }
            }
//           }catch(e){alert(e)}
            // alert(sizar[1])
            // get("all").thatcontain("jpg").by("3,5mb<size<4,2mb")
        
          }
          // alert(JSON.stringify(fn))
          // var adff=fn2.filter((e) => abbreviateNumber(e.size) == tc);
        }
        if(tc.includes("cdate")){

var sizar= tc.split("cdate");
// alert(JSON.stringify(statar));
alert(JSON.stringify(sizar));
if(sizar[0]!=""){
//   const parts = sizar[1].match(/[a-zA-Z]+|[0-9]+/g);
//   const parts2 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
//   const parts3 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
  const parts4 = sizar[0].match(/[0-9]+/g);
  const parts5 = sizar[1].match(/[0-9]+/g);
  

  var lin=parts4[parts4.length-1].split('').pop();
  
            const lastIndex = sizar[0].split(lin);
            
const newStr = lastIndex[lastIndex.length - 1];

  var lin2=parts5[0].split('')[0];

  const lastIndex2 = sizar[1].split(lin2);

const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
// var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(parts4.join("/")+newStr)
var date1=new Date(parts4.join("/"));
var date2=new Date(parts5.join("/"));
var fdate=new Date(stats['ctime']);
// alert(JSON.stringify(date1+newStr+parts4.join(",")));
// alert(JSON.stringify(date2+newStr2+parts5.join(",")));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
try{
  if(eval(date1.getTime()+newStr+fdate.getTime())&&eval(fdate.getTime() +newStr2+date2.getTime())){
    alert((fdate));
    fn.push(`${filePath}`)
    const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(fl2.includes("withvalue")){
                arfile[index]["background"]=eval(fl[fl2.indexOf("withvalue")]);
            }
    alert(JSON.stringify(`${filePath}`))
  }}catch(e){alert(e)}
  // alert(sizar[1])
  // alert(sizar[0].split("b")[1])
}
else{
  const parts4 = sizar[0].match(/[0-9]+/g);
  const parts5 = sizar[1].match(/[0-9]+/g);
  

//   var lin=parts4[parts4.length-1].split('').pop();
  
//             const lastIndex = sizar[0].split(lin);
            
// const newStr = lastIndex[lastIndex.length - 1];

  var lin2=parts5[0].split('')[0];

  const lastIndex2 = sizar[1].split(lin2);

const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
// var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(parts4.join("/")+newStr)
// var date1=new Date(parts4.join("/"));
var date2=new Date(parts5.join("/"));
var fdate=new Date(stats['ctime']);
// alert(JSON.stringify(date1+newStr+parts4.join(",")));
alert(JSON.stringify(fdate.getTime() +newStr2+date2.getTime()));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
try{
  if(eval(fdate.getTime() +newStr2+date2.getTime())){
    alert((fdate));
    fn.push(`${filePath}`)
    const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(fl2.includes("withvalue")){
                arfile[index]["background"]=eval(fl[fl2.indexOf("withvalue")]);
            }
    alert(JSON.stringify(`${filePath}`))
  }}catch(e){alert(e)}
}
      }
      if(tc.includes("adate")){

var sizar= tc.split("adate");
// alert(JSON.stringify(statar));
alert(JSON.stringify(sizar));
if(sizar[0]!=""){
//   const parts = sizar[1].match(/[a-zA-Z]+|[0-9]+/g);
//   const parts2 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
//   const parts3 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
  const parts4 = sizar[0].match(/[0-9]+/g);
  const parts5 = sizar[1].match(/[0-9]+/g);
  

  var lin=parts4[parts4.length-1].split('').pop();
  
            const lastIndex = sizar[0].split(lin);
            
const newStr = lastIndex[lastIndex.length - 1];

  var lin2=parts5[0].split('')[0];

  const lastIndex2 = sizar[1].split(lin2);

const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
// var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(parts4.join("/")+newStr)
var date1=new Date(parts4.join("/"));
var date2=new Date(parts5.join("/"));
var fdate=new Date(stats['atime']);
// alert(JSON.stringify(date1+newStr+parts4.join(",")));
// alert(JSON.stringify(date2+newStr2+parts5.join(",")));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
try{
  if(eval(date1.getTime()+newStr+fdate.getTime())&&eval(fdate.getTime() +newStr2+date2.getTime())){
    alert((fdate));
    fn.push(`${filePath}`)
    const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(fl2.includes("withvalue")){
                arfile[index]["background"]=eval(fl[fl2.indexOf("withvalue")]);
            }
    alert(JSON.stringify(`${filePath}`))
  }}catch(e){alert(e)}
  // alert(sizar[1])
  // alert(sizar[0].split("b")[1])
}
else{
  const parts4 = sizar[0].match(/[0-9]+/g);
  const parts5 = sizar[1].match(/[0-9]+/g);
  

//   var lin=parts4[parts4.length-1].split('').pop();
  
//             const lastIndex = sizar[0].split(lin);
            
// const newStr = lastIndex[lastIndex.length - 1];

  var lin2=parts5[0].split('')[0];

  const lastIndex2 = sizar[1].split(lin2);

const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
// var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(parts4.join("/")+newStr)
// var date1=new Date(parts4.join("/"));
var date2=new Date(parts5.join("/"));
var fdate=new Date(stats['atime']);
// alert(JSON.stringify(date1+newStr+parts4.join(",")));
alert(JSON.stringify(fdate.getTime() +newStr2+date2.getTime()));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
try{
  if(eval(fdate.getTime() +newStr2+date2.getTime())){
    alert((fdate));
    fn.push(`${filePath}`)
    const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(fl2.includes("withvalue")){
                arfile[index]["background"]=eval(fl[fl2.indexOf("withvalue")]);
            }
    alert(JSON.stringify(`${filePath}`))
  }}catch(e){alert(e)}
}
      }
      if(tc.includes("mdate")){

var sizar= tc.split("mdate");
// alert(JSON.stringify(statar));
alert(JSON.stringify(sizar));
if(sizar[0]!=""){
//   const parts = sizar[1].match(/[a-zA-Z]+|[0-9]+/g);
//   const parts2 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
//   const parts3 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
  const parts4 = sizar[0].match(/[0-9]+/g);
  const parts5 = sizar[1].match(/[0-9]+/g);
  

  var lin=parts4[parts4.length-1].split('').pop();
  
            const lastIndex = sizar[0].split(lin);
            
const newStr = lastIndex[lastIndex.length - 1];

  var lin2=parts5[0].split('')[0];

  const lastIndex2 = sizar[1].split(lin2);

const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
// var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(parts4.join("/")+newStr)
var date1=new Date(parts4.join("/"));
var date2=new Date(parts5.join("/"));
var fdate=new Date(stats['mtime']);
// alert(JSON.stringify(date1+newStr+parts4.join(",")));
// alert(JSON.stringify(date2+newStr2+parts5.join(",")));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
try{
  if(eval(date1.getTime()+newStr+fdate.getTime())&&eval(fdate.getTime() +newStr2+date2.getTime())){
    alert((fdate));
    fn.push(`${filePath}`)
    const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(fl2.includes("withvalue")){
                arfile[index]["background"]=eval(fl[fl2.indexOf("withvalue")]);
            }
    alert(JSON.stringify(`${filePath}`))
  }}catch(e){alert(e)}
  // alert(sizar[1])
  // alert(sizar[0].split("b")[1])
}
else{
  const parts4 = sizar[0].match(/[0-9]+/g);
  const parts5 = sizar[1].match(/[0-9]+/g);
  

//   var lin=parts4[parts4.length-1].split('').pop();
  
//             const lastIndex = sizar[0].split(lin);
            
// const newStr = lastIndex[lastIndex.length - 1];

  var lin2=parts5[0].split('')[0];

  const lastIndex2 = sizar[1].split(lin2);

const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
// var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(parts4.join("/")+newStr)
// var date1=new Date(parts4.join("/"));
var date2=new Date(parts5.join("/"));
var fdate=new Date(stats['mtime']);
// alert(JSON.stringify(date1+newStr+parts4.join(",")));
alert(JSON.stringify(fdate.getTime() +newStr2+date2.getTime()));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
try{
  if(eval(fdate.getTime() +newStr2+date2.getTime())){
    alert((fdate));
    fn.push(`${filePath}`)
    const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(fl2.includes("withvalue")){
                arfile[index]["background"]=eval(fl[fl2.indexOf("withvalue")]);
            }
    alert(JSON.stringify(`${filePath}`))
  }}catch(e){alert(e)}
}
      }
      if(tc.includes("tag")){

var sizar= tc.split("tag").pop();
// alert(tc.replace("tag","keywords"))
alert(JSON.stringify(sizar.split("=").pop()))
var pf=arfile2.findIndex(obj => obj.filepath === `${filePath}`)

if(arfile2[pf]['keywords']==sizar.split("=").pop()){
  // alert(json)
  fn.push(`${filePath}`)
  const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(fl2.includes("withvalue")){
                arfile[index]["background"]=eval(fl[fl2.indexOf("withvalue")]);
            }
  alert(JSON.stringify(fn))
}
// arfile4=ar
// file2.filter((e) => e.keywords == ex);
}
              }else{
                const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(fl2.includes("withvalue")){
                arfile[index]["background"]=eval(fl[fl2.indexOf("withvalue")]);
            }
              }
statar.push(stats)
alert(cts +"d "+fcn)
    if(cts==fcn){
      startapp();
      alert("finish")
    }
    // alert(abbreviateNumber(stats.size));
});

            // fn.push(arfile2[i]);
          }
        });
     
      }else{
        if(fl2.includes("by")){
        var arfile3 = arfile2.map(a => a.filepath);
        var tc=eval(fl[fl2.indexOf("by")]).toString()
        alert(JSON.stringify(tc))
        var cts=0;
        var fcn=0;
        arfile3.forEach(filePath => {
          
            // alert(JSON.stringify(arfile3[i]))
            // try{
              fcn++;
// }catch(e){alert(e)}
            fs.stat(filePath, function(err, stats) {
              // alert(JSON.stringify(stats))
              cts++
              var ppt=filePath
              if(fl2.includes("by")){
                var tc=eval(fl[fl2.indexOf("by")]);
              
                if(tc.includes("size")){
          var sizar= tc.split("size");
          // alert(JSON.stringify(sizar));
          // alert(JSON.stringify(arfile3[i]))
          if(sizar[0]!=""){
            const parts = sizar[1].match(/[a-zA-Z]+|[0-9]+/g);
            const parts2 = sizar[0].split("b")[1].match(/[a-zA-Z]+|[0-9]+/g);
            const parts3 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
            const parts4 = sizar[0].match(/[0-9]+/g);
            const parts5 = sizar[1].match(/[0-9]+/g);
            // var lin=parts3[parts3.length-1].split('').pop();
            
//             const lastIndex = sizar[0].split(lin);
// const newStr = lastIndex[lastIndex.length - 1];

            var lin2=parts[0].split('')[0];

            const lastIndex2 = sizar[1].split(lin2);
            
const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(JSON.stringify(sizsame +sizar[0].split("b")[1]+parts4.join(".")));
// alert(JSON.stringify(sizsame2 +newStr2+parts5.join(".")));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
// alert(sizar[0]+"dso")
try{
// if(sizar[0]==""){
  // alert(sizar[0]+"dso")

// }else{
  if(eval(parts4.join(".")+sizar[0].split("b")[1]+sizsame ) &&eval(sizsame2 +newStr2+parts5.join("."))){
              // alert(JSON.stringify(abbreviateNumber(stats['size']))+"e")
              // if(){
// alert(JSON.stringify(`Path file: ${filePath}`))
              // alert(JSON.stringify(abbreviateNumber(stats['size'])))
              fn.push(`${filePath}`)
              
              const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              // arfile[index]["class"]=
              // arfile[index]["ids"]=
              // arfile[index]["page"]=
              if(fl2.includes("withvalue")){
                arfile[index]["background"]=eval(fl[fl2.indexOf("withvalue")]);
            }
              // alert(json/)
              alert(JSON.stringify(arfile[index])+" sdjnjnj")
            // }
            }
// }
          
          }catch(e){alert(e)}
            // alert(sizar[1])
            // get("all").thatcontain("jpg").by("3,5mb<size<4,2mb")
          }else{

            const parts = sizar[1].match(/[a-zA-Z]+|[0-9]+/g);
            // const parts2 = sizar[0].split("b")[1].match(/[a-zA-Z]+|[0-9]+/g);
            // const parts3 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
            // const parts4 = sizar[0].match(/[0-9]+/g);
            const parts5 = sizar[1].match(/[0-9]+/g);
            // var lin=parts3[parts3.length-1].split('').pop();
            
//             const lastIndex = sizar[0].split(lin);
// const newStr = lastIndex[lastIndex.length - 1];
            var lin2=parts[0].split('')[0];

            const lastIndex2 = sizar[1].split(lin2);
            
const newStr2 = lastIndex2[0];

 
// alert(parts5.join(","))
var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
alert(JSON.stringify(sizsame2 +newStr2+parts5.join(".")+"sdk"));
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(JSON.stringify(sizsame +sizar[0].split("b")[1]+parts4.join(".")));
// alert(JSON.stringify(sizsame2 +newStr2+parts5.join(".")));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
// try{
            if(eval(sizsame2 +newStr2+parts5.join("."))){
              // alert(JSON.stringify(abbreviateNumber(stats['size']))+"e")
              // if(){
// alert(JSON.stringify(`Path file: ${filePath}`))
              // alert(JSON.stringify(abbreviateNumber(stats['size'])))
              fn.push(`${filePath}`)
              const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(fl2.includes("withvalue")){
                arfile[index]["background"]=eval(fl[fl2.indexOf("withvalue")]);
            }
              alert(JSON.stringify(fn))
            // }
            }
//           }catch(e){alert(e)}
            // alert(sizar[1])
            // get("all").thatcontain("jpg").by("3,5mb<size<4,2mb")
        
          }
          // alert(JSON.stringify(fn))
          // var adff=fn2.filter((e) => abbreviateNumber(e.size) == tc);
        }
        if(tc.includes("cdate")){

var sizar= tc.split("cdate");
// alert(JSON.stringify(statar));
alert(JSON.stringify(sizar));
if(sizar[0]!=""){
//   const parts = sizar[1].match(/[a-zA-Z]+|[0-9]+/g);
//   const parts2 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
//   const parts3 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
  const parts4 = sizar[0].match(/[0-9]+/g);
  const parts5 = sizar[1].match(/[0-9]+/g);
  

  var lin=parts4[parts4.length-1].split('').pop();
  
            const lastIndex = sizar[0].split(lin);
            
const newStr = lastIndex[lastIndex.length - 1];

  var lin2=parts5[0].split('')[0];

  const lastIndex2 = sizar[1].split(lin2);

const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
// var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(parts4.join("/")+newStr)
var date1=new Date(parts4.join("/"));
var date2=new Date(parts5.join("/"));
var fdate=new Date(stats['ctime']);
// alert(JSON.stringify(date1+newStr+parts4.join(",")));
// alert(JSON.stringify(date2+newStr2+parts5.join(",")));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
try{
  if(eval(date1.getTime()+newStr+fdate.getTime())&&eval(fdate.getTime() +newStr2+date2.getTime())){
    alert((fdate));
    fn.push(`${filePath}`)
    const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(fl2.includes("withvalue")){
                arfile[index]["background"]=eval(fl[fl2.indexOf("withvalue")]);
            }
    alert(JSON.stringify(`${filePath}`))
  }}catch(e){alert(e)}
  // alert(sizar[1])
  // alert(sizar[0].split("b")[1])
}
else{
  const parts4 = sizar[0].match(/[0-9]+/g);
  const parts5 = sizar[1].match(/[0-9]+/g);
  

//   var lin=parts4[parts4.length-1].split('').pop();
  
//             const lastIndex = sizar[0].split(lin);
            
// const newStr = lastIndex[lastIndex.length - 1];

  var lin2=parts5[0].split('')[0];

  const lastIndex2 = sizar[1].split(lin2);

const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
// var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(parts4.join("/")+newStr)
// var date1=new Date(parts4.join("/"));
var date2=new Date(parts5.join("/"));
var fdate=new Date(stats['ctime']);
// alert(JSON.stringify(date1+newStr+parts4.join(",")));
alert(JSON.stringify(fdate.getTime() +newStr2+date2.getTime()));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
try{
  if(eval(fdate.getTime() +newStr2+date2.getTime())){
    alert((fdate));
    fn.push(`${filePath}`)
    const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(fl2.includes("withvalue")){
                arfile[index]["background"]=eval(fl[fl2.indexOf("withvalue")]);
            }
    alert(JSON.stringify(`${filePath}`))
  }}catch(e){alert(e)}
}
      }
      if(tc.includes("adate")){

var sizar= tc.split("adate");
// alert(JSON.stringify(statar));
alert(JSON.stringify(sizar));
if(sizar[0]!=""){
//   const parts = sizar[1].match(/[a-zA-Z]+|[0-9]+/g);
//   const parts2 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
//   const parts3 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
  const parts4 = sizar[0].match(/[0-9]+/g);
  const parts5 = sizar[1].match(/[0-9]+/g);
  

  var lin=parts4[parts4.length-1].split('').pop();
  
            const lastIndex = sizar[0].split(lin);
            
const newStr = lastIndex[lastIndex.length - 1];

  var lin2=parts5[0].split('')[0];

  const lastIndex2 = sizar[1].split(lin2);

const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
// var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(parts4.join("/")+newStr)
var date1=new Date(parts4.join("/"));
var date2=new Date(parts5.join("/"));
var fdate=new Date(stats['atime']);
// alert(JSON.stringify(date1+newStr+parts4.join(",")));
// alert(JSON.stringify(date2+newStr2+parts5.join(",")));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
try{
  if(eval(date1.getTime()+newStr+fdate.getTime())&&eval(fdate.getTime() +newStr2+date2.getTime())){
    alert((fdate));
    fn.push(`${filePath}`)
    const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(fl2.includes("withvalue")){
                arfile[index]["background"]=eval(fl[fl2.indexOf("withvalue")]);
            }
    alert(JSON.stringify(`${filePath}`))
  }}catch(e){alert(e)}
  // alert(sizar[1])
  // alert(sizar[0].split("b")[1])
}
else{
  const parts4 = sizar[0].match(/[0-9]+/g);
  const parts5 = sizar[1].match(/[0-9]+/g);
  

//   var lin=parts4[parts4.length-1].split('').pop();
  
//             const lastIndex = sizar[0].split(lin);
            
// const newStr = lastIndex[lastIndex.length - 1];

  var lin2=parts5[0].split('')[0];

  const lastIndex2 = sizar[1].split(lin2);

const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
// var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(parts4.join("/")+newStr)
// var date1=new Date(parts4.join("/"));
var date2=new Date(parts5.join("/"));
var fdate=new Date(stats['atime']);
// alert(JSON.stringify(date1+newStr+parts4.join(",")));
alert(JSON.stringify(fdate.getTime() +newStr2+date2.getTime()));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
try{
  if(eval(fdate.getTime() +newStr2+date2.getTime())){
    alert((fdate));
    fn.push(`${filePath}`)
    const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(fl2.includes("withvalue")){
                arfile[index]["background"]=eval(fl[fl2.indexOf("withvalue")]);
            }
    alert(JSON.stringify(`${filePath}`))
  }}catch(e){alert(e)}
}
      }
      if(tc.includes("mdate")){

var sizar= tc.split("mdate");
// alert(JSON.stringify(statar));
alert(JSON.stringify(sizar));
if(sizar[0]!=""){
//   const parts = sizar[1].match(/[a-zA-Z]+|[0-9]+/g);
//   const parts2 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
//   const parts3 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
  const parts4 = sizar[0].match(/[0-9]+/g);
  const parts5 = sizar[1].match(/[0-9]+/g);
  

  var lin=parts4[parts4.length-1].split('').pop();
  
            const lastIndex = sizar[0].split(lin);
            
const newStr = lastIndex[lastIndex.length - 1];

  var lin2=parts5[0].split('')[0];

  const lastIndex2 = sizar[1].split(lin2);

const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
// var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(parts4.join("/")+newStr)
var date1=new Date(parts4.join("/"));
var date2=new Date(parts5.join("/"));
var fdate=new Date(stats['mtime']);
// alert(JSON.stringify(date1+newStr+parts4.join(",")));
// alert(JSON.stringify(date2+newStr2+parts5.join(",")));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
try{
  if(eval(date1.getTime()+newStr+fdate.getTime())&&eval(fdate.getTime() +newStr2+date2.getTime())){
    alert((fdate));
    fn.push(`${filePath}`)
    const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(fl2.includes("withvalue")){
                arfile[index]["background"]=eval(fl[fl2.indexOf("withvalue")]);
            }
    alert(JSON.stringify(`${filePath}`))
  }}catch(e){alert(e)}
  // alert(sizar[1])
  // alert(sizar[0].split("b")[1])
}
else{
  const parts4 = sizar[0].match(/[0-9]+/g);
  const parts5 = sizar[1].match(/[0-9]+/g);
  

//   var lin=parts4[parts4.length-1].split('').pop();
  
//             const lastIndex = sizar[0].split(lin);
            
// const newStr = lastIndex[lastIndex.length - 1];

  var lin2=parts5[0].split('')[0];

  const lastIndex2 = sizar[1].split(lin2);

const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
// var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(parts4.join("/")+newStr)
// var date1=new Date(parts4.join("/"));
var date2=new Date(parts5.join("/"));
var fdate=new Date(stats['mtime']);
// alert(JSON.stringify(date1+newStr+parts4.join(",")));
alert(JSON.stringify(fdate.getTime() +newStr2+date2.getTime()));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
try{
  if(eval(fdate.getTime() +newStr2+date2.getTime())){
    alert((fdate));
    fn.push(`${filePath}`)
    const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(fl2.includes("withvalue")){
                arfile[index]["background"]=eval(fl[fl2.indexOf("withvalue")]);
            }
    alert(JSON.stringify(`${filePath}`))
  }}catch(e){alert(e)}
}
      }
      if(tc.includes("tag")){

var sizar= tc.split("tag").pop();
// alert(tc.replace("tag","keywords"))
alert(JSON.stringify(sizar.split("=").pop()))
var pf=arfile2.findIndex(obj => obj.filepath === `${filePath}`)

if(arfile2[pf]['keywords']==sizar.split("=").pop()){
  // alert(json)
  fn.push(`${filePath}`)
  const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(fl2.includes("withvalue")){
                arfile[index]["background"]=eval(fl[fl2.indexOf("withvalue")]);
            }
  alert(JSON.stringify(fn))
}
// arfile4=ar
// file2.filter((e) => e.keywords == ex);
}
              }else{
                const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(fl2.includes("withvalue")){
             
              arfile[index]["background"]=eval(fl[fl2.indexOf("withvalue")]);
            
            }
              }
statar.push(stats)
alert(cts +"d "+fcn)
    if(cts==fcn){
      startapp();
      alert("finish")
    }
    // alert(abbreviateNumber(stats.size));
});

            // fn.push(arfile2[i]);
          
        });
          
}
      }
      // alert(JSON.stringify(fn))
    
    // alert(fl[fl2.indexOf("get")])
  }
  ///

  ///
  if(fl2.includes("icon")){
      var ex=eval(fl[fl2.indexOf("icon")])
      // alert(ex)
      if(ex=="all"){
        var arfile2=arfile;
      }else{
        var arfile2=arfile.filter((e) => e.type == ex);
      }
      
      if(fl2.includes("thatcontain")){
        var arfile3 = arfile2.map(a => a.filepath);
        var tc=eval(fl[fl2.indexOf("thatcontain")]).toString()
        // alert(JSON.stringify(tc))
        var cts=0;
        var fcn=0;
        arfile3.forEach(filePath => {
          if(filePath.includes(tc)){
            // alert(JSON.stringify(arfile3[i]))
            // try{
              fcn++;
//from("/home/lawliet/Downloads/tutorina/aja").get("all").thatcontain("jpg").by("3,5mb<size<4,2mb")
// }catch(e){alert(e)}
            fs.stat(filePath, function(err, stats) {
              cts++
              // alert(JSON.stringify(stats))
              var ppt=filePath
              if(fl2.includes("by")){
                var tc=eval(fl[fl2.indexOf("by")]);
              
                if(tc.includes("size")){
          var sizar= tc.split("size");
          // alert(JSON.stringify(sizar));
          // alert(JSON.stringify(arfile3[i]))
          if(sizar[0]!=""){
            const parts = sizar[1].match(/[a-zA-Z]+|[0-9]+/g);
            const parts2 = sizar[0].split("b")[1].match(/[a-zA-Z]+|[0-9]+/g);
            const parts3 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
            const parts4 = sizar[0].match(/[0-9]+/g);
            const parts5 = sizar[1].match(/[0-9]+/g);
            // var lin=parts3[parts3.length-1].split('').pop();
            
//             const lastIndex = sizar[0].split(lin);
// const newStr = lastIndex[lastIndex.length - 1];

            var lin2=parts[0].split('')[0];

            const lastIndex2 = sizar[1].split(lin2);
            
const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(JSON.stringify(sizsame +sizar[0].split("b")[1]+parts4.join(".")));
// alert(JSON.stringify(sizsame2 +newStr2+parts5.join(".")));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
// alert(sizar[0]+"dso")
try{
// if(sizar[0]==""){
  // alert(sizar[0]+"dso")

// }else{
  if(eval(parts4.join(".")+sizar[0].split("b")[1]+sizsame ) &&eval(sizsame2 +newStr2+parts5.join("."))){
              // alert(JSON.stringify(abbreviateNumber(stats['size']))+"e")
              // if(){
// alert(JSON.stringify(`Path file: ${filePath}`))
              // alert(JSON.stringify(abbreviateNumber(stats['size'])))
              fn.push(`${filePath}`)
              
              const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              // arfile[index]["class"]=
              // arfile[index]["ids"]=
              // arfile[index]["page"]=
              if(fl2.includes("withvalue")){
                arfile[index]["icon"]=eval(fl[fl2.indexOf("withvalue")]);
            }
              // alert(json/)
              alert(JSON.stringify(arfile[index])+" sdjnjnj")
            // }
            }
// }
          
          }catch(e){alert(e)}
            // alert(sizar[1])
            // get("all").thatcontain("jpg").by("3,5mb<size<4,2mb")
          }else{

            const parts = sizar[1].match(/[a-zA-Z]+|[0-9]+/g);
            // const parts2 = sizar[0].split("b")[1].match(/[a-zA-Z]+|[0-9]+/g);
            // const parts3 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
            // const parts4 = sizar[0].match(/[0-9]+/g);
            const parts5 = sizar[1].match(/[0-9]+/g);
            // var lin=parts3[parts3.length-1].split('').pop();
            
//             const lastIndex = sizar[0].split(lin);
// const newStr = lastIndex[lastIndex.length - 1];
            var lin2=parts[0].split('')[0];

            const lastIndex2 = sizar[1].split(lin2);
            
const newStr2 = lastIndex2[0];

 
// alert(parts5.join(","))
var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
alert(JSON.stringify(sizsame2 +newStr2+parts5.join(".")+"sdk"));
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(JSON.stringify(sizsame +sizar[0].split("b")[1]+parts4.join(".")));
// alert(JSON.stringify(sizsame2 +newStr2+parts5.join(".")));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
// try{
            if(eval(sizsame2 +newStr2+parts5.join("."))){
              // alert(JSON.stringify(abbreviateNumber(stats['size']))+"e")
              // if(){
// alert(JSON.stringify(`Path file: ${filePath}`))
              // alert(JSON.stringify(abbreviateNumber(stats['size'])))
              fn.push(`${filePath}`)
              const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(fl2.includes("withvalue")){
                arfile[index]["icon"]=eval(fl[fl2.indexOf("withvalue")]);
            }
              alert(JSON.stringify(fn))
            // }
            }
//           }catch(e){alert(e)}
            // alert(sizar[1])
            // get("all").thatcontain("jpg").by("3,5mb<size<4,2mb")
        
          }
          // alert(JSON.stringify(fn))
          // var adff=fn2.filter((e) => abbreviateNumber(e.size) == tc);
        }
        if(tc.includes("cdate")){

var sizar= tc.split("cdate");
// alert(JSON.stringify(statar));
alert(JSON.stringify(sizar));
if(sizar[0]!=""){
//   const parts = sizar[1].match(/[a-zA-Z]+|[0-9]+/g);
//   const parts2 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
//   const parts3 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
  const parts4 = sizar[0].match(/[0-9]+/g);
  const parts5 = sizar[1].match(/[0-9]+/g);
  

  var lin=parts4[parts4.length-1].split('').pop();
  
            const lastIndex = sizar[0].split(lin);
            
const newStr = lastIndex[lastIndex.length - 1];

  var lin2=parts5[0].split('')[0];

  const lastIndex2 = sizar[1].split(lin2);

const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
// var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(parts4.join("/")+newStr)
var date1=new Date(parts4.join("/"));
var date2=new Date(parts5.join("/"));
var fdate=new Date(stats['ctime']);
// alert(JSON.stringify(date1+newStr+parts4.join(",")));
// alert(JSON.stringify(date2+newStr2+parts5.join(",")));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
try{
  if(eval(date1.getTime()+newStr+fdate.getTime())&&eval(fdate.getTime() +newStr2+date2.getTime())){
    alert((fdate));
    fn.push(`${filePath}`)
    const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(fl2.includes("withvalue")){
                arfile[index]["icon"]=eval(fl[fl2.indexOf("withvalue")]);
            }
    alert(JSON.stringify(`${filePath}`))
  }}catch(e){alert(e)}
  // alert(sizar[1])
  // alert(sizar[0].split("b")[1])
}
else{
  const parts4 = sizar[0].match(/[0-9]+/g);
  const parts5 = sizar[1].match(/[0-9]+/g);
  

//   var lin=parts4[parts4.length-1].split('').pop();
  
//             const lastIndex = sizar[0].split(lin);
            
// const newStr = lastIndex[lastIndex.length - 1];

  var lin2=parts5[0].split('')[0];

  const lastIndex2 = sizar[1].split(lin2);

const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
// var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(parts4.join("/")+newStr)
// var date1=new Date(parts4.join("/"));
var date2=new Date(parts5.join("/"));
var fdate=new Date(stats['ctime']);
// alert(JSON.stringify(date1+newStr+parts4.join(",")));
alert(JSON.stringify(fdate.getTime() +newStr2+date2.getTime()));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
try{
  if(eval(fdate.getTime() +newStr2+date2.getTime())){
    alert((fdate));
    fn.push(`${filePath}`)
    const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(fl2.includes("withvalue")){
                arfile[index]["icon"]=eval(fl[fl2.indexOf("withvalue")]);
            }
    alert(JSON.stringify(`${filePath}`))
  }}catch(e){alert(e)}
}
      }
      if(tc.includes("adate")){

var sizar= tc.split("adate");
// alert(JSON.stringify(statar));
alert(JSON.stringify(sizar));
if(sizar[0]!=""){
//   const parts = sizar[1].match(/[a-zA-Z]+|[0-9]+/g);
//   const parts2 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
//   const parts3 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
  const parts4 = sizar[0].match(/[0-9]+/g);
  const parts5 = sizar[1].match(/[0-9]+/g);
  

  var lin=parts4[parts4.length-1].split('').pop();
  
            const lastIndex = sizar[0].split(lin);
            
const newStr = lastIndex[lastIndex.length - 1];

  var lin2=parts5[0].split('')[0];

  const lastIndex2 = sizar[1].split(lin2);

const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
// var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(parts4.join("/")+newStr)
var date1=new Date(parts4.join("/"));
var date2=new Date(parts5.join("/"));
var fdate=new Date(stats['atime']);
// alert(JSON.stringify(date1+newStr+parts4.join(",")));
// alert(JSON.stringify(date2+newStr2+parts5.join(",")));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
try{
  if(eval(date1.getTime()+newStr+fdate.getTime())&&eval(fdate.getTime() +newStr2+date2.getTime())){
    alert((fdate));
    fn.push(`${filePath}`)
    const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(fl2.includes("withvalue")){
                arfile[index]["icon"]=eval(fl[fl2.indexOf("withvalue")]);
            }
    alert(JSON.stringify(`${filePath}`))
  }}catch(e){alert(e)}
  // alert(sizar[1])
  // alert(sizar[0].split("b")[1])
}
else{
  const parts4 = sizar[0].match(/[0-9]+/g);
  const parts5 = sizar[1].match(/[0-9]+/g);
  

//   var lin=parts4[parts4.length-1].split('').pop();
  
//             const lastIndex = sizar[0].split(lin);
            
// const newStr = lastIndex[lastIndex.length - 1];

  var lin2=parts5[0].split('')[0];

  const lastIndex2 = sizar[1].split(lin2);

const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
// var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(parts4.join("/")+newStr)
// var date1=new Date(parts4.join("/"));
var date2=new Date(parts5.join("/"));
var fdate=new Date(stats['atime']);
// alert(JSON.stringify(date1+newStr+parts4.join(",")));
alert(JSON.stringify(fdate.getTime() +newStr2+date2.getTime()));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
try{
  if(eval(fdate.getTime() +newStr2+date2.getTime())){
    alert((fdate));
    fn.push(`${filePath}`)
    const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(fl2.includes("withvalue")){
                arfile[index]["icon"]=eval(fl[fl2.indexOf("withvalue")]);
            }
    alert(JSON.stringify(`${filePath}`))
  }}catch(e){alert(e)}
}
      }
      if(tc.includes("mdate")){

var sizar= tc.split("mdate");
// alert(JSON.stringify(statar));
alert(JSON.stringify(sizar));
if(sizar[0]!=""){
//   const parts = sizar[1].match(/[a-zA-Z]+|[0-9]+/g);
//   const parts2 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
//   const parts3 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
  const parts4 = sizar[0].match(/[0-9]+/g);
  const parts5 = sizar[1].match(/[0-9]+/g);
  

  var lin=parts4[parts4.length-1].split('').pop();
  
            const lastIndex = sizar[0].split(lin);
            
const newStr = lastIndex[lastIndex.length - 1];

  var lin2=parts5[0].split('')[0];

  const lastIndex2 = sizar[1].split(lin2);

const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
// var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(parts4.join("/")+newStr)
var date1=new Date(parts4.join("/"));
var date2=new Date(parts5.join("/"));
var fdate=new Date(stats['mtime']);
// alert(JSON.stringify(date1+newStr+parts4.join(",")));
// alert(JSON.stringify(date2+newStr2+parts5.join(",")));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
try{
  if(eval(date1.getTime()+newStr+fdate.getTime())&&eval(fdate.getTime() +newStr2+date2.getTime())){
    alert((fdate));
    fn.push(`${filePath}`)
    const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(fl2.includes("withvalue")){
                arfile[index]["icon"]=eval(fl[fl2.indexOf("withvalue")]);
            }
    alert(JSON.stringify(`${filePath}`))
  }}catch(e){alert(e)}
  // alert(sizar[1])
  // alert(sizar[0].split("b")[1])
}
else{
  const parts4 = sizar[0].match(/[0-9]+/g);
  const parts5 = sizar[1].match(/[0-9]+/g);
  

//   var lin=parts4[parts4.length-1].split('').pop();
  
//             const lastIndex = sizar[0].split(lin);
            
// const newStr = lastIndex[lastIndex.length - 1];

  var lin2=parts5[0].split('')[0];

  const lastIndex2 = sizar[1].split(lin2);

const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
// var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(parts4.join("/")+newStr)
// var date1=new Date(parts4.join("/"));
var date2=new Date(parts5.join("/"));
var fdate=new Date(stats['mtime']);
// alert(JSON.stringify(date1+newStr+parts4.join(",")));
alert(JSON.stringify(fdate.getTime() +newStr2+date2.getTime()));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
try{
  if(eval(fdate.getTime() +newStr2+date2.getTime())){
    alert((fdate));
    fn.push(`${filePath}`)
    const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(fl2.includes("withvalue")){
                arfile[index]["icon"]=eval(fl[fl2.indexOf("withvalue")]);
            }
    alert(JSON.stringify(`${filePath}`))
  }}catch(e){alert(e)}
}
      }
      if(tc.includes("tag")){

var sizar= tc.split("tag").pop();
// alert(tc.replace("tag","keywords"))
alert(JSON.stringify(sizar.split("=").pop()))
var pf=arfile2.findIndex(obj => obj.filepath === `${filePath}`)

if(arfile2[pf]['keywords']==sizar.split("=").pop()){
  // alert(json)
  fn.push(`${filePath}`)
  const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(fl2.includes("withvalue")){
                arfile[index]["icon"]=eval(fl[fl2.indexOf("withvalue")]);
            }
  alert(JSON.stringify(fn))
}
// arfile4=ar
// file2.filter((e) => e.keywords == ex);
}
              }else{
                const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(fl2.includes("withvalue")){
                arfile[index]["icon"]=eval(fl[fl2.indexOf("withvalue")]);
            }
              }
statar.push(stats)
alert(cts +"d "+fcn)
    if(cts==fcn){
      startapp();
      alert("finish")
    }
    // alert(abbreviateNumber(stats.size));
});

            // fn.push(arfile2[i]);
          }
        });
     
      }else{
        if(fl2.includes("by")){
        var arfile3 = arfile2.map(a => a.filepath);
        var tc=eval(fl[fl2.indexOf("by")]).toString()
        alert(JSON.stringify(tc))
        var cts=0;
        var fcn=0;
        arfile3.forEach(filePath => {
          
            // alert(JSON.stringify(arfile3[i]))
            // try{
              fcn++;
// }catch(e){alert(e)}
            fs.stat(filePath, function(err, stats) {
              // alert(JSON.stringify(stats))
              cts++
              var ppt=filePath
              if(fl2.includes("by")){
                var tc=eval(fl[fl2.indexOf("by")]);
              
                if(tc.includes("size")){
          var sizar= tc.split("size");
          // alert(JSON.stringify(sizar));
          // alert(JSON.stringify(arfile3[i]))
          if(sizar[0]!=""){
            const parts = sizar[1].match(/[a-zA-Z]+|[0-9]+/g);
            const parts2 = sizar[0].split("b")[1].match(/[a-zA-Z]+|[0-9]+/g);
            const parts3 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
            const parts4 = sizar[0].match(/[0-9]+/g);
            const parts5 = sizar[1].match(/[0-9]+/g);
            // var lin=parts3[parts3.length-1].split('').pop();
            
//             const lastIndex = sizar[0].split(lin);
// const newStr = lastIndex[lastIndex.length - 1];

            var lin2=parts[0].split('')[0];

            const lastIndex2 = sizar[1].split(lin2);
            
const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(JSON.stringify(sizsame +sizar[0].split("b")[1]+parts4.join(".")));
// alert(JSON.stringify(sizsame2 +newStr2+parts5.join(".")));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
// alert(sizar[0]+"dso")
try{
// if(sizar[0]==""){
  // alert(sizar[0]+"dso")

// }else{
  if(eval(parts4.join(".")+sizar[0].split("b")[1]+sizsame ) &&eval(sizsame2 +newStr2+parts5.join("."))){
              // alert(JSON.stringify(abbreviateNumber(stats['size']))+"e")
              // if(){
// alert(JSON.stringify(`Path file: ${filePath}`))
              // alert(JSON.stringify(abbreviateNumber(stats['size'])))
              fn.push(`${filePath}`)
              
              const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              // arfile[index]["class"]=
              // arfile[index]["ids"]=
              // arfile[index]["page"]=
              if(fl2.includes("withvalue")){
                arfile[index]["icon"]=eval(fl[fl2.indexOf("withvalue")]);
            }
              // alert(json/)
              alert(JSON.stringify(arfile[index])+" sdjnjnj")
            // }
            }
// }
          
          }catch(e){alert(e)}
            // alert(sizar[1])
            // get("all").thatcontain("jpg").by("3,5mb<size<4,2mb")
          }else{

            const parts = sizar[1].match(/[a-zA-Z]+|[0-9]+/g);
            // const parts2 = sizar[0].split("b")[1].match(/[a-zA-Z]+|[0-9]+/g);
            // const parts3 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
            // const parts4 = sizar[0].match(/[0-9]+/g);
            const parts5 = sizar[1].match(/[0-9]+/g);
            // var lin=parts3[parts3.length-1].split('').pop();
            
//             const lastIndex = sizar[0].split(lin);
// const newStr = lastIndex[lastIndex.length - 1];
            var lin2=parts[0].split('')[0];

            const lastIndex2 = sizar[1].split(lin2);
            
const newStr2 = lastIndex2[0];

 
// alert(parts5.join(","))
var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
alert(JSON.stringify(sizsame2 +newStr2+parts5.join(".")+"sdk"));
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(JSON.stringify(sizsame +sizar[0].split("b")[1]+parts4.join(".")));
// alert(JSON.stringify(sizsame2 +newStr2+parts5.join(".")));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
// try{
            if(eval(sizsame2 +newStr2+parts5.join("."))){
              // alert(JSON.stringify(abbreviateNumber(stats['size']))+"e")
              // if(){
// alert(JSON.stringify(`Path file: ${filePath}`))
              // alert(JSON.stringify(abbreviateNumber(stats['size'])))
              fn.push(`${filePath}`)
              const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(fl2.includes("withvalue")){
                arfile[index]["icon"]=eval(fl[fl2.indexOf("withvalue")]);
            }
              alert(JSON.stringify(fn))
            // }
            }
//           }catch(e){alert(e)}
            // alert(sizar[1])
            // get("all").thatcontain("jpg").by("3,5mb<size<4,2mb")
        
          }
          // alert(JSON.stringify(fn))
          // var adff=fn2.filter((e) => abbreviateNumber(e.size) == tc);
        }
        if(tc.includes("cdate")){

var sizar= tc.split("cdate");
// alert(JSON.stringify(statar));
alert(JSON.stringify(sizar));
if(sizar[0]!=""){
//   const parts = sizar[1].match(/[a-zA-Z]+|[0-9]+/g);
//   const parts2 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
//   const parts3 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
  const parts4 = sizar[0].match(/[0-9]+/g);
  const parts5 = sizar[1].match(/[0-9]+/g);
  

  var lin=parts4[parts4.length-1].split('').pop();
  
            const lastIndex = sizar[0].split(lin);
            
const newStr = lastIndex[lastIndex.length - 1];

  var lin2=parts5[0].split('')[0];

  const lastIndex2 = sizar[1].split(lin2);

const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
// var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(parts4.join("/")+newStr)
var date1=new Date(parts4.join("/"));
var date2=new Date(parts5.join("/"));
var fdate=new Date(stats['ctime']);
// alert(JSON.stringify(date1+newStr+parts4.join(",")));
// alert(JSON.stringify(date2+newStr2+parts5.join(",")));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
try{
  if(eval(date1.getTime()+newStr+fdate.getTime())&&eval(fdate.getTime() +newStr2+date2.getTime())){
    alert((fdate));
    fn.push(`${filePath}`)
    const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(fl2.includes("withvalue")){
                arfile[index]["icon"]=eval(fl[fl2.indexOf("withvalue")]);
            }
    alert(JSON.stringify(`${filePath}`))
  }}catch(e){alert(e)}
  // alert(sizar[1])
  // alert(sizar[0].split("b")[1])
}
else{
  const parts4 = sizar[0].match(/[0-9]+/g);
  const parts5 = sizar[1].match(/[0-9]+/g);
  

//   var lin=parts4[parts4.length-1].split('').pop();
  
//             const lastIndex = sizar[0].split(lin);
            
// const newStr = lastIndex[lastIndex.length - 1];

  var lin2=parts5[0].split('')[0];

  const lastIndex2 = sizar[1].split(lin2);

const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
// var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(parts4.join("/")+newStr)
// var date1=new Date(parts4.join("/"));
var date2=new Date(parts5.join("/"));
var fdate=new Date(stats['ctime']);
// alert(JSON.stringify(date1+newStr+parts4.join(",")));
alert(JSON.stringify(fdate.getTime() +newStr2+date2.getTime()));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
try{
  if(eval(fdate.getTime() +newStr2+date2.getTime())){
    alert((fdate));
    fn.push(`${filePath}`)
    const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(fl2.includes("withvalue")){
                arfile[index]["icon"]=eval(fl[fl2.indexOf("withvalue")]);
            }
    alert(JSON.stringify(`${filePath}`))
  }}catch(e){alert(e)}
}
      }
      if(tc.includes("adate")){

var sizar= tc.split("adate");
// alert(JSON.stringify(statar));
alert(JSON.stringify(sizar));
if(sizar[0]!=""){
//   const parts = sizar[1].match(/[a-zA-Z]+|[0-9]+/g);
//   const parts2 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
//   const parts3 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
  const parts4 = sizar[0].match(/[0-9]+/g);
  const parts5 = sizar[1].match(/[0-9]+/g);
  

  var lin=parts4[parts4.length-1].split('').pop();
  
            const lastIndex = sizar[0].split(lin);
            
const newStr = lastIndex[lastIndex.length - 1];

  var lin2=parts5[0].split('')[0];

  const lastIndex2 = sizar[1].split(lin2);

const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
// var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(parts4.join("/")+newStr)
var date1=new Date(parts4.join("/"));
var date2=new Date(parts5.join("/"));
var fdate=new Date(stats['atime']);
// alert(JSON.stringify(date1+newStr+parts4.join(",")));
// alert(JSON.stringify(date2+newStr2+parts5.join(",")));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
try{
  if(eval(date1.getTime()+newStr+fdate.getTime())&&eval(fdate.getTime() +newStr2+date2.getTime())){
    alert((fdate));
    fn.push(`${filePath}`)
    const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(fl2.includes("withvalue")){
                arfile[index]["icon"]=eval(fl[fl2.indexOf("withvalue")]);
            }
    alert(JSON.stringify(`${filePath}`))
  }}catch(e){alert(e)}
  // alert(sizar[1])
  // alert(sizar[0].split("b")[1])
}
else{
  const parts4 = sizar[0].match(/[0-9]+/g);
  const parts5 = sizar[1].match(/[0-9]+/g);
  

//   var lin=parts4[parts4.length-1].split('').pop();
  
//             const lastIndex = sizar[0].split(lin);
            
// const newStr = lastIndex[lastIndex.length - 1];

  var lin2=parts5[0].split('')[0];

  const lastIndex2 = sizar[1].split(lin2);

const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
// var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(parts4.join("/")+newStr)
// var date1=new Date(parts4.join("/"));
var date2=new Date(parts5.join("/"));
var fdate=new Date(stats['atime']);
// alert(JSON.stringify(date1+newStr+parts4.join(",")));
alert(JSON.stringify(fdate.getTime() +newStr2+date2.getTime()));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
try{
  if(eval(fdate.getTime() +newStr2+date2.getTime())){
    alert((fdate));
    fn.push(`${filePath}`)
    const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(fl2.includes("withvalue")){
                arfile[index]["icon"]=eval(fl[fl2.indexOf("withvalue")]);
            }
    alert(JSON.stringify(`${filePath}`))
  }}catch(e){alert(e)}
}
      }
      if(tc.includes("mdate")){

var sizar= tc.split("mdate");
// alert(JSON.stringify(statar));
alert(JSON.stringify(sizar));
if(sizar[0]!=""){
//   const parts = sizar[1].match(/[a-zA-Z]+|[0-9]+/g);
//   const parts2 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
//   const parts3 = sizar[0].match(/[a-zA-Z]+|[0-9]+/g);
  const parts4 = sizar[0].match(/[0-9]+/g);
  const parts5 = sizar[1].match(/[0-9]+/g);
  

  var lin=parts4[parts4.length-1].split('').pop();
  
            const lastIndex = sizar[0].split(lin);
            
const newStr = lastIndex[lastIndex.length - 1];

  var lin2=parts5[0].split('')[0];

  const lastIndex2 = sizar[1].split(lin2);

const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
// var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(parts4.join("/")+newStr)
var date1=new Date(parts4.join("/"));
var date2=new Date(parts5.join("/"));
var fdate=new Date(stats['mtime']);
// alert(JSON.stringify(date1+newStr+parts4.join(",")));
// alert(JSON.stringify(date2+newStr2+parts5.join(",")));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
try{
  if(eval(date1.getTime()+newStr+fdate.getTime())&&eval(fdate.getTime() +newStr2+date2.getTime())){
    alert((fdate));
    fn.push(`${filePath}`)
    const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(fl2.includes("withvalue")){
                arfile[index]["icon"]=eval(fl[fl2.indexOf("withvalue")]);
            }
    alert(JSON.stringify(`${filePath}`))
  }}catch(e){alert(e)}
  // alert(sizar[1])
  // alert(sizar[0].split("b")[1])
}
else{
  const parts4 = sizar[0].match(/[0-9]+/g);
  const parts5 = sizar[1].match(/[0-9]+/g);
  

//   var lin=parts4[parts4.length-1].split('').pop();
  
//             const lastIndex = sizar[0].split(lin);
            
// const newStr = lastIndex[lastIndex.length - 1];

  var lin2=parts5[0].split('')[0];

  const lastIndex2 = sizar[1].split(lin2);

const newStr2 = lastIndex2[0];

//  alert(JSON.stringify(parts3[parts3.length-1]));
// alert(parts5.join(","))
// var sizsame2=abbreviatereverse(stats['size'],parts[parts.length-1])
// var sizsame=abbreviatereverse(stats['size'],parts3[parts3.length-1])
// alert(parts4.join("/")+newStr)
// var date1=new Date(parts4.join("/"));
var date2=new Date(parts5.join("/"));
var fdate=new Date(stats['mtime']);
// alert(JSON.stringify(date1+newStr+parts4.join(",")));
alert(JSON.stringify(fdate.getTime() +newStr2+date2.getTime()));
// alert(JSON.stringify(parts3)); // ["08", "27", "2015", "07", "25", "00AM"]
try{
  if(eval(fdate.getTime() +newStr2+date2.getTime())){
    alert((fdate));
    fn.push(`${filePath}`)
    const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(fl2.includes("withvalue")){
                arfile[index]["icon"]=eval(fl[fl2.indexOf("withvalue")]);
            }
    alert(JSON.stringify(`${filePath}`))
  }}catch(e){alert(e)}
}
      }
      if(tc.includes("tag")){

var sizar= tc.split("tag").pop();
// alert(tc.replace("tag","keywords"))
alert(JSON.stringify(sizar.split("=").pop()))
var pf=arfile2.findIndex(obj => obj.filepath === `${filePath}`)

if(arfile2[pf]['keywords']==sizar.split("=").pop()){
  // alert(json)
  fn.push(`${filePath}`)
  const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(fl2.includes("withvalue")){
                arfile[index]["icon"]=eval(fl[fl2.indexOf("withvalue")]);
            }
  alert(JSON.stringify(fn))
}
// arfile4=ar
// file2.filter((e) => e.keywords == ex);
}
              }else{
                const index = arfile.findIndex(obj => obj.filepath === `${filePath}`);
              if(fl2.includes("withvalue")){
             
              arfile[index]["icon"]=eval(fl[fl2.indexOf("withvalue")]);
            
            }
              }
statar.push(stats)
alert(cts +"d "+fcn)
    if(cts==fcn){
      startapp();
      alert("finish")
    }
    // alert(abbreviateNumber(stats.size));
});

            // fn.push(arfile2[i]);
          
        });
          
}
      }
      // alert(JSON.stringify(fn))
    
    // alert(fl[fl2.indexOf("get")])
  }

  
  
}
// const mime = require('mime-types');
// const path = require('path');

// function getGenericIconForFile(filePath) {
//   const mimeType = mime.lookup(filePath) || 'application/octet-stream';
//   const iconName = mimeType.replace('/', '-');
  
//   // Contoh: cari ikon di tema Adwaita
//   const possiblePaths = [
//     `/usr/share/icons/Adwaita/48x48/mimetypes/${iconName}.png`,
//     `/usr/share/icons/Adwaita/32x32/mimetypes/${iconName}.png`,
//     `/usr/share/icons/hicolor/48x48/mimetypes/${iconName}.png`,
//   ];
  
//   for (const iconPath of possiblePaths) {
//     if (fs.existsSync(iconPath)) {
//       return iconPath;
//     }
//   }
  
//   // Fallback: ikon generik
//   return '/usr/share/icons/Adwaita/48x48/mimetypes/text-x-generic.png';
// }

// // Contoh penggunaan
// const iconPath = getGenericIconForFile('/home/lawliet/Downloads/tutorina/crt.html');
// try{
// alert('Path ikon:', iconPath);
// }catch(e){
//   alert(e)
// }
// alert(mimeType)
// const { exec } = require('child_process');
// const fs = require('fs');
// const path = require('path');

// /**
//  * Mendapatkan ikon file berdasarkan ekstensi di Linux.
//  * @param {string} filePath - Path ke file target.
//  * @returns {Promise<string>} - Path ke ikon (e.g., `/usr/share/icons/.../pdf.png`).
//  */
// async function getFileIconLinux(filePath) {
//   // 1. Dapatkan MIME type file
//   const mimeType = await new Promise((resolve, reject) => {
//     exec(`xdg-mime query filetype "${filePath}"`, (err, stdout) => {
//       if (err) reject(err);
//       else resolve(stdout.trim());
//     });
//   });
//   // const mimeType = mime.lookup(filePath);
//   // 2. Dapatkan aplikasi default untuk MIME type ini
//   const defaultApp = await new Promise((resolve, reject) => {
//     exec(`xdg-mime query default ${mimeType}`, (err, stdout) => {
//       if (err) reject(err);
//       else resolve(stdout.trim());
//     });
//   });

//   // 3. Cari ikon dari aplikasi default atau MIME type
//   const iconName = await resolveIconName(defaultApp, mimeType);
  
//   // 4. Cari path ikon di direktori sistem
//   const iconPath = await findIconPath(iconName);
  
//   return iconPath;
// }

// /**
//  * Resolve nama ikon dari .desktop atau MIME type.
//  */
// async function resolveIconName(defaultApp, mimeType) {
//   if (!defaultApp) {
//     // Jika tidak ada aplikasi default, gunakan generic icon dari MIME type
//     return mimeType.replace('/', '-');
//   }

//   // Cari file .desktop aplikasi (e.g., /usr/share/applications/firefox.desktop)
//   const desktopFile = `/usr/share/applications/${defaultApp}`;
//   if (fs.existsSync(desktopFile)) {
//     const content = fs.readFileSync(desktopFile, 'utf-8');
//     const iconMatch = content.match(/^Icon=(.+)$/m);
//     if (iconMatch) return iconMatch[1];
//   }

//   // Fallback: Gunakan nama MIME type (e.g., "application-pdf")
//   return mimeType.replace('/', '-');
// }

// /**
//  * Cari path ikon di direktori sistem.
//  */
// async function findIconPath(iconName) {
//   const themes = ['Adwaita', 'Papirus', 'hicolor']; // Tema ikon umum
//   const sizes = ['48x48', '32x32', 'scalable']; // Ukuran umum
//   const exts = ['.png', '.svg', '.xpm']; // Format ikon

//   for (const theme of themes) {
//     for (const size of sizes) {
//       for (const ext of exts) {
//         const iconPath = `/usr/share/icons/${theme}/${size}/mimetypes/${iconName}${ext}`;
//         if (fs.existsSync(iconPath)) return iconPath;
//       }
//     }
//   }

//   // Fallback: Ikon generik (misal: "text-x-generic")
//   return '/usr/share/icons/Adwaita/48x48/mimetypes/text-x-generic.png';
// }

// // // Contoh penggunaan
// try{
// getFileIconLinux('/home/lawliet/Downloads/tutorina/listfile.json')
//   .then(iconPath => alert('Path ikon:', iconPath))
//   .catch(err => alert('Gagal:', err));
// }catch(e){
//   alert(e)
// }

// const mimeDB = require('mime-db');
// const glob = require('glob');  // Pastikan untuk menginstal: npm install glob

// async function getSystemIconPaths() {
//   // 1. Daftar tema dan lokasi yang mungkin
//   const themes = ['hicolor', 'Adwaita', 'Papirus', 'gnome', 'Yaru'];
//   const sizes = ['48x48', '32x32', '64x64', 'scalable'];
//   const baseDirs = [
//     '/usr/share/icons',
//     '/usr/local/share/icons',
//     `${process.env.HOME}/.local/share/icons`,
//     '/var/lib/flatpak/exports/share/icons'  // Untuk Flatpak
//   ];
  
//   // 2. Fungsi untuk mencari ikon
//   const findIcon = (iconName) => {
    
//     for (const baseDir of baseDirs) {
//       for (const theme of themes) {
//         for (const size of sizes) {
//           const pattern = `${baseDir}/${theme}/${size}/mimetypes/${iconName}.{png,svg,xpm}`;
//           const files = glob.sync(pattern, { nodir: true });
//           if (files.length > 0) return files[0];
//         }
//       }
//     }
//     return null;
//   };

//   // 3. Fungsi untuk mendapatkan ikon default
//   const getDefaultIcon = () => {
//     const defaults = ['text-x-generic', 'application-octet-stream'];
//     for (const name of defaults) {
//       const icon = findIcon(name);
//       if (icon) return icon;
//     }
//     return null;
//   };

//   const defaultIcon = getDefaultIcon() || '/path/to/your/fallback-icon.png';

//   // 4. Bangun mapping
//   const iconMap = {};
//   for (const [mimeType, data] of Object.entries(mimeDB)) {
//     if (!data.extensions) continue;

//     const iconName = mimeType.replace('/', '-');
//     const iconPath = findIcon(iconName) || defaultIcon;

//     data.extensions.forEach(ext => {
//       iconMap[ext] = iconPath;
//     });
//   }

//   return iconMap;
// }

// // 5. Contoh penggunaan dengan error handling
// getSystemIconPaths()
//   .then(mapping => {
    
//     fs.writeFileSync('icon-mapping.json', JSON.stringify(mapping, null, 2));
//     alert('Berhasil membuat mapping! Lihat icon-mapping.json');
//   })
//   .catch(err => {
//     alert('Gagal:', err);
//   });
// const { globSync } = require('glob');
// // const mime = require('mime-types');
// const mimeDB = require('mime-db');
// alert("S")
// // 1. Konfigurasi Path Linux
// const LINUX_PATHS = {
//   icons: [
//     '/usr/share/icons', 
//     '/usr/local/share/icons',
//     path.join(process.env.HOME, '.local/share/icons')
//   ],
//   apps: [
//     '/usr/share/applications',
//     path.join(process.env.HOME, '.local/share/applications')
//   ],
//   mime: '/usr/share/mime'
// };
// alert("S2")
// // 2. Fungsi Pencari Ikon
// function findMimeIcon(mimeType) {
//   const iconName = mimeType.replace('/', '-');
//   const patterns = LINUX_PATHS.icons.map(iconPath => 
//     path.join(iconPath, '**', 'mimetypes', `${iconName}.{png,svg}`)
//   );
  
//   return globSync(patterns, { nodir: true })[0] || null;
// }
// alert("S3")
// // 3. Fungsi Pencari Aplikasi Pendukung
// function findSupportingApps(mimeType) {
//   const desktopFiles = globSync(
//     LINUX_PATHS.apps.map(d => path.join(d, '*.desktop')),
//     { nodir: true }
//   );

//   return desktopFiles.reduce((apps, filePath) => {
//     const content = fs.readFileSync(filePath, 'utf-8');
//     const mimeTypes = content.match(/MimeType=(.+)/)?.[1]?.split(';') || [];
    
//     if (mimeTypes.includes(mimeType)) {
//       const appInfo = {
//         name: path.basename(filePath, '.desktop'),
//         desktopFile: filePath,
//         icon: content.match(/Icon=(.+)/)?.[1] || null,
//         exec: content.match(/Exec=(.+)/)?.[1]?.replace(/%\w+/g, '') || null
//       };
//       apps.push(appInfo);
//     }
    
//     return apps;
//   }, []);
// }
// alert("S4")
// // 4. Membangun Database Lengkap
// function buildLinuxMimeDatabase() {
//   const database = {};
//   alert("k")
//   // Iterasi semua MIME type yang diketahui
//   for (const [mimeType, data] of Object.entries(mimeDB)) {
//     const entry = {
//       extensions: data.extensions || [],
//       icon: findMimeIcon(mimeType),
//       apps: findSupportingApps(mimeType),
//       description: data.description || '',
//       source: data.source || 'unknown'
//     };
    
//     // Filter MIME type yang valid dan memiliki ekstensi
//     if (entry.extensions.length > 0) {
//       database[mimeType] = entry;
      
//       // Tambahkan entry berdasarkan ekstensi
//       for (const ext of entry.extensions) {
//         if (!database[ext]) database[ext] = [];
//         database[ext].push(mimeType);
//       }
//     }
//   }
  
//   return database;
// }
// alert("S5")
// // 5. Contoh Penggunaan

// alert("S6")
// sa();
// // Simpan ke file
// function sa(){
//   try{
// fs.writeFileSync(
//   'linux-mime-database.json',
//   JSON.stringify(buildLinuxMimeDatabase(), null, 2)
// );

// alert('save')
// }catch(e){
//   alert(e)
// }
// }
// async function getMimeDatabase() {
//   const result = [];
  
//   // 1. Dapatkan semua MIME types dari sistem
//   const mimeFiles = globSync([
//     '/usr/share/mime/**/*.xml',
//     `${process.env.HOME}/.local/share/mime/**/*.xml`
//   ], { nodir: true });

//   // 2. Parse setiap file MIME
//   for (const mimeFile of mimeFiles) {
//     const content = fs.readFileSync(mimeFile, 'utf-8');
//     const mimeTypeMatch = content.match(/<mime-type type="([^"]+)">/);
//     if (!mimeTypeMatch) continue;

//     const mimeType = mimeTypeMatch[1];
//     const extensions = [...new Set([
//       ...(mime.extensions[mimeType] || []),
//       ...(content.match(/<glob pattern="\*\.([^"]+)"/g) || [])
//         .map(g => g.replace(/<glob pattern="\*\.([^"]+)"/, '$1'))
//     ])];

//     // 3. Cari ikon terkait
//     const iconName = mimeType.replace('/', '-');
//     const iconPaths = globSync([
//       '/usr/share/icons/**/mimetypes/' + iconName + '.{png,svg}',
//       `${process.env.HOME}/.local/share/icons/**/mimetypes/` + iconName + '.{png,svg}'
//     ], { nodir: true });

//     // 4. Cari aplikasi terkait
//     const desktopFiles = globSync([
//       '/usr/share/applications/*.desktop',
//       `${process.env.HOME}/.local/share/applications/*.desktop`
//     ], { nodir: true });

//     const associatedApps = [];
//     for (const desktopFile of desktopFiles) {
//       const desktopContent = fs.readFileSync(desktopFile, 'utf-8');
//       if (desktopContent.includes(`MimeType=${mimeType}`)) {
//         const appName = path.basename(desktopFile);
//         const iconMatch = desktopContent.match(/^Icon=(.+)$/m);
//         associatedApps.push({
//           name: appName,
//           icon: iconMatch ? iconMatch[1] : null
//         });
//       }
//     }

//     result.push({
//       mimeType,
//       extensions,
//       icons: iconPaths,
//       applications: associatedApps
//     });
//   }

//   return result;
// }

// // 5. Contoh Penggunaan
// getMimeDatabase()
//   .then(database => {
//     fs.writeFileSync('mime-database.json', JSON.stringify(database, null, 2));
//     alert('Database telah disimpan ke mime-database.json');
    
//     // Contoh query
//     // const pdfEntry = database.find(entry => entry.mimeType === 'application/pdf');
//     // console.log('Contoh entry PDF:', {
//     //   mime: pdfEntry.mimeType,
//     //   exts: pdfEntry.extensions,
//     //   icon: pdfEntry.icons[0],
//     //   apps: pdfEntry.applications.map(a => a.name)
//     // });
//   })
//   .catch(err => {
//     alert('Error:', err);
//   });
// const fsh = require('fs/promises');

// const { glob } = require('glob');
// const mime = require('mime-types');

// 1. Konfigurasi Path yang Lebih Robust
// const SYSTEM_PATHS = {
//   icons: [
//     '/usr/share/icons',
//     '/usr/local/share/icons',
//     path.join(process.env.HOME, '.local/share/icons')
//   ].filter(p => fsh.access(p).then(() => true).catch(() => false)),
  
//   apps: [
//     '/usr/share/applications',
//     path.join(process.env.HOME, '.local/share/applications')
//   ],
  
//   mime: '/usr/share/mime'
// };

// // 2. Cache untuk performa
// const iconCache = new Map();
// const appCache = new Map();

// async function findIconPath(mimeType) {
//   if (iconCache.has(mimeType)) return iconCache.get(mimeType);

//   const iconName = mimeType.replace('/', '-');
//   const iconDirs = (await Promise.all(
//     SYSTEM_PATHS.icons.map(async iconBase => {
//       try {
//         const themes = await fsh.readdir(iconBase);
//         return themes.map(theme => path.join(iconBase, theme));
//       } catch {
//         return [];
//       }
//     })
//   )).flat();

//   for (const iconDir of iconDirs) {
//     try {
//       const sizes = await fsh.readdir(iconDir);
//       for (const size of sizes) {
//         const iconPath = path.join(iconDir, size, 'mimetypes', `${iconName}.png`);
//         try {
//           await fsh.access(iconPath);
//           iconCache.set(mimeType, iconPath);
//           return iconPath;
//         } catch {}
//       }
//     } catch {}
//   }

//   return null;
// }

// async function getDesktopApps() {
//   if (appCache.size > 0) return appCache;

//   const desktopFiles = (await Promise.all(
//     SYSTEM_PATHS.apps.map(appPath => 
//       glob(path.join(appPath, '*.desktop')).catch(() => [])
//     )
//   )).flat();

//   for (const file of desktopFiles) {
//     try {
//       const content = await fsh.readFile(file, 'utf-8');
//       const mimeTypes = content.match(/MimeType=(.+)/)?.[1]?.split(';').filter(Boolean) || [];
//       const appInfo = {
//         name: content.match(/^Name=(.+)$/m)?.[1] || path.basename(file, '.desktop'),
//         icon: content.match(/^Icon=(.+)$/m)?.[1],
//         exec: content.match(/^Exec=(.+)$/m)?.[1]?.replace(/%[^ ]+/g, ''),
//         file
//       };

//       for (const mimeType of mimeTypes) {
//         if (!appCache.has(mimeType)) appCache.set(mimeType, []);
//         appCache.get(mimeType).push(appInfo);
//       }
//     } catch (error) {
//       console.error(`Error reading ${file}:`, error.message);
//     }
//   }

//   return appCache;
// }

// async function buildMimeDatabase() {
//   try {
//     // 3. Load data paralel
//     const [desktopApps, mimeTypes] = await Promise.all([
//       getDesktopApps(),
//       Object.entries(mime.types)
//     ]);

//     const result = {};
//     let count = 0;

//     // 4. Pemrosesan MIME types
//     for (const [ext, mimeType] of mimeTypes) {
//       if (!ext || !mimeType) continue;

//       try {
//         const iconPath = await findIconPath(mimeType);
//         const apps = desktopApps.get(mimeType) || [];

//         result[ext] = {
//           mime: mimeType,
//           icon: iconPath,
//           apps: apps.map(app => ({
//             name: app.name,
//             icon: app.icon,
//             command: app.exec
//           }))
//         };

//         // Progress reporting
//         if (++count % 100 === 0) {
//           console.log(`Processed ${count} extensions...`);
//         }
//       } catch (error) {
//         console.error(`Error processing ${ext}:`, error.message);
//       }
//     }

//     return result;
//   } catch (error) {
//     console.error('Database build failed:', error);
//     throw error;
//   }
// }

// // 5. Contoh Penggunaan
// // (async () => {
// //   alert('Database Build');
// //   const db = await buildMimeDatabase();
  
// //   await fsh.writeFile(
// //     'mime-db.json',
// //     JSON.stringify(db, null, 2)
// //   );
  
// //   alert('Database Build');
// //   // console.log('Contoh data PDF:', db['pdf']);
// // })();

// async function listLinuxApps() {
//   // 1. Daftar direktori yang berisi file .desktop
//   const desktopDirs = [
//     '/usr/share/applications',
//     '/usr/local/share/applications',
//     'var/lib/snapd/desktop/applications',
//     path.join(process.env.HOME, '.local/share/applications')
//   ];

//   const apps = [];

//   // 2. Baca semua file .desktop
//   for (const dir of desktopDirs) {
//     try {
//       const files = await fsh.readdir(dir);
//       for (const file of files) {
//         if (file.endsWith('.desktop')) {
//           try {
//             const content = await fsh.readFile(path.join(dir, file), 'utf-8');
            
//             // 3. Parse informasi aplikasi
//             const appInfo = {
//               name: extractDesktopValue(content, 'Name') || path.basename(file, '.desktop'),
//               exec: cleanExecCommand(extractDesktopValue(content, 'Exec')),
//               icon: extractDesktopValue(content, 'Icon'),
//               categories: extractDesktopValue(content, 'Categories')?.split(';') || [],
//               desktopFile: path.join(dir, file)
//             };

//             // 4. Filter aplikasi yang valid
//             if (appInfo.exec && !appInfo.exec.includes('--hidden')) {
//               apps.push(appInfo);
//             }
//           } catch (err) {
//             console.error(`Error reading ${file}:`, err.message);
//           }
//         }
//       }
//     } catch (err) {
//       if (err.code !== 'ENOENT') {
//         console.error(`Error accessing ${dir}:`, err.message);
//       }
//     }
//   }

//   return apps;
// }

// // Helper function untuk ekstrak nilai dari file .desktop
// function extractDesktopValue(content, key) {
//   const regex = new RegExp(`^${key}=(.*)$`, 'm');
//   const match = content.match(regex);
//   return match ? match[1].trim() : null;
// }

// // Helper function untuk membersihkan command
// function cleanExecCommand(exec) {
//   if (!exec) return null;
//   return exec
//     .replace(/%[^ ]+/g, '')  // Hapus parameter seperti %f, %u
//     .replace(/^env\s+/i, '')  // Hapus prefix env
//     .trim();
// }

// 5. Contoh penggunaan
// (async () => {
//   console.time('App List Generation');
  
//   const apps = await listLinuxApps();
  
//   // Simpan ke file JSON
//   await fsh.writeFile(
//     'linux-apps.json',
//     JSON.stringify(apps, null, 2)
//   );
  
//   console.timeEnd('App List Generation');
//   console.log(`Found ${apps.length} applications`);
//   console.log('Sample apps:', apps.slice(0, 3));
// })();
window.onerror = function(error, url, line) {
       alert(error+' URL:'+url+' L:'+line);
};
        </script>
    </body>
</html>